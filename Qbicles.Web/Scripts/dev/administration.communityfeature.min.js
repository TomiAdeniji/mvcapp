function ShowFeaturedProductTable(){var n=$("#featured-product-table"),t=n.on("processing.dt",function(t,i,r){r&&$(".loadingoverlay").length===0?n.LoadingOverlay("show"):n.LoadingOverlay("hide",!0)}).DataTable({destroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',serverSide:!0,info:!0,stateSave:!1,bLengthChange:!1,paging:!1,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,rowReorder:{dataSrc:"DisplayOrder"},bPaginate:!1,select:!0,ajax:{url:"/Administration/FeaturedProductDTData",type:"POST"},columns:[{data:"DisplayOrder",orderable:!1,width:"100px",render:function(n,t,i){return'<i class="fa fa-arrows"><\/i> &nbsp; <span class="dorder">'+i.DisplayOrder+"<\/span>"}},{data:"ProductId",orderable:!1,render:function(n,t,i){var r="";return r+='<div class="flex-grid-fluid">',r+='<div class="col">',r+="<br>",r+='<label class="label label-lg label-primary">'+i.ProductTypeLabelName+"<\/label>",r+="<br><br>",r+='<div class="productimg" style="background-image: url(\''+i.ItemImageUri+"'); border-radius: 5px; overflow: hidden; height: 200px;\"><\/div>",i.ProductTypeLabelName=="Product feature"&&(r+='<div class="whom" style="margin: 0; padding: 10px 0 5px 0;">',r+='<div class="avatarc" style="background-image: url(\''+i.BusinessLogUri+"');\">&nbsp;<\/div>",r+='<div class="whominfo">',r+='<h5 style="color: #333;">'+i.CatalogItemName+"<\/h5>",r+="<small>"+i.BusinessName+"<\/small>",r+="<\/div>",r+="<\/div>",r+="<\/div>"),r+"<\/div>"}},{name:"Link",data:"Link",orderable:!1,render:function(n,t,i){var r="";return r+=i.ProductTypeLabelName=="Image"?'<a href="'+i.Link+'" target="blank">'+i.Link+"<\/a>":i.Link,r+"<\/div>"}},{name:"DomainName",data:"DomainName",orderable:!1},{data:"ProductId",orderable:!1,"class":"text-right",render:function(n,t,i){var r="";return r+='<button class="btn btn-warning community-button sm w-auto" onclick="ShowAddEditFeaturedProductModal('+i.ProductId+')"><i class="fa fa-pencil"><\/i> &nbsp; Edit<\/button>',r+=" ",r+('<button class="btn btn-danger community-button sm w-auto" onclick="DeleteProductItem('+i.ProductId+')"><i class="fa fa-trash"><\/i> &nbsp; Delete<\/button>')}}]});t.on("row-reorder",function(n,i){for(var f,u=[],r=0,e=i.length;r<e;r++){var o=t.row(i[r].node).data(),s=o.ProductId,h=i[r].newData,c={ProductId:s,DisplayOrder:h};u.push(c)}u.length>0&&(f="/Administration/UpdateFeaturedProductDisplayOrder",$.ajax({method:"POST",dataType:"JSON",data:{lstProduct:u},url:f,success:function(n){n.result?cleanBookNotification.success("The order of the featured product item is updated successfully!","Qbicles"):cleanBookNotification.error(n.msg,"Qbicles");$("#featured-product-table").DataTable().ajax.reload()},error:function(n){cleanBookNotification.error(n.msg,"Qbicles");$("#featured-product-table").DataTable().ajax.reload()}}))})}function ShowFeaturedStoreTable(){var n=$("#featured-store-table"),t=n.on("processing.dt",function(t,i,r){r&&$(".loadingoverlay").length===0?n.LoadingOverlay("show"):n.LoadingOverlay("hide",!0)}).DataTable({serverSide:!0,rowReorder:{dataSrc:"DisplayOrder"},searching:!1,bPaginate:!1,select:!0,responsive:!0,ajax:{url:"/Administration/FeaturedStoreDTData",type:"POST"},columns:[{data:"DisplayOrder",width:"100px",render:function(n,t,i){return'<i class="fa fa-arrows"><\/i> &nbsp; <span class="dorder">'+i.DisplayOrder+"<\/span>"}},{data:"StoreId",orderable:!1,render:function(n,t,i){var r="";return r+='<div class="whom" style="margin: 0; padding: 10px 0 5px 0;">',r+='     <div class="avatarc" style="background-image: url(\''+i.DomainImageUri+"');\">&nbsp;<\/div>",r+='     <div class="whominfo">',r+='         <h5 style="color: #333;">'+i.DomainName+"<\/h5>",r+="         <small>"+i.DomainPlanLevelName+"<\/small>",r+="     <\/div>",r+"<\/div>"}},{data:"DomainPlanLevelName",orderable:!1,"class":"text-right",render:function(n,t,i){var r="";return r+='<button class="btn btn-warning community-button sm w-auto" onclick="ShowAddEditFeaturedStoreModal('+i.StoreId+')"><i class="fa fa-pencil"><\/i> &nbsp; Edit<\/button>',r+=" ",r+('<button class="btn btn-danger community-button sm w-auto" onclick="DeleteStoreItem('+i.StoreId+')"><i class="fa fa-trash"><\/i> &nbsp; Delete<\/button>')}}]});t.on("row-reorder",function(n,i){for(var f,u=[],r=0,e=i.length;r<e;r++){var o=t.row(i[r].node).data(),s=o.StoreId,h=i[r].newData,c={StoreId:s,DisplayOrder:h};u.push(c)}u.length>0&&(f="/Administration/UpdateStoreDisplayOrder",$.ajax({method:"POST",dataType:"JSON",data:{lstStores:u},url:f,success:function(n){n.result?cleanBookNotification.success("The order of the store item is updated successfully!","Qbicles"):cleanBookNotification.error(n.msg,"Qbicles");$("#featured-store-table").DataTable().ajax.reload()},error:function(n){cleanBookNotification.error(n.msg,"Qbicles");$("#featured-store-table").DataTable().ajax.reload()}}))})}function ShowAddEditFeaturedProductModal(n){var t="/Administration/ShowAddEditFeaturedProductModal?productId="+n;LoadingOverlay();$("#admin-featured-product-add").empty();$("#admin-featured-product-add").load(t,function(){$("#admin-featured-product-add").modal("show");LoadingOverlayEnd()})}function ShowAddEditFeaturedStoreModal(n){var t="/Administration/ShowAddEditFeaturedStoreModal?storeId="+n;LoadingOverlay();$("#admin-featured-store-add").empty();$("#admin-featured-store-add").load(t,function(){$("#admin-featured-store-add").modal("show");LoadingOverlayEnd()})}function InitFeaturedProductItemAddEditForm(){var n=$("#feat-item-form");n.validate({rules:{domain:{required:!0},catalog:{required:!0},itemSKU:{required:!0}}});n.submit(function(t){if(t.preventDefault(),n.valid())SaveProduct();else{LoadingOverlayEnd();var i=$("#product-item-sku").val();i.length<=0&&cleanBookNotification.error("Item SKU is required.","Qbicles")}})}function InitFeaturedProductImageAddEditForm(){var n=$("#feat-img-form");n.validate({rules:{domain:{required:!0},itemSKU:{required:!0}}});n.submit(function(t){var r,i;t.preventDefault();r=$("#feature-product-id").val();LoadingOverlay();n.valid()?(i=document.getElementById("img-file-uri").files,i&&i.length>0?UploadMediaS3ClientSide("img-file-uri").then(function(n){if(n.objectKey==="no_image"||n.objectKey==="no-image"){LoadingOverlayEnd("hide");cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}var t={FileName:n.fileName,FileKey:n.objectKey,FileSize:n.fileSize};SaveImage(t)}):r>0?SaveImage(null):(n.validate().showErrors({imgfile:"This field is required."}),LoadingOverlayEnd())):LoadingOverlayEnd()})}function InitFeaturedStoreAddEditForm(){var n=$("#feat-store-form");n.validate({rules:{domain:{required:!0}}});n.submit(function(n){n.preventDefault();$tablelayoutfrm.valid()?SaveFeaturedStore():LoadingOverlayEnd()})}function SaveProduct(){var e=$("#product-domain").val(),o=$("#product-catalog").val(),s=$("#product-item-sku").val(),h=$("#feature-product-id").val(),t={SKU:$("#form_inventory_SKU").val(),AdditionalInfos:[]},r,i,n,u,f;if($("#item_brand").val()!==""&&$("#item_brand").val()!==null&&t.AdditionalInfos.push({Id:$("#item_brand").val(),Type:1}),$("#item_protags").val())for(r=$("#item_protags").val(),i=JSON.parse(r),n=0;n<i.length;n++)t.AdditionalInfos.push({Id:0,Name:i[n].value,Type:4});u="/Administration/SaveFeaturedProduct";f={productId:h,domainKey:e,catalogId:o,itemSKU:s,item:t};LoadingOverlay();$.ajax({method:"POST",dataType:"JSON",data:f,url:u,success:function(n){n.result?(cleanBookNotification.success("Save featured product information successfully!","Qbicles"),$("#admin-featured-product-add").modal("hide"),$("#featured-product-table").DataTable().ajax.reload()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}}).then(function(){LoadingOverlayEnd()})}function SaveImage(n){var t={imageId:$("#feature-product-id").val(),domainKey:$("#image-domain").val(),imageUrl:$("#image-hyperlink").val(),uploadModel:n};$.ajax({method:"POST",dataType:"JSON",url:"/Administration/SaveFeaturedImage",data:t,success:function(n){n.result?(cleanBookNotification.success("Save featured image information successfully!","Qbicles"),$("#admin-featured-product-add").modal("hide"),$("#featured-product-table").DataTable().ajax.reload()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}}).then(function(){LoadingOverlayEnd()})}function SaveFeaturedStore(){var n=$("#featured-store-domain").val(),t={domainKey:n,featuredStoredId:$("#featured-store-id").val()};LoadingOverlay();$.ajax({method:"POST",dataType:"JSON",data:t,url:"/Administration/SaveFeaturedStore",success:function(n){n.result?(cleanBookNotification.success("Save Store information successfully!","Qbicles"),$("#admin-featured-store-add").modal("hide"),$("#featured-store-table").DataTable().ajax.reload()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}}).then(function(){LoadingOverlayEnd()})}function UpdateCatalogList(n,t){var i=$("#"+n),r={domainKey:i.val()};$.ajax({method:"POST",dataType:"JSON",url:"/Administration/GetListCatalogByDomain",data:_data,success:function(n){t.select2("destroy").empty;$.each(n,function(n,t){$selector.append('<option value="'+t.Id+'">'+t.Text+"<\/option>")});t.select2()},error:function(){cleanBookNotification.error(_L("ERROR_MSG_570"),"Qbicles")}})}function UpdateFeaturedProductSelector(){var t=$("#product-domain").val(),n=$("#product-catalog"),i={domainKey:t};$(".itemsku").fadeOut();t!==""&&$.ajax({method:"POST",dataType:"JSON",url:"/Administration/GetListCatalogByDomain",data:i,success:function(t){n.select2("destroy").empty();n.append('<option value=""><\/option>');$.each(t,function(t,i){n.append('<option value="'+i.Id+'">'+i.Text+"<\/option>")});n.select2();$(".catalogue").fadeIn()},error:function(){cleanBookNotification.error(_L("ERROR_MSG_5"),"Qbicles")}})}function UpdateFeaturedImageSelector(){}function ShowFeaturedProductItemFilteringModal(){var n=$("#product-catalog").val(),t="/Administration/ShowProductItemFilteringModal?catalogId="+n,i=$("#product-item-sku").val();$("#app-trader-pos-itemlist").load(t,{keySearch:i},function(){LoadAdminDataTraderItemInventory();LoadAdminDataTraderItemNonInventory();$("#app-trader-pos-itemlist").find(".select2").select2();$("#inventory-key-search").keyup(delay(function(){$("#inventory-trader-item-table").DataTable().ajax.reload()},500));$("#inventory-product-group").on("change",function(){$("#inventory-trader-item-table").DataTable().ajax.reload()});$("#non-inventory-key-search").keyup(delay(function(){$("#non-inventory-trader-item-table").DataTable().ajax.reload()},500));$("#non-inventory-product-group").on("change",function(){$("#non-inventory-trader-item-table").DataTable().ajax.reload()})})}function LoadAdminDataTraderItemNonInventory(){$("#non-inventory-trader-item-table").on("processing.dt",function(n,t,i){i&&$(".loadingoverlay").length===0?$("#non-inventory-trader-item-table").LoadingOverlay("show"):$("#non-inventory-trader-item-table").LoadingOverlay("hide",!0)}).DataTable({destroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',serverSide:!0,info:!1,stateSave:!1,bLengthChange:!0,paging:!0,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,ajax:{url:"/Administration/FilterTraderItemServerSide",type:"POST",data:function(n){return $.extend({},n,{search:$("#non-inventory-key-search").val(),catalogId:$("#product-catalog").val(),nonInventory:!0,productGroupId:$("#non-inventory-product-group").val()})}},columns:[{data:null,orderable:!1,width:"100px",render:function(n,t,i){return"<div class='table-avatar mini' style='background-image: url(\""+$("#api-base-url").val()+i.ImageUri+"\");'><\/div>"}},{name:"Name",data:"Name",orderable:!0},{name:"SKU",data:"SKU",orderable:!0},{name:"Group",data:"Group",orderable:!0},{data:null,orderable:!1,width:"100px",render:function(n,t,i){return"<button class='btn btn-success' data-dismiss='modal' onclick='selectItemToFeaturedProductAddingForm(this)' itemsku='"+i.SKU+"' itemid='"+i.Id+"' ><i class='fa fa-check'><\/i><\/button>"}}]})}function LoadAdminDataTraderItemInventory(){$("#inventory-trader-item-table").on("processing.dt",function(n,t,i){i&&$(".loadingoverlay").length===0?$("#inventory-trader-item-table").LoadingOverlay("show"):$("#inventory-trader-item-table").LoadingOverlay("hide",!0)}).DataTable({destroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',serverSide:!0,info:!1,stateSave:!1,bLengthChange:!0,paging:!0,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,ajax:{url:"/Administration/FilterTraderItemServerSide",type:"POST",data:function(n){return $.extend({},n,{search:$("#inventory-key-search").val(),catalogId:$("#product-catalog").val(),nonInventory:!1,productGroupId:$("#inventory-product-group").val()})}},columns:[{data:null,orderable:!1,width:"100px",render:function(n,t,i){return"<div class='table-avatar mini' style='background-image: url(\""+$("#api-base-url").val()+i.ImageUri+"\");'><\/div>"}},{name:"Name",data:"Name",orderable:!0},{name:"SKU",data:"SKU",orderable:!0},{name:"Group",data:"Group",orderable:!0},{data:null,orderable:!1,width:"100px",render:function(n,t,i){return"<button class='btn btn-success' data-dismiss='modal' onclick='selectItemToFeaturedProductAddingForm(this)' itemsku='"+i.SKU+"' itemid='"+i.Id+"' ><i class='fa fa-check'><\/i><\/button>"}}]})}function selectItemToFeaturedProductAddingForm(n){$(".featured-item-div").LoadingOverlay("show");var t=$(n).attr("itemsku");$("#product-item-sku").val(t);$(".shoutout-brand-tag").empty();$(".shoutout-brand-tag").show();$(".shoutout-brand-tag").load("/Administration/ShowProductItemBrandTagModal",{itemId:$(n).attr("itemid")},function(){$(".shoutout-brand-tag").show();$(".featured-item-div").LoadingOverlay("hide",!0)})}function DeleteStoreItem(n){if(confirm("Are you sure you want to delete this feature?")){var t="/Administration/DeletedFeaturedStore?storeId="+n;$.ajax({method:"POST",dataType:"JSON",url:t,success:function(n){n.result?(cleanBookNotification.success("Remove the Featured Store successfully!","Qbicles"),$("#featured-store-table").DataTable().ajax.reload()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}})}}function DeleteProductItem(n){if(confirm("Are you sure you want to delete this feature?")){var t="/Administration/DeleteFeaturedProduct?productId="+n;$.ajax({method:"POST",dataType:"JSON",url:t,success:function(n){n.result?(cleanBookNotification.success("Remove the Featured Product successfully!","Qbicles"),$("#featured-product-table").DataTable().ajax.reload()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}})}}