function PostApproval(n,t){$.LoadingOverlay("show");$.ajax({type:"post",url:"/SalesMarketing/DeniedPostApproval",datatype:"json",data:{id:n},beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;LoadingOverlayEnd();n?(cleanBookNotification.success(_L("ERROR_MSG_159"),"Sales Marketing"),window.location.href="/SalesMarketing/SMSocial?id="+t):cleanBookNotification.success(_L("ERROR_MSG_160"),"Sales Marketing")},error:function(){LoadingOverlayEnd()}})}function DenyEmailPost(n,t){$.LoadingOverlay("show");$.ajax({type:"post",url:"/SalesMarketing/DenyEmailPost",datatype:"json",data:{id:n},beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;LoadingOverlayEnd();n?(cleanBookNotification.success(_L("ERROR_MSG_159"),"Sales Marketing"),window.location.href="/SalesMarketing/SMEmail?id="+t):cleanBookNotification.success(_L("ERROR_MSG_160"),"Sales Marketing")},error:function(){LoadingOverlayEnd()}})}function PostSetApproved(n){$.LoadingOverlay("show");$("#button-approval-post").addClass("disabled");$.ajax({type:"post",url:"/SalesMarketing/PostSetApproved",datatype:"json",data:{id:n},beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n?(cleanBookNotification.success(_L("ERROR_MSG_185"),"Sales Marketing"),location.reload()):cleanBookNotification.success(_L("ERROR_MSG_186"),"Sales Marketing")},error:function(){}}).always(function(){LoadingOverlayEnd()})}function ApproveEmailPost(n){$.LoadingOverlay("show");$("#button-approval-post").addClass("disabled");$.ajax({type:"post",url:"/SalesMarketing/ApproveEmailPost",datatype:"json",data:{id:n},beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n?(cleanBookNotification.success(_L("ERROR_MSG_185"),"Sales Marketing"),location.reload()):cleanBookNotification.success(_L("ERROR_MSG_186"),"Sales Marketing")},error:function(){}}).always(function(){LoadingOverlayEnd()})}function isVideo(n){var t=getExtension(n);switch(t.toLowerCase()){case"mp4":case"webm":case"ogv":return!0}return!1}function getExtension(n){var t=n.split(".");return t[t.length-1]}function AttachChange(n,t){$("#video-preview-edit").attr("src","");$(n).val()==="1"?(t&&(LoadMediaByCampaign(),$(".newpreview").hide()),$(".campaign-resource-picker").show(),$(".uploadnew").hide(),$(".previewimgpost").val("").change()):($(".campaign-resource-picker").hide(),$(".uploadnew").show(),$("#ImageOrVideo").val(0),$("#ImageOrVideoEdit").val(0))}function isFileImage(n){n=n.files[0];return n&&$.inArray(n.type,["image/gif","image/jpeg","image/png","image/jpg",])}function chooseMediaEdit(n,t,i,r,u){r?($(n).hide(),$(".changee"+t).show(),$(".othere").hide(),$("#rse-"+t).show(),$("#ImageOrVideoEdit").val(t),u?($(".preview-post-edit").attr("src",""),$("#video-preview-edit").attr("src",i)):($(".preview-post-edit").attr("src",i),$("#video-preview-edit").attr("src",""))):($(n).hide(),$(".usethemee"+t).show(),$(".othere").show(),$("#ImageOrVideoEdit").val(0),u?($(".preview-post-edit").attr("src",""),$("#video-preview").attr("src",i)):($(".preview-post-edit").attr("src",i),$("#video-preview-edit").attr("src","")))}function validateAddComment(){var n=$("#txt-comment-link").val();n.length>1500?$("#addcomment-error").show():$("#addcomment-error").hide()}function AddCommentToSocialPostApproval(n){if(!busycomment){var t=$("#txt-comment-link");t.val()&&!$("#addcomment-error").is(":visible")&&(isPlaceholder(!0,"#list-comments-approval"),busycomment=!0,$.ajax({url:"/QbicleComments/AddCommentToSocialPost",data:{message:t.val(),socialPostKey:n},type:"POST",success:function(n){n&&t.val("");busycomment=!1},error:function(){isPlaceholder(!1,"");busycomment=!1;cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}))}}function LoadMorePostsApproval(n,t,i){$.ajax({url:"/Qbicles/LoadMoreActivityPosts",data:{activityKey:n,size:CountPost*t},cache:!1,type:"POST",dataType:"html",beforeSend:function(){},success:function(n){if(n===""){$("#btnLoadPosts").remove();return}$("#"+i).append(n).fadeIn(250);CountPost=CountPost+1},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}})}function LoadMoreMediasApproval(n,t,i){$.ajax({url:"/Qbicles/LoadMoreActivityMedias",data:{activityId:n,size:CountMedia*t},cache:!1,type:"POST",dataType:"html",beforeSend:function(){},success:function(n){if(n===""){$("#btnLoadMedias").remove();return}$("#"+i).append(n).fadeIn(250);CountMedia=CountMedia+1},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}})}function ProcessSocialPost(n,t){var r=$("#"+t),i;r.valid()&&($.LoadingOverlay("show"),i=document.getElementById("sm-social-post-feature-upload-media").files,i&&i.length>0?UploadMediaS3ClientSide("sm-social-post-feature-upload-media").then(function(i){if(i.objectKey==="no_image"||i.objectKey==="no-image"){LoadingOverlayEnd("hide");cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-social-post-feature-image-object-key").val(i.objectKey);$("#sm-social-post-feature-image-object-name").val(i.fileName);$("#sm-social-post-feature-image-object-size").val(i.fileSize);SubmitSocialPost(n,t)}):($("#sm-social-post-feature-image-object-key").val(""),$("#sm-social-post-feature-image-object-name").val(""),$("#sm-social-post-feature-image-object-size").val(""),SubmitSocialPost(n,t)))}function ProcessMaualSocialPost(n,t){var r=$("#"+t),i;r.valid()&&($.LoadingOverlay("show"),i=document.getElementById("sm-social-post-feature-upload-media").files,i&&i.length>0?UploadMediaS3ClientSide("sm-social-post-feature-upload-media").then(function(i){if(i.objectKey==="no_image"||i.objectKey==="no-image"){LoadingOverlayEnd("hide");cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-social-post-feature-image-object-key").val(i.objectKey);$("#sm-social-post-feature-image-object-name").val(i.fileName);$("#sm-social-post-feature-image-object-size").val(i.fileSize);SubmitManualSocialPost(n,t)}):($("#sm-social-post-feature-image-object-key").val(""),$("#sm-social-post-feature-image-object-name").val(""),$("#sm-social-post-feature-image-object-size").val(""),SubmitManualSocialPost(n,t)))}var isBusy=!1,$frm_social_post=$("#frm_marketing-social-post-edit"),CountPost=1,CountMedia=1,busycomment=!1;$(document).ready(function(){$(".checkmulti").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});$frm_social_post.validate({rules:{Title:{required:!0,minlength:5},Content:{required:!0}}})});SubmitSocialPost=function(n,t){var i=$("#"+t),r=new FormData(i[0]);$.ajax({type:"post",cache:!1,url:"/SalesMarketing/SaveSocialPost",enctype:"multipart/form-data",data:r,processData:!1,contentType:!1,beforeSend:function(){isBusy=!0},success:function(t){t.result?($("#"+n).modal("hide"),isBusy=!1,cleanBookNotification.success(_L("ERROR_MSG_174"),"Sales Marketing"),i.trigger("reset"),$('.nav-marketing a[data-target="#network1-content-approvals"]').trigger("click")):t.msg&&cleanBookNotification.error(t.msg,"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){isBusyAddTaskForm=!1;LoadingOverlayEnd()})};SubmitManualSocialPost=function(n,t){var i=$("#"+t),r=new FormData(i[0]);$.ajax({type:"post",cache:!1,url:"/SalesMarketing/SaveSocialPost",enctype:"multipart/form-data",data:r,processData:!1,contentType:!1,beforeSend:function(){isBusy=!0},success:function(t){t.result?($("#"+n).modal("hide"),cleanBookNotification.success(_L("ERROR_MSG_174"),"Sales Marketing"),i.trigger("reset"),$('.nav-marketing a[data-target="#network1-content-approvals"]').trigger("click")):t.msg&&cleanBookNotification.error(t.msg,"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){isBusyAddTaskForm=!1;LoadingOverlayEnd()})};