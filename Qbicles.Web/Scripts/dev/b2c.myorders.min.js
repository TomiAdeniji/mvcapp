function initSearchs(){$("#subapp-tracking input[name=search]").keyup(delay(function(){$("#tblOrders").DataTable().ajax.reload()},500));$("#subapp-tracking input[name=daterange]").change(function(){$("#tblOrders").DataTable().ajax.reload()});$("#subapp-tracking select[name=channel]").change(function(){$("#tblOrders").DataTable().ajax.reload()});$("#subapp-tracking input[name=isHideCompleted]").change(function(){$("#tblOrders").DataTable().ajax.reload()})}function loadDataOrders(){var n=$("#tblOrders");n.on("processing.dt",function(n,t,i){$("#processingIndicator").css("display","none");i&&$(".loadingoverlay").length===0?$(n.currentTarget).LoadingOverlay("show"):$(n.currentTarget).LoadingOverlay("hide",!0)}).dataTable({destroy:!0,serverSide:!0,paging:!0,searching:!0,responsive:!0,order:[[3,"asc"]],ajax:{url:"/C2C/GetMyOrders",type:"POST",dataType:"json",data:function(n){var t=getParamaters("#subapp-tracking");return $.extend({},n,t)}},columns:[{data:"FullRef",searchable:!0,orderable:!0,render:function(n,t,i){return'<a href="#my-order" data-toggle="modal" onclick="loadOrderInfo('+i.OrderId+')">'+n+"<\/a>"}},{data:"BusinessName",searchable:!0,orderable:!0,render:function(n,t,i){var r='<a href="#" target="_blank">';return r+='<div class="table-avatar mini pull-left" style="background-image: url(\''+i.BusinessLogoUri+"&size=T');\"><\/div>",r+='<div class="avatar-name pull-left" style="color: #333; line-height: 4; padding-left: 15px;">'+n+"<\/div>",r+'<div class="clearfix"><\/div><\/a>'}},{data:"Placed",searchable:!0,orderable:!0},{data:"Channel",searchable:!0,orderable:!0},{name:"Status",data:"Status",searchable:!1,orderable:!0,render:function(n){var t="";switch(n){case"Draft":t='<span class="label label-lg label-info">Draft<\/span>';break;case"AwaitingProcessing":case"Awaiting processing":t='<span class="label label-lg label-primary">Awaiting processing<\/span>';break;case"InProcessing":case"Processing":t='<span class="label label-lg label-primary">In processing<\/span>';break;case"Processed":case"Completed":t='<span class="label label-lg label-success">Completed<\/span>';break;case"ProcessedWithProblems":case"Completed with problems":t='<span class="label label-lg label-danger">Completed with problems<\/span>';break;case"Ready for payment":t='<span class="label label-lg label-primary">Ready for payment<\/span>'}return t}},{data:"OrderId",searchable:!1,orderable:!1,render:function(n){var t='<button class="btn btn-info" data-toggle="modal" data-target="#my-order" onclick="loadOrderInfo('+n+')">Order info<\/button>';return t+('&nbsp<a href="/C2C/ContactStore?orderId='+n+'" class="btn btn-primary" target="_blank" style="text-decoration: none !important;">Contact store<\/a>')}},],createdRow:function(n,t){(t.Status=="Processed"||t.Status=="Completed")&&$(n).addClass("completed")}});$("#tblOrders_filter").hide()}function getParamaters(n){var t={},i=$(n+" input[name=search]"),r=$(n+" input[name=daterange]"),u=$(n+" input[name=isHideCompleted]"),f=$(n+" select[name=channel]");return i.length>0&&(t.keyword=i.val()),r.length>0&&(t.daterange=r.val()),u.length>0&&(t.isHideCompleted=u.prop("checked")),f.length>0&&(t.channel=f.val()),t}function loadOrderInfo(n){var t=$("#my-order");$.LoadingOverlay("show");t.empty();t.load("/B2C/B2COrderInfoModal",{id:n},function(){LoadingOverlayEnd()})}$(function(){loadDataOrders();initSearchs();$(".filter-daterange").daterangepicker({autoUpdateInput:!1,cancelClass:"btn-danger",opens:"right",locale:{cancelLabel:"Clear",format:$dateFormatByUser.toUpperCase()}});$(".filter-daterange").on("apply.daterangepicker",function(n,t){$(this).val(t.startDate.format($dateFormatByUser.toUpperCase())+" - "+t.endDate.format($dateFormatByUser.toUpperCase()));$(this).trigger("change")});$(".filter-daterange").on("cancel.daterangepicker",function(){$(this).val(null);$(this).trigger("change")})});