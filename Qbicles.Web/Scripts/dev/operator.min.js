function LoadOperatorConfigs(){$.LoadingOverlay("show");$("#app-config").load("/Operator/LoadOperatorConfigs",function(){LoadingOverlayEnd()})}function LoadOperatorGoals(n,t){t&&(isInitpagination=!1);var r=$("#chkGoalIsHidden").prop("checked")?!0:!1,i=$("#slGoalTags").val(),u={skip:n,take:goalPageSize,keyword:$("#txtGoalSearch").val(),isHide:r,tags:i?i:[]};$.get("/Operator/LoadGoals",u,function(n){n.result&&n.Object&&($("#goals-goals div.flex-grid-quarters-lg").html(n.Object.strResult),isInitpagination||initPagination(n.Object.totalRecord,goalPageSize,"#GoalPaginateTemplate"),n.Object.totalRecord==0&&$("#GoalPaginateTemplate").hide())})}function LoadOperatorMeasures(){initMeasuresTable()}function LoadOperatorTags(){$.get("/Operator/getTagsAll",function(n){n.length>0&&($("#slGoalTags").empty(),$("#slGoalTags").append("<option selected>Show all<\/option>"),n.forEach(function(n){$("#slGoalTags").append('<option value="'+n.Id+'">'+n.Name+"<\/option>")}),$("#slGoalTags").select2({placeholder:"Please select"}))})}function initMeasuresTable(){$tblMeasures=$("#tblMeasures");$tblMeasures.on("processing.dt",function(n,t,i){$("#processingIndicator").css("display","none");i?$tblMeasures.LoadingOverlay("show"):$tblMeasures.LoadingOverlay("hide",!0)}).dataTable({destroy:!0,serverSide:!0,paging:!0,searching:!1,autoWidth:!0,pageLength:10,order:[[0,"asc"]],ajax:{url:"/Operator/SearchMeasures",data:function(n){return $.extend({},n,{measureName:$("#txtmeasureSearch").val()})}},columns:[{title:"Measure",data:"Measure",searchable:!0,orderable:!0},{title:"Summary",data:"Summary",searchable:!0,orderable:!0},{title:"Options",data:"Id",searchable:!0,orderable:!1}],columnDefs:[{targets:2,data:"Id",render:function(n,t,i){return'<div class="btn-group options"><button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cog"><\/i> &nbsp; Options<\/button>'+('<ul class="dropdown-menu dropdown-menu-right" style="right: 0;"><li><a href="#" onclick="loadModalMeasure('+n+');">Edit<\/a><\/li>'+(i.AllowDelete?'<li><a href="#" onclick="deleteMeasure('+n+')">Delete<\/a><\/li>':"")+"<\/ul><\/div>")}}]})}function loadModalGoal(n){$("#app-operator-goal-addedit").modal("show");$("#app-operator-goal-addedit").load("/Operator/LoadModalGoal",{id:n},function(){initGoalModal()})}function initGoalModal(){var n=$("#frmGoal");$tblLeadingIndicators=$("#tblLeadingIndicators").DataTable({destroy:!0,order:[[4,"desc"]],columnDefs:[{visible:!1,targets:0},{visible:!1,targets:1},{targets:4,render:function(n){return typeof n=="number"?n+"%":n.replace("%","")+"%"}},{targets:5,data:"Id",render:function(){return'<button class="btn btn-danger" type="button" onclick="deleteRowMeasure(\'tblLeadingIndicators\',this)"><i class="fa fa-trash"><\/i><\/button>'}}]});$tblGoalMeasures=$("#tblGoalMeasures").DataTable({destroy:!0,order:[[4,"desc"]],columnDefs:[{visible:!1,targets:0},{visible:!1,targets:1},{targets:4,render:function(n){return typeof n=="number"?n+"%":n.replace("%","")+"%"}},{targets:5,data:"Id",render:function(){return'<button class="btn btn-danger" onclick="deleteRowMeasure(\'tblGoalMeasures\',this)"><i class="fa fa-trash"><\/i><\/button>'}}]});$("#frmGoal select.select2").select2({placeholder:"Please select"});$("#frmGoal .checkmulti").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});$(".btnNext").click(function(){var t=$(this).closest(".modal");n.valid()?$(t).find("#tabNavGoals .active").next("li").find("a").trigger("click"):$(t).find("#tabNavGoals .active").find("a").trigger("click")});$(".btnPrevious").click(function(){var n=$(this).closest(".modal");$(n).find("#tabNavGoals .active").prev("li").find("a").trigger("click")});$("#btnLMAdd").click(function(){if($("#frmGoal select[name=lm_measure]").val()!=""&&$("#frmGoal input[name=lm_weight]").valid()){var n=$("#frmGoal select[name=lm_measure] option:selected"),r=n.val(),u=n.text(),f=n.attr("desc"),i=parseInt($("#frmGoal input[name=lm_weight]").val()),e=$tblLeadingIndicators.rows().data(),t=i;if($.each(e,function(n,i){t+=typeof i[4]=="number"?i[4]:parseInt(i[4].replace("%",""))}),t>100){cleanBookNotification.error(_L("ERROR_MSG_703"),"Operator");return}$tblLeadingIndicators.row.add({0:0,1:r,2:u,3:f,4:i,5:0}).draw(!1);n.remove();$("#frmGoal select[name=lm_measure]").select2({placeholder:"Please select"});$("#btnLMAdd").attr("disabled",!0);$("#frmGoal select[name=lm_measure]").val("").trigger("change");$("#frmGoal input[name=lm_weight]").val("0")}});$("#btnGMAdd").click(function(){if($("#frmGoal select[name=gm_measure]").val()!=""&&$("#frmGoal input[name=gm_weight]").valid()){var n=$("#frmGoal select[name=gm_measure] option:selected"),r=n.val(),u=n.text(),f=n.attr("desc"),i=parseInt($("#frmGoal input[name=gm_weight]").val()),e=$tblGoalMeasures.rows().data(),t=i;if($.each(e,function(n,i){t+=typeof i[4]=="number"?i[4]:parseInt(i[4].replace("%",""))}),t>100){cleanBookNotification.error(_L("ERROR_MSG_703"),"Operator");return}$tblGoalMeasures.row.add({0:0,1:r,2:u,3:f,4:i,5:0}).draw(!1);n.remove();$("#frmGoal select[name=gm_measure]").select2({placeholder:"Please select"});$("#btnGMAdd").attr("disabled",!0);$("#frmGoal select[name=gm_measure]").val("").trigger("change");$("#frmGoal input[name=gm_weight]").val("0")}});n.validate({ignore:"",rules:{Name:{required:!0,maxlength:100},Summary:{required:!0,maxlength:500},Tags:{required:!0}}});n.submit(function(t){if(t.preventDefault(),n.valid()&&n.valid()){$.LoadingOverlay("show");var i=document.getElementById("goal-featured-image").files;i.length>0?UploadMediaS3ClientSide("goal-featured-image").then(function(n){if(n.objectKey==="no_image"||n.objectKey==="no-image"){LoadingOverlayEnd("hide");cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#operator-goal-feature-image-object-key").val(n.objectKey);$("#operator-goal-feature-image-object-name").val(n.fileName);$("#operator-goal-feature-image-object-size").val(n.fileSize);SaveGoalOnOperator()}):($("#operator-goal-feature-image-object-key").val(""),$("#operator-goal-feature-image-object-name").val(""),$("#operator-goal-feature-image-object-size").val(""),SaveGoalOnOperator())}})}function SaveGoalOnOperator(){var t=new FormData($("#frmGoal")[0]),r=$tblLeadingIndicators.rows().data(),u=$tblGoalMeasures.rows().data(),i=[],n;if($.each(r,function(n,t){i.push({Id:t[0],MeasureId:t[1],Weight:typeof t[4]=="number"?t[4]:t[4].replace("%","")})}),n=[],$.each(u,function(t,i){n.push({Id:i[0],MeasureId:i[1],Weight:typeof i[4]=="number"?i[4]:i[4].replace("%","")})}),i.length>0)t.append("sLeadingIndicators",JSON.stringify(i));else{cleanBookNotification.error(_L("ERROR_MSG_704"),"Operator");$("#tabNavGoals a[href=#goal-2]").click();LoadingOverlayEnd();return}if(n.length>0)t.append("sGoalMeasures",JSON.stringify(n));else{cleanBookNotification.error(_L("ERROR_MSG_705"),"Operator");$("#tabNavGoals a[href=#goal-3]").click();LoadingOverlayEnd();return}$.ajax({type:"post",cache:!1,url:"/Operator/SaveGoal",data:t,enctype:"multipart/form-data",processData:!1,contentType:!1,beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-goal-addedit").modal("hide"),LoadOperatorGoals(0,!0),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator")):!n.result&&n.msg&&cleanBookNotification.error(_L(n.msg),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}})}function deleteRowMeasure(n,t){var u=$(t).parents("tr"),s;if(u){var f=$("#"+n).DataTable().row(u),r=f.data(),i=r[1],e=r[2],o=r[3];n=="tblLeadingIndicators"?$("#frmGoal select[name=lm_measure] option[value="+i+"]").length==0&&(s=$("#frmGoal select[name=lm_measure]").append('<option value="'+i+'" desc="'+o.replace(/'/g,"\\'").replace(/"/g,"&#34;")+'">'+e+"<\/option>"),$("#frmGoal select[name=lm_measure]").select2({placeholder:"Please select"})):$("#frmGoal select[name=lm_measure] option[value="+i+"]").length==0&&(s=$("#frmGoal select[name=gm_measure]").append('<option value="'+i+'" desc="'+o.replace(/'/g,"\\'").replace(/"/g,"&#34;")+'">'+e+"<\/option>"),$("#frmGoal select[name=gm_measure]").select2({placeholder:"Please select"}));f.remove().draw()}}function loadModalMeasure(n){$("#frmMeasure").validate().resetForm();n>0?$.get("/Operator/getMeasureById?id="+n,function(t){t?($("#app-operator-measure-addedit h5.modal-title").text("Edit a Measure"),$('#frmMeasure input[name="Id"]').val(t.Id),$('#frmMeasure input[name="Name"]').val(t.Name),$('#frmMeasure textarea[name="Summary"]').val(t.Summary),$("#app-operator-measure-addedit").modal("show")):cleanBookNotification.error(_L("ERROR_MSG_410",[n]),"Operator")}):($("#app-operator-measure-addedit h5.modal-title").text("Add a Measure"),$('#frmMeasure input[name="Id"]').val(0),$('#frmMeasure input[name="Name"]').val(""),$('#frmMeasure textarea[name="Summary"]').val(""),$("#app-operator-measure-addedit").modal("show"))}function initMeasureModal(){var n=$("#frmMeasure");n.validate({ignore:"",rules:{Name:{required:!0,maxlength:100},Summary:{required:!0,maxlength:250}}});n.submit(function(t){if(t.preventDefault(),n.valid())$.LoadingOverlay("show"),$.ajax({type:this.method,cache:!1,url:this.action,data:$(this).serialize(),beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-measure-addedit").modal("hide"),$("#tblMeasures").DataTable().ajax.reload(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator")):!n.result&&n.msg&&cleanBookNotification.error(_L(n.msg),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}});else{LoadingOverlayEnd();return}})}function initPagination(n,t,i){var r=$(i),u,f;n!=0?(r.show(),u=function(){for(var i=[],t=1;t<=n;t++)i.push(t);return i}(),f={prevText:"&nbsp; &laquo; Prev &nbsp;",nextText:"&nbsp; Next &raquo; &nbsp;",currentPage:1,pageSize:t,dataSource:u,callback:function(n,r){if(isInitpagination)switch(i){case"#GoalPaginateTemplate":LoadOperatorGoals((r.pageNumber-1)*t,!1);break;case"#PerformancePaginateTemplate":LoadPerformanceTrackings((r.pageNumber-1)*t,!1)}}},r.pagination(f),isInitpagination=!0):(r.hide(),isInitpagination=!1)}function updateHidden(n,t){$.post("/Operator/UpdateHiddenGoal",{id:n,isHidden:t},function(){var n=$("#GoalPaginateTemplate").pagination("getSelectedPageNum");loadAssets((n-1)*goalPageSize)})}function ShowOrHidePerformanceTracking(n,t){$.post("/Operator/ShowOrHidePerformanceTracking",{id:n,isHide:t},function(){LoadPerformanceTrackings(0,!0)})}function searchThrottle(n,t){var i=null;return function(){var r=this,u=arguments;clearTimeout(i);i=window.setTimeout(function(){n.apply(r,u)},t||800)}}function initSearch(){$("#txtGoalSearch").keyup(searchThrottle(function(){LoadOperatorGoals(0,!0)}));$("#slGoalTags").change(searchThrottle(function(){LoadOperatorGoals(0,!0)}));$("#chkGoalIsHidden").change(searchThrottle(function(){LoadOperatorGoals(0,!0)}));$("#txtSearchClock").keyup(searchThrottle(function(){$("#tblAttendances").DataTable().ajax.reload()}));$("#txtFilterDateClock,#slFilterPeople").change(searchThrottle(function(){$("#tblAttendances").DataTable().ajax.reload()}));$("#txtFormsSearch").keyup(searchThrottle(function(){$("#tblForms").DataTable().ajax.reload()}));$("#slFormsTags").change(searchThrottle(function(){$("#tblForms").DataTable().ajax.reload()}));$("#txtTaskKeyword").keyup(searchThrottle(function(){$("#tblComplianceTasks").DataTable().ajax.reload()}));$("#slTaskAssignee,#slTaskForms").change(searchThrottle(function(){$("#tblComplianceTasks").DataTable().ajax.reload()}))}function updateOptionGoal(n,t){$.post("/Operator/UpdateOptionGoal",{id:n,isHide:t},function(){var n=$("#GoalPaginateTemplate").pagination("getSelectedPageNum");LoadOperatorGoals((n-1)*goalPageSize,!1)})}function deleteMeasure(n){$.post("/Operator/DeleteMeasure",{id:n},function(n){n.result?($("#tblMeasures").DataTable().ajax.reload(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator")):!n.result&&n.msg?cleanBookNotification.error(_L(n.msg),"Operator"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")})}function checkMeasuresExist(){$.get("/Operator/CheckMeasuresExist",function(n){n.isExist?$("#goal-help-text").hide():$("#goal-help-text").show()})}function detailPerson(n){$(".contact-add .activity-overview a").prop("href","/Community/UserProfilePage?uId="+$(n).data("id"));$(".contact-add .activity-overview h2").text($(n).data("fullname"));$(".contact-add .activity-overview p").text($(n).data("summary"));$(".contact-add .activity-overview .contact-avatar-profile").css("background-image","url("+$(n).data("avatar")+")");$(".contact-add input[name=email]").val($(n).data("email"));$(".contact-add input[name=tel]").val($(n).data("tel"));$(".contact-add input[name=memberId]").val($(n).data("id"));$(".contact-list-found").hide();$(".contact-add").hide();$(".contact-add").fadeIn();$(".search_user").hide()}function searchDomainUsers(n){$(".existing-member").show();var t=$(n).val()?$(n).val().toLowerCase():"";$(".contact-list-found li").hide();$(".contact-list-found li:not(.letters)").each(function(){(t===""||$(this).find("h5").text().toLowerCase().includes(t))&&($(this).show(),$(this).prev().show())})}function initTeamPerson(){var n=$("#tblTeamPersons");n.on("processing.dt",function(t,i,r){$("#processingIndicator").css("display","none");r?n.LoadingOverlay("show"):n.LoadingOverlay("hide",!0)}).dataTable({destroy:!0,serverSide:!0,paging:!0,searching:!1,responsive:!0,autoWidth:!0,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,order:[[0,"asc"]],ajax:{url:"/Operator/SearchTeamPersons",data:function(n){return $.extend({},n,{teamPersonSearch:$("#teamPersonSearch").val(),teamPersonLocationSearch:$("#teamPersonLocationSearch").val(),teamPersonRoleSearch:$("#teamPersonRoleSearch").val()})}},columns:[{title:"Person",data:"Name",searchable:!0,orderable:!1},{title:"Location",data:"Location",searchable:!0,orderable:!0},{title:"Role",data:"Role",searchable:!0,orderable:!0},{title:"Workgroup",data:"Workgroup",searchable:!0,orderable:!0},{title:"Options",data:"Id",searchable:!0,orderable:!1}],columnDefs:[{targets:0,data:"Id",render:function(n,t,i){return'<a href="/Operator/DetailTeamPerson?id='+i.Id+'"><div class="table-avatar mini pull-left" style="background-image: url(\''+i.Avatar+'\');"><\/div><div class="avatar-name pull-left" style="color: #333; line-height: 4; padding-left: 15px;">'+i.Name+'<\/div><div class="clearfix"><\/div><\/a>'}},{targets:4,data:"Id",render:function(n,t,i){return'<div class="btn-group options"><button type = "button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ><i class="fa fa-cog"><\/i> &nbsp; Options<\/button><ul class="dropdown-menu dropdown-menu-right" style="right: 0;"><li><a href="/Operator/DetailTeamPerson?id='+n+'">View<\/a><\/li><li><a href="#" data-toggle="modal" data-target="#app-operator-person-addedit" onclick="loadTeamPersonModal('+n+",'"+i.MemberId+'\')">Edit<\/a><\/li><li><a href="#" onclick="removeTeamPerson('+n+')">Remove<\/a><\/li><\/ul><\/div >'}}]});$("#teamPersonSearch").keyup(searchThrottle(function(){n.DataTable().ajax.reload()}));$("#teamPersonLocationSearch, #teamPersonRoleSearch").change(searchThrottle(function(){n.DataTable().ajax.reload()}));$('a[href="#people-people"]').click(function(){n.DataTable().ajax.reload()})}function loadTeamPersonModal(n,t){$.LoadingOverlay("show");$("#app-operator-person-addedit").load("/Operator/LoadTeamPersonModal",{id:n},function(){$(".checkmulti").multiselect({includeSelectAllOption:!0,selectAllJustVisible:!0,includeResetOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0,enableFiltering:!0,enableCaseInsensitiveFiltering:!0});n!=0&&$(".widget-contacts li a[data-convertedid='"+t.replace(/-/g,"")+"']").first().trigger("click");var i=$("#tblTeamPersons");$frmOperatorTeamPerson=$("#frmOperatorTeamPerson");$frmOperatorTeamPerson.submit(function(n){n.preventDefault();$frmOperatorTeamPerson.valid()&&($.LoadingOverlay("show"),$.ajax({type:this.method,cache:!1,url:this.action,data:$(this).serialize(),beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-person-addedit").modal("hide"),i.DataTable().ajax.reload(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator")):!n.result&&n.msg&&cleanBookNotification.error(_L(n.msg),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}}))});LoadingOverlayEnd()})}function removeTeamPerson(n){$.LoadingOverlay("show");var t=$("#tblTeamPersons");$.ajax({url:"/Operator/RemoveTeamPerson",data:{id:n},type:"POST",success:function(n){LoadingOverlayEnd();n.result?(t.DataTable().ajax.reload(),cleanBookNotification.success(_L("REMOVE_MSG_SUCCESS"),"Operator")):n.msg&&cleanBookNotification.error(n.msg,"Operator")},error:function(){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}})}function backToSearch(){$(".contact-add").hide();$(".contact-list-found").fadeIn();$("select[name=lstRoleIds]").val([]);$("select[name=lstLocationIds]").val([]);$("select[name=lstLocationIds]").multiselect("refresh");$("select[name=lstRoleIds]").multiselect("refresh");$(".search_user").show()}function LoadMedias(){$.LoadingOverlay("show");var t=$("#mediaFolderId").val(),i=$("#operatorQbicleId").val(),n=$("#sl-media-type").val();$.ajax({type:"post",url:"/Operator/LoadMedia",datatype:"json",data:{fid:t,qid:i,fileType:n=="All"?"":n,rs:""},success:function(n){if(n){var t=$("#asset-resources .flex-grid-thirds-lg");t.html(n);totop()}LoadingOverlayEnd()},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles");LoadingOverlayEnd()}})}function LoadFolderInfor(){$.ajax({type:"post",url:"/Operator/GetFolderInfor",datatype:"json",data:{},success:function(n){$("#operatorQbicleId").val(n.qbicleId);$("#mediaFolderId").val(n.folderId)},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}})}function LoadTeam(){manage_options("#options-people");$(".section-detail").hide();$(".intro-people").show();$(".appnav").hide();$(".nav-people").show();$('.nav-people a[href="#people-people"]').trigger("click");LoadFolderInfor()}function LoadResourceModal(n){$("#create-resource").load("/Operator/LoadResourceModal",{folderId:n},function(){$("#create-resource .select2").select2({placeholder:"Please select"});$form_media_addedit=$("#form_media_addedit");$form_media_addedit.validate({rules:{name:{required:!0,minlength:5},description:{required:!0}}});$form_media_addedit.submit(function(n){if((n.preventDefault(),!isBusy)&&$form_media_addedit.valid()){$.LoadingOverlay("show");var t=new FormData($form_media_addedit[0]);t.append("qbicleId",$("#operatorQbicleId").val());$.ajax({type:this.method,cache:!1,url:this.action,enctype:"multipart/form-data",data:t,processData:!1,contentType:!1,beforeSend:function(){isBusy=!0},success:function(n){n.result?($("#create-resource").modal("hide"),isBusy=!1,LoadMedias($("#mediaFolderId").val(),$("#operatorQbicleId").val()),cleanBookNotification.success(_L("ERROR_MSG_172"),"Operator"),$form_media_addedit.trigger("reset")):n.msg&&(cleanBookNotification.error(n.msg,"Operator"),isBusy=!1);LoadingOverlayEnd()},error:function(){isBusy=!1;cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator");LoadingOverlayEnd()}})}})})}function loadWorkgroupPreview(n,t){if($(t+" .preview-localtion").text(""),$(t+" .preview-qbicle").text(""),$(t+" .preview-members").text("0"),n)$.get("/Operator/LoadWorkgroupPreview?wgid="+n,function(i){if(i){$(t+" .preview-localtion").text(i.localtion);$(t+" .preview-qbicle").text(i.qbicle);$(t+" .preview-members").text(i.countmember);$(t+" .preview-members").parent().attr("onclick","ShowTeamMembers("+n+")");var r=t=="#frmSchedule"?$(t+" select[name=Employees]"):$(t+" select[name=Peoples]");r.empty();i.members.forEach(function(n){r.append('<option value="'+n.UserId+'">'+n.Fullname+"<\/option>")});r.multiselect("destroy").multiselect({includeSelectAllOption:!0,enableFiltering:!0,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0})}});else{var i=t=="#frmSchedule"?$(t+" select[name=Employees]"):$(t+" select[name=Peoples]");i.empty();i.multiselect("destroy").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0})}}function initModalClock(){var t=$("#frmClock"),n;t.validate({ignore:"",rules:{Workgroup:{required:!0},Date:{required:!0},Time:{required:!0},Peoples:{required:!0},Notes:{maxlength:300}}});t.submit(function(n){if(n.preventDefault(),t.valid())$.LoadingOverlay("show"),$.ajax({type:this.method,cache:!1,url:this.action,data:$(this).serialize(),beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-clockin").modal("hide"),$("#tblAttendances").DataTable().ajax.reload(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator"),resetFormClock()):!n.result&&n.msg&&cleanBookNotification.error(_L(n.msg),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}});else{LoadingOverlayEnd();return}});$(".checkmulti").multiselect({includeSelectAllOption:!0,enableFiltering:!0,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});n=$dateFormatByUser.toUpperCase();$(".daterange").daterangepicker({autoUpdateInput:!1,cancelClass:"btn-danger",opens:"right",locale:{cancelLabel:"Clear",format:n}});$(".daterange").on("apply.daterangepicker",function(t,i){$(this).val(i.startDate.format(n)+" - "+i.endDate.format(n));$("#tblAttendances").DataTable().ajax.reload()});$(".daterange").on("cancel.daterangepicker",function(){$(this).val(null)})}function resetFormClock(){$(".preview-workgroup").hide();$("#frmClock input[name=Date]").val("");$("#frmClock input[name=Time]").val("");$("#frmClock select[name=Peoples]").multiselect("clearSelection");$("#frmClock input[name=Notes]").val("");$("#frmClock").validate().resetForm()}function initAttendancesTable(){var n=$("#tblAttendances");n.dataTable({destroy:!0,serverSide:!0,paging:!0,searching:!1,autoWidth:!0,pageLength:10,order:[[0,"asc"]],ajax:{url:"/Operator/SearchAttendances",data:function(n){return $.extend({},n,{searchFullname:$("#txtSearchClock").val(),filterdate:$("#txtFilterDateClock").val(),peoples:$("#slFilterPeople").val()?JSON.stringify($("#slFilterPeople").val()):""})}},columns:[{title:"Person",data:"Person",searchable:!0,orderable:!0},{title:"Date",data:"Date",searchable:!0,orderable:!0},{title:"Location",data:"Location",searchable:!0,orderable:!0},{title:"Time in",data:"TimeIn",searchable:!0,orderable:!0},{title:"Time out",data:"TimeOut",searchable:!0,orderable:!0},{title:"Options",data:"Id",searchable:!0,orderable:!1}],columnDefs:[{targets:0,data:"Id",render:function(n,t,i){var r='<a href="/Community/UserProfilePage?uId='+i.PersonId+'" target="_blank"><div class="table-avatar mini pull-left" style="background-image: url(\''+i.PersonUrl+"');\"><\/div>";return r+('<div class="avatar-name pull-left" style="color: #333; line-height: 4; padding-left: 15px;">'+n+'<\/div><div class="clearfix"><\/div><\/a>')}},{targets:3,data:"TimeIn",render:function(n,t,i){return'<input type="time" class="form-control timeIn'+i.Id+'" onchange="$(\'.confirm'+i.Id+'\').fadeIn();" value="'+n+'">'}},{targets:4,data:"TimeOut",render:function(n,t,i){return'<input type="time" class="form-control timeOut'+i.Id+'" onchange="$(\'.confirm'+i.Id+'\').fadeIn();" value="'+n+'">'}},{targets:5,data:"TimeOut",render:function(n,t,i){var r=' <div class="confirm'+i.Id+'" style="display: none;">';return r+='<button class="btn btn-success" onclick="updateClockout('+i.Id+')"><i class="fa fa-check"><\/i><\/button>',r+('<button class="btn btn-danger" onclick="$(\'.confirm'+i.Id+'\').hide();"><i class="fa fa-remove"><\/i><\/button><\/div>')}},]})}function updateClockout(n){var t={id:n,clockIn:$(".timeIn"+n).val(),clockOut:$(".timeOut"+n).val()};$.post("/Operator/UpdateClock",t,function(t){t.result?($(".confirm"+n).hide(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator")):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")})}function initModalSchedule(){var n=$dateFormatByUser.toUpperCase(),r=moment($("#frmSchedule input[name=StartDate]").val(),n).toDate(),u=moment($("#frmSchedule input[name=EndDate]").val(),n).toDate(),t,i;calcDaysByDates(r,u);$("#frmSchedule input[name=StartDate],#frmSchedule input[name=EndDate]").change(searchThrottle(function(){var r=moment($("#frmSchedule input[name=StartDate]").val(),n).toDate(),t=moment($("#frmSchedule input[name=EndDate]").val(),n).toDate(),i=moment($("#frmSchedule input[name=StartDate]").val(),n).add(3,"month");t>i.toDate()&&(cleanBookNotification.error(_L("ERROR_MSG_707"),"Operator"),$("#frmSchedule input[name=EndDate]").val(i.format(n)),t=i.toDate());calcDaysByDates(r,t)}));t=$("#frmSchedule");t.validate({ignore:"",rules:{Workgroup:{required:!0},Employees:{required:!0},StartDate:{required:!0},EndDate:{required:!0},Days:{required:!0},ShiftStart:{required:!0},ShiftEnd:{required:!0}}});t.submit(function(n){if(n.preventDefault(),t.valid())$.LoadingOverlay("show"),$.ajax({type:this.method,cache:!1,url:this.action,data:$(this).serialize(),beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-schedule-add").modal("hide"),initTablesDailyWeeklyMonthlyOfSched(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator"),resetFormSchedule()):!n.result&&n.msg?cleanBookNotification.error(_L(n.msg),"Operator"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}});else{LoadingOverlayEnd();return}});$("#frmSchedule .singledate,#day .singledate,#sched-day .singledate").daterangepicker({singleDatePicker:!0,autoApply:!0,showDropdowns:!0,autoUpdateInput:!0,cancelClass:"btn-danger",opens:"left",locale:{cancelLabel:"Clear",format:n}});calcWeekFilterByDate_timetimesheet();calcMonthFilterByDate_timetimesheet();calcWeekFilterByDate_timeschedule();calcMonthFilterByDate_timeschedule();i=$("#frmScheduleEdit");i.validate({ignore:"",rules:{ShiftStart:{required:!0},ShiftEnd:{required:!0}}});i.submit(function(n){if(n.preventDefault(),i.valid())$.LoadingOverlay("show"),$.ajax({type:this.method,cache:!1,url:this.action,data:$(this).serialize(),beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-schedule-individual-edit").modal("hide"),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator"),initTablesDailyWeeklyMonthlyOfSched(),loadScheduleData(0)):!n.result&&n.msg&&cleanBookNotification.error(_L(n.msg),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}});else{LoadingOverlayEnd();return}});$("#sched-day input[name=Day],#sched-week select[name=Week],#sched-month select[name=Month],#slSchedPeoples,#slSchedRoles,#slSchedLocations").change(searchThrottle(function(){initTablesDailyWeeklyMonthlyOfSched()}));$("#day input[name=Day],#week select[name=Week],#month select[name=Month],#slTimeshPeoples,#slTimeshRoles,#slTimeshLocations").change(searchThrottle(function(){initTablesDailyWeeklyMonthlyOfTimeSheets()}))}function calcDaysByDates(n,t){var f=$("#frmSchedule select[name=Days]"),r,u,i;for(f.empty(),r=$dateFormatByUser.toUpperCase(),u=new Date(n);u<=t;)i=moment(u),i.weekday()==6||i.weekday()==0?f.append('<option value="'+i.format(r)+'">'+i.format("dddd "+r)+"<\/option>"):f.append('<option value="'+i.format(r)+'" selected>'+i.format("dddd "+r)+"<\/option>"),u.setDate(u.getDate()+1);f.multiselect("destroy").multiselect({includeSelectAllOption:!0,enableFiltering:!0,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0})}function calcWeekFilterByDate_timetimesheet(){var t=$("#week select[name=Week]"),f;t.empty();for(var e=$dateFormatByUser.toUpperCase(),o=new Date,n=moment(o).day("Saturday").add(1,"day").toDate(),s=moment(n).add(-3,"month").day("Monday").toDate();n>=s;){var i=moment(n),r=moment(n).add(-1,"week"),u=moment(n).add(-1,"week").add(1,"day");n=r.toDate();f=r.add(1,"day").format(e)+"-"+i.format(e);i.month()==r.month()?t.append('<option value="'+f+'">'+u.format("Do")+" - "+i.format("Do ")+u.format("MMMM YYYY")+"<\/option>"):t.append('<option value="'+f+'">'+u.format("Do MMMM YYYY")+" - "+i.format("Do MMMM YYYY")+"<\/option>")}t.select2({placeholder:"Please select"})}function calcMonthFilterByDate_timetimesheet(){var i=$("#sched-month select[name=Month],#month select[name=Month]"),e,t;i.empty();for(var r=$dateFormatByUser.toUpperCase(),u=new Date,n=new Date(u.getFullYear(),u.getMonth()+1,0),f=1;f<=3;)e=moment(n),t=moment(n).subtract(n.getDate(),"day"),n=t.toDate(),i.append('<option value="'+t.add(1,"day").format(r)+"-"+e.add(1,"day").format(r)+'">'+t.format("MMMM YYYY")+"<\/option>"),f++;i.select2({placeholder:"Please select"})}function calcWeekFilterByDate_timeschedule(){var i=$("#sched-week select[name=Week]"),o,f;i.empty();for(var s=$dateFormatByUser.toUpperCase(),r=new Date,n=moment(r).add(3,"month").day("Saturday").add(1,"day").toDate(),h=moment(r).add(-3,"month").day("Monday").toDate();n>=h;){var t=moment(n),u=moment(n).add(-1,"week"),e=moment(n).add(-1,"week").add(1,"day");n=u.toDate();o=u.add(1,"day").format(s)+"-"+t.format(s);f=!1;r>=u.toDate()&&r<=t.toDate()&&(f=!0);t.month()==u.month()?i.append('<option value="'+o+'" '+(f?"selected":"")+">"+e.format("Do")+" - "+t.format("Do ")+e.format("MMMM YYYY")+"<\/option>"):i.append('<option value="'+o+'" '+(f?"selected":"")+">"+e.format("Do MMMM YYYY")+" - "+t.format("Do MMMM YYYY")+"<\/option>")}i.select2({placeholder:"Please select"})}function calcMonthFilterByDate_timeschedule(){var t=$("#sched-month select[name=Month]");t.empty();for(var u=$dateFormatByUser.toUpperCase(),i=new Date,n=new Date(i.getFullYear(),i.getMonth()+4,0),f=1;f<=6;){var o=moment(n),r=moment(n).subtract(n.getDate(),"day"),e=!1;i.getMonth()==n.getMonth()&&(e=!0);n=r.toDate();t.append('<option value="'+r.add(1,"day").format(u)+"-"+o.add(1,"day").format(u)+'" '+(e?"selected":"")+">"+r.format("MMMM YYYY")+"<\/option>");f++}t.select2({placeholder:"Please select"})}function initTablesDailyWeeklyMonthlyOfSched(n){var u=$dateFormatByUser.toUpperCase(),t=$("#slSchedPeoples").val(),i=$("#slSchedRoles").val(),r=$("#slSchedLocations").val(),f,e,h;if(n||(n=$("#tabviewschedule li.active a").attr("href")),n=="#sched-view-day")f=moment($("#sched-day input[name=Day]").val(),u),$(".sched-title-day").text(f.format("dddd Do MMMM YYYY")),e=$("#tblsched-view-day"),e.dataTable({destroy:!0,paging:!0,searching:!1,autoWidth:!0,pageLength:10,order:[[0,"asc"]],ajax:{url:"/Operator/SearchSchedulesDaily",data:function(n){return $.extend({},n,{Day:$("#sched-day input[name=Day]").val(),sPeoples:t?JSON.stringify(t):"",sRoles:i?JSON.stringify(i):"",sLocations:r?JSON.stringify(r):""})}},columns:[{title:"Person",data:"PersonName",searchable:!0,orderable:!0},{title:"Shift",data:"Shift",searchable:!0,orderable:!0},{title:"Location(s)",data:"Location",searchable:!0,orderable:!0},{title:"Manage",data:"Id",searchable:!0,orderable:!1}],columnDefs:[{targets:0,data:"Id",render:function(n,t,i){var r='<ul class="avatar-listing unstyled" style="margin-bottom: 0 !important;"><li>';return r+='<a href="/Community/UserProfilePage?uId='+i.PersonId+'" style="text-decoration: none !important; background: transparent !important; padding: 0;"><div class="owner-avatar">',r+='<div class="avatar-sm" style="background: url(\''+i.PersonUrl+"');\"><\/div><\/div>",r+("<h5>"+n+"<br><small>"+(i.PersonJobtile?i.PersonJobtile:"")+"<\/small><\/h5><\/a><\/li><\/ul>")}},{targets:3,data:"Id",render:function(n){return'<button class="btn btn-warning" type="button" onclick="loadScheduleData('+n+')" data-toggle="modal" data-target="#app-operator-schedule-individual-edit"><i class="fa fa-pencil"><\/i><\/button>'}}]});else if(n=="#sched-view-week"){var o=$("#sched-week select[name=Week]").val(),s=o.split("-"),c=moment(s[0],u),l=moment(s[1],u);$(".sched-title-week").text(c.format("dddd Do MMMM YYYY")+" - "+l.format("dddd Do MMMM YYYY"));$.post("/Operator/SearchSchedulesWeekly",{Week:o,Peoples:t?t:[],Roles:i?i:[],Locations:r?r:[]},function(n){n&&($("#sched-content-week").html(n),$("#tblsched-view-week").DataTable({destroy:!0,pageLength:10,order:[[0,"asc"]],autoWidth:!0,pageLength:10,searching:!1}))})}else h=$("#sched-month select[name=Month] option:selected").text(),$(".sched-title-month").text(h),$.post("/Operator/SearchSchedulesMonthly",{Week:$("#sched-month select[name=Month]").val(),Peoples:t?t:[],Roles:i?i:[],Locations:r?r:[]},function(n){n&&($("#sched-content-month").html(n),$("#tblsched-view-month").DataTable({destroy:!0,pageLength:10,order:[[0,"asc"]],autoWidth:!0,pageLength:10,searching:!1}))})}function initTablesDailyWeeklyMonthlyOfTimeSheets(n){var u=$dateFormatByUser.toUpperCase(),t=$("#slTimeshPeoples").val(),i=$("#slTimeshRoles").val(),r=$("#slTimeshLocations").val(),f,e,h;if(n||(n=$("#tabviewtimesheets li.active a").attr("href")),n=="#view-day")f=moment($("#day input[name=Day]").val(),u),$(".timesh-title-day").text(f.format("dddd Do MMMM YYYY")),e=$("#tbltimesh-view-day"),e.dataTable({destroy:!0,paging:!0,searching:!1,autoWidth:!0,pageLength:10,order:[[0,"asc"]],ajax:{url:"/Operator/SearchTimesheetsDaily",data:function(n){return $.extend({},n,{Day:$("#day input[name=Day]").val(),sPeoples:t?JSON.stringify(t):"",sRoles:i?JSON.stringify(i):"",sLocations:r?JSON.stringify(r):""})}},columns:[{title:"Person",data:"PersonName",searchable:!0,orderable:!0},{title:"Shift",data:"Shift",searchable:!0,orderable:!0},{title:"Location(s)",data:"Location",searchable:!0,orderable:!0}],columnDefs:[{targets:0,data:"Id",render:function(n,t,i){var r='<ul class="avatar-listing unstyled" style="margin-bottom: 0 !important;"><li>';return r+='<a href="/Community/UserProfilePage?uId='+i.PersonId+'" style="text-decoration: none !important; background: transparent !important; padding: 0;"><div class="owner-avatar">',r+='<div class="avatar-sm" style="background: url(\''+i.PersonUrl+"');\"><\/div><\/div>",r+("<h5>"+n+"<br><small>"+(i.PersonJobtile?i.PersonJobtile:"")+"<\/small><\/h5><\/a><\/li><\/ul>")}}]});else if(n=="#view-week"){var o=$("#week select[name=Week]").val(),s=o.split("-"),c=moment(s[0],u),l=moment(s[1],u);$(".timesh-title-week").text(c.format("dddd Do MMMM YYYY")+" - "+l.format("dddd Do MMMM YYYY"));$.post("/Operator/SearchTimesheetsWeekly",{Week:o,Peoples:t?t:[],Roles:i?i:[],Locations:r?r:[]},function(n){n&&($("#timesh-content-week").html(n),$("#tbltimesh-view-week").DataTable({destroy:!0,pageLength:10,order:[[0,"asc"]],autoWidth:!0,pageLength:10,searching:!1}))})}else h=$("#month select[name=Month] option:selected").text(),$(".timesh-title-month").text(h),$.post("/Operator/SearchTimesheetsMonthly",{Week:$("#month select[name=Month]").val(),Peoples:t?t:[],Roles:i?i:[],Locations:r?r:[]},function(n){n&&($("#timesh-content-month").html(n),$("#tbltimesh-view-month").DataTable({destroy:!0,pageLength:10,order:[[0,"asc"]],autoWidth:!0,pageLength:10,searching:!1}))})}function resetFormSchedule(){$("#frmSchedule select[name=Employees]").multiselect("clearSelection");$("#frmSchedule select[name=Days]").multiselect("clearSelection");$("#frmSchedule input[name=ShiftStart]").val("");$("#frmSchedule input[name=ShiftEnd]").val("");$("#frmSchedule").validate().resetForm()}function checkTeamPermission(){$.get("/Operator/CheckIsManagerOrSupervisor",function(n){n.allow?$(".team-permission").show():$(".team-permission").hide()})}function getTeamMembers(){$.get("/Operator/GetTeamMembers",function(n){if(n){var t=$(".teammembers");t.empty();$.each(n,function(n,i){t.append('<option value="'+i.UserId+'">'+i.Fullname+"<\/option>")});t.multiselect("destroy").multiselect({includeSelectAllOption:!0,enableFiltering:!0,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0})}})}function loadScheduleData(n){n==0?($("#frmScheduleEdit input[name=Id]").val("0"),$("#frmScheduleEdit input[name=ShiftStart]").val(""),$("#frmScheduleEdit input[name=ShiftEnd]").val("")):$.get("/Operator/GetScheduleById?id="+n,function(n){n?($("#frmScheduleEdit input[name=Id]").val(n.Id),$("#frmScheduleEdit input[name=ShiftStart]").val(n.ShiftStart),$("#frmScheduleEdit input[name=ShiftEnd]").val(n.ShiftEnd)):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")})}function getWorkgroupsTypeMember(n){$.get("/Operator/GetWorkgroups?type=1",function(t){if(t){var i=$(n+" select[name=Workgroup]");i.empty();i.append('<option value="" selected=""><\/option>');$.each(t,function(n,t){i.append('<option value="'+t.Id+'">'+t.Name+"<\/option>")});i.select2({placeholder:"Please select"})}})}function LoadPerformanceTrackings(n,t){var i,r;t&&(isInitpagination=!1);i=$("#chkPerformanceIsHidden").prop("checked")?!0:!1;$.LoadingOverlay("show");r={skip:n,take:perfomanceTrackingPageSize,keyword:$("#txtPerfomanceSearch").val(),isLoadingHide:i,locationId:$("#slLocation").val()};$.get("/Operator/LoadPerformanceTrackings",r,function(n){n.result&&n.Object&&($("#people-performance div.flex-grid-quarters-lg").html(n.Object.strResult),isInitpagination||initPagination(n.Object.totalRecord,perfomanceTrackingPageSize,"#PerformancePaginateTemplate"),n.Object.totalRecord==0&&$("#PerformancePaginateTemplate").hide());LoadingOverlayEnd()})}function formatOptions(n){if(!n.id)return n.text;return $('<div class="select2imgwrap"><div class="select2img" style="background-image: url(\''+($(n.element).attr("avataruri")===""?"/Content/DesignStyle/img/icon_domain_default.png":$(n.element).attr("api")+""+$(n.element).attr("avataruri"))+'\');"><\/div> <span class="select2text">'+n.text+"<\/span><\/div>")}function formatSelected(n){return $('<div class="select2imgwrap" style="padding: 0px; "><div class="select2img mini" style="background-image: url(\''+($(n.element).attr("avataruri")===""?"/Content/DesignStyle/img/icon_domain_default.png":$(n.element).attr("api")+""+$(n.element).attr("avataruri"))+'\');"><\/div> <span class="select2text">'+n.text+"<\/span><\/div>")}function ChangeWorkgroup(n){$(".preview-workgroup").show();$.get("/Operator/GetWorkgroupInfor",{id:$(n).val()},function(n){var i,t;if($("#WGLocation").text(n.Location),$("#WGProcess").text(n.Process),$("#WGMember").text(n.Members),$("#WGQbicle").text(n.Qbicle),i='<option value=""><\/option>',n.Persons)for(t=0;t<n.Persons.length;t++)i+='<option avataruri="'+n.Persons[t].ProfilePic+'&size=T" api="'+$("#api-uri").val()+'" value="'+n.Persons[t].Id+'">'+n.Persons[t].Name+"<\/option>";$("#trackingPersons").html(i);$("#trackingPersons").select2({placeholder:"Please select",templateResult:formatOptions,templateSelection:formatSelected})})}function AddMeasure(){if($("#slMeasureToAdd").val()&&$("#txtWeightPercent").val()){var t=$("#slMeasureToAdd option[value="+$("#slMeasureToAdd").val()+"]").first(),f=$("#slMeasureToAdd").val(),i=t.text(),r=t.data("description"),n=parseInt($("#txtWeightPercent").val()),u=n;n&&n!=0&&($("#tblTrackingMeasures tbody tr").each(function(){u+=parseInt($(this).data("weight"))}),u<=100?($("#tblTrackingMeasures tbody").append('<tr data-id="'+f+'" data-name="'+i+'" data-description="'+r+'" data-weight="'+n+'"><td>'+i+"<\/td><td>"+r+"<\/td><td>"+n+'%<\/td><td><button class="btn btn-danger" onclick="RemoveMeasure(this)"><i class="fa fa-trash"><\/i><\/button><\/td><\/tr>'),t.remove(),$("#slMeasureToAdd").val(""),$("#slMeasureToAdd").trigger("change.select2")):cleanBookNotification.error(_L("ERROR_MSG_703"),"Operator"))}}function RemoveMeasure(n){var t=$(n).parent().parent();$("#slMeasureToAdd").append('<option value="'+t.data("id")+'" data-description="'+t.data("description")+'">'+t.data("name")+"<\/option>");$("#slMeasureToAdd").val("");$("#slMeasureToAdd").trigger("change.select2");t.remove()}function LoadPerformanceTrackingModal(n){$.LoadingOverlay("show");$("#app-operator-performance-addedit").load("/Operator/LoadPerformanceTrackingModal",{id:n},function(){var n=$("#frmOperatorPerformance");$("#performanceWorkgroup, #slMeasureToAdd").select2({placeholder:"Please select"});$("#trackingPersons").select2({placeholder:"Please select",templateResult:formatOptions,templateSelection:formatSelected});n.validate({ignore:"",rules:{TeamPersonId:{required:!0},WorkgroupId:{required:!0}}});n.submit(function(t){var i,u,r;t.preventDefault();n.valid()?($.LoadingOverlay("show"),i=getAllMeasureWithWeights(),u=i.reduce(function(n,t){return n+t.Weight},0),i.length>0?(r=new FormData(n[0]),r.append("TrackingMeasures",JSON.stringify(i)),$.ajax({type:"POST",cache:!1,url:"/Operator/SavePerformanceTracking",enctype:"multipart/form-data",data:r,processData:!1,contentType:!1,beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-performance-addedit").modal("hide"),LoadPerformanceTrackings(0,!0),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator")):!n.result&&n.msg&&cleanBookNotification.error(_L(n.msg),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}})):(cleanBookNotification.error(_L("ERROR_MSG_806"),"Operator"),LoadingOverlayEnd())):$("li a[href=#perf-1]").trigger("click");LoadingOverlayEnd()});$(".btnNext").click(function(){var n=$(this).closest(".modal");$(n).find(".admintabs .active").next("li").find("a").trigger("click")});$(".btnPrevious").click(function(){var n=$(this).closest(".modal");$(n).find(".admintabs .active").prev("li").find("a").trigger("click")});LoadingOverlayEnd()})}function ShowGroupMember(){$("#team-person-preview").load("/Operator/ShowListMemberForWorkGroup?performanceId="+$("#performanceId").val()+"&wgId="+$("#performanceWorkgroup").val())}function getAllMeasureWithWeights(){var n=[];return $("#tblTrackingMeasures tbody tr").each(function(){var t=$(this).data("id"),i=$(this).data("weight");n.push({MeasureId:t,Weight:i})}),n}function loadModalForm(n){$("#app-operator-form-add").modal("show");$("#app-operator-form-add").load("/Operator/LoadModalForm",{id:n},function(){initFormModal()})}function initFormModal(){var n=$("#frmForm");$("#sortable").sortable();$("#frmForm .checkmulti").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});$('#frmForm input[data-toggle="toggle"]').bootstrapToggle();$("#frmForm .select2").select2({placeholder:"Please select"});$("#frmForm button.submit-status").click(function(){$(this).val()=="true"?$("#frmForm input[name=IsDraft]").prop("checked",!0):$("#frmForm input[name=IsDraft]").prop("checked",!1);n.trigger("submit")});n.validate({ignore:"",rules:{Title:{required:!0,maxlength:150},Description:{required:!0,maxlength:300},EstimatedTime:{required:!0},Tags:{required:!0}}});n.submit(function(t){var i,r,u;if(t.preventDefault(),n.valid()){if($.LoadingOverlay("show"),i=getDataFormElement(),r=!1,$.each(i,function(n,t){if(!t.Label||!t.AllowPhotos&&!t.AllowDocs&&!t.AllowNotes&&!t.AllowScore){r=!0;return}}),r){cleanBookNotification.error(_L("ERROR_MSG_710"),"Operator");LoadingOverlayEnd();return}u={Id:$("#frmForm input[name=Id]").val(),Title:$("#frmForm input[name=Title]").val(),Description:$("#frmForm textarea[name=Description]").val(),EstimatedTime:$("#frmForm input[name=EstimatedTime]").val(),IsDraft:$("#frmForm input[name=IsDraft]").prop("checked"),Tags:$("#frmForm select[name=Tags]").val(),FormElements:i};$.ajax({type:this.method,cache:!1,url:this.action,data:{formModel:u},dataType:"json",beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-form-add").modal("hide"),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator"),initFormsTable()):!n.result&&n.msg?cleanBookNotification.error(_L(n.msg),"Operator"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}})}else $('#tabForm li a[href="#form-0"]').trigger("click")});$("#frmForm .fieldtypes li a").bind("click",function(n){var i;n.preventDefault();var r=$(this).data("type"),t='<div id="{UNIQUEID}" class="ui-sortable-handle"><div class="row preview-area" onclick="$(this).next(\'.row-options\').slideToggle();">';t+='<div class="col-xs-12 col-sm-9"><h5><span>{FORM_TYPE}<input type="hidden" name="Type" value="{TYPE}" /><\/span> &nbsp; <i class="{UNIQUEID}_title">Click to configure<\/i><\/h5><\/div>';t+='<div class="col-xs-12 col-sm-3"><a href="#" class="remove" onclick="$(\'#{UNIQUEID}\').remove();"><i class="fa fa-remove"><\/i><\/a><\/div><\/div>';t+='<div class="row-options"><div class="row"><div class="col-xs-12">';t+='<textarea name="Label" class="form-control" onkeyup="$(\'.{UNIQUEID}_title\').html($(this).val());" placeholder="Enter a label or question"><\/textarea>';t+='<\/div><\/div><br /><div class="row"><div class="col-xs-12 col-sm-3"><div class="form-group checkbox toggle"><label style="font-weight: 500 !important; padding: 0;">Allow photo<\/label><br />';t+='<input name="AllowPhotos" data-toggle="toggle" data-onstyle="success" type="checkbox"><\/div><\/div><div class="col-xs-12 col-sm-3">';t+='<div class="form-group checkbox toggle"><label style="font-weight: 500 !important; padding: 0;">Allow document<\/label><br />';t+='<input name="AllowDocs" data-toggle="toggle" data-onstyle="success" type="checkbox"><\/div><\/div>';t+='<div class="col-xs-12 col-sm-3"><div class="form-group checkbox toggle"><label style="font-weight: 500 !important; padding: 0;">Allow score<\/label><br />';t+='<input name="AllowScore" onchange="getMeasuresFormElement(\'{UNIQUEID}\')" data-toggle="toggle" data-onstyle="success" type="checkbox" onchange="$(\'#{UNIQUEID} .scoring\').toggle();"><\/div><\/div>';t+='<div class="col-xs-12 col-sm-3"><div class="form-group checkbox toggle"><label style="font-weight: 500 !important; padding: 0;">Allow notes<\/label><br />';t+='<input name="AllowNotes" data-toggle="toggle" data-onstyle="success" type="checkbox" checked><\/div><\/div><\/div>';t+='<div class="scoring well custom" style="display: none; margin-top: 15px; margin-bottom: 0;"><label>Which Measure should be used?<\/label>';t+='<select name="AssociatedMeasureId" class="form-control select2" style="width: 100%;"><\/select><\/div><\/div><\/div>';i=UniqueId();t=t.replace(/{UNIQUEID}/g,i);switch(r){case"text":t=t.replace(/{FORM_TYPE}/g,"Free text").replace("{TYPE}",4);break;case"boolean":t=t.replace(/{FORM_TYPE}/g,"True or false").replace("{TYPE}",1);break;case"number":t=t.replace(/{FORM_TYPE}/g,"Number").replace("{TYPE}",2);break;case"date":t=t.replace(/{FORM_TYPE}/g,"Date").replace("{TYPE}",3)}$("#sortable").append(t);$('#frmForm input[data-toggle="toggle"]').bootstrapToggle()});$("#frmForm .btnNext").click(function(){var t=$("#app-operator-form-add");n.valid()?t.find("#tabForm .active").next("li").find("a").trigger("click"):t.find("#tabForm .active").find("a").trigger("click")});$("#frmForm .btnPrevious").click(function(){var n=$("#app-operator-form-add");n.find("#tabForm .active").prev("li").find("a").trigger("click")})}function getDataFormElement(){for(var t=$("#sortable div.ui-sortable-handle"),i=[],n=0;n<t.length;n++){var r=$(t[n]).find("input[name=FEId]"),u=$(t[n]).find("input[name=Type]"),f=$(t[n]).find("textarea[name=Label]"),e=$(t[n]).find("input[name=AllowPhotos]"),o=$(t[n]).find("input[name=AllowDocs]"),s=$(t[n]).find("input[name=AllowNotes]"),h=$(t[n]).find("input[name=AllowScore]"),c=$(t[n]).find("select[name=AssociatedMeasureId]"),l={Id:r?$(r).val():0,DisplayOrder:n,Type:$(u).val(),Label:$(f).val(),AllowPhotos:$(e).prop("checked"),AllowDocs:$(o).prop("checked"),AllowNotes:$(s).prop("checked"),AllowScore:$(h).prop("checked"),AssociatedMeasureId:$(c).val()};i.push(l)}return i}function loadOperatorFormTags(){$.get("/Operator/getTagsAll",function(n){n.length>0&&($("#slFormsTags").empty(),$("#slFormsTags").append('<option value="0" selected>Show all<\/option>'),n.forEach(function(n){$("#slFormsTags").append('<option value="'+n.Id+'">'+n.Name+"<\/option>")}),$("#slFormsTags").select2({placeholder:"Please select"}))})}function initFormsTable(){var n=$("#tblForms");n.dataTable({destroy:!0,serverSide:!0,paging:!0,searching:!1,autoWidth:!0,pageLength:10,ajax:{url:"/Operator/SearchForms",data:function(n){return $.extend({},n,{keyword:$("#txtFormsSearch").val(),tag:$("#slFormsTags").val()?$("#slFormsTags").val():0})}},columns:[{title:"Title",data:"Title",searchable:!0,orderable:!0},{title:"Description",data:"Description",searchable:!0,orderable:!0},{title:"EstimatedTime",data:"EstimatedTime",searchable:!0,orderable:!0},{title:"Status",data:"IsDraft",searchable:!1,orderable:!1},{title:"Tags",data:"Tags",searchable:!1,orderable:!1},{title:"Options",data:"Id",searchable:!0,orderable:!1}],columnDefs:[{targets:5,data:"Id",render:function(n){var t='<button class="btn btn-warning" onclick="loadModalForm('+n+')"><i class="fa fa-pencil"><\/i><\/button>&nbsp;';return t+('<button class="btn btn-danger" onclick="removeForm('+n+')"><i class="fa fa-trash"><\/i><\/button>')}},]})}function removeForm(n){bootbox.confirm({show:!0,backdrop:!0,closeButton:!0,animate:!0,title:"Operator",message:_L("ERROR_MSG_708"),callback:function(t){if(t){$.post("/Operator/RemoveForm",{id:n},function(n){n.result?(cleanBookNotification.success(_L("REMOVE_MSG_SUCCESS"),"Operator"),initFormsTable()):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"))});return}}})}function loadModalTask(n){$("#app-operator-compliance-task-add").modal("show");$("#app-operator-compliance-task-add").load("/Operator/LoadModalTask",{id:n},function(){initTaskModal()})}function initTaskModal(){var n=$("#frmTaskOperator");$("#frmTaskOperator .select2").select2({placeholder:"Please select"});$('#frmTaskOperator input[data-toggle="toggle"]').bootstrapToggle();n.validate({ignore:"",rules:{WorkgroupId:{required:!0},TaskName:{required:!0,maxlength:150},TaskDescription:{required:!0,maxlength:300},Forms:{required:!0},ExpectedEnd:{required:!0},Assignee:{required:!0},TaskType:{required:!0}}});n.submit(function(t){if(t.preventDefault(),n.valid()){$.LoadingOverlay("show");var i=document.getElementById("task-operator-file-input").files;i.length>0?UploadMediaS3ClientSide("task-operator-file-input").then(function(n){if(n.objectKey==="no_image"||n.objectKey==="no-image"){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#task-operator-file-object-key").val(n.objectKey);$("#task-operator-file-object-name").val(n.fileName);$("#task-operator-file-object-size").val(n.fileSize);SaveTaskOperator()}):($("#task-operator-file-object-key").val(""),$("#task-operator-file-object-name").val(""),$("#task-operator-file-object-size").val(""),SaveTaskOperator())}});$(".singledateandtime").daterangepicker({singleDatePicker:!0,timePicker:!0,autoApply:!0,showDropdowns:!0,autoUpdateInput:!0,cancelClass:"btn-danger",minDate:moment(),opens:"left",locale:{cancelLabel:"Clear",format:$dateFormatByUser.toUpperCase()+" "+$timeFormatByUser}});$("#frmTaskOperator .btnNext").click(function(){var t=$("#app-operator-compliance-task-add");n.valid()?t.find("#tab-modal-task .active").next("li").find("a").trigger("click"):t.find("#tab-modal-task .active").find("a").trigger("click")});$("#frmTaskOperator .btnPrevious").click(function(){var n=$("#app-operator-compliance-task-add");n.find("#tab-modal-task .active").prev("li").find("a").trigger("click")});$(".scroll-basket").slimScroll({height:"300px",railOpacity:1,railVisible:!0,alwaysVisible:!0,wheelStep:30,touchStep:30,color:"#989696",railColor:"#e1e1e1"})}function SaveTaskOperator(){var t="",n="",u=$("#TaskRecurtype").val(),i;u=="0"?(t="",$(".daily-day").each(function(){t+=$(this).attr("att-checked");$(this).is(":checked")&&(n==""?n=$(this).val():n+=","+$(this).val())})):u=="1"?(t="",$(".weekly-day").each(function(){t+=$(this).attr("att-checked");$(this).is(":checked")&&(n==""?n=$(this).val():n+=","+$(this).val())})):(t="",$(".monthTask").each(function(){t+=$(this).attr("att-checked");$(this).is(":checked")&&(n==""?n=$(this).val():n+=","+$(this).val())}));$("#hdTaskDayOrMonth").val(t);i=$("#frmTaskOperator select[name=WorkgroupId]").prop("disabled");i&&$("#frmTaskOperator select[name=WorkgroupId]").prop("disabled",!1);var r=new FormData($("#frmTaskOperator")[0]),f=!1,e=$("#create-task-recurrence").find("input[name=isRecurs]").is(":checked");if(e&&$("#lstDate tbody tr").find("input[type='checkbox']").each(function(){$(this).is(":checked")&&(f=!0,r.append("ListDates[]",$(this).attr("att-date")))}),e&&!f){i&&$("#frmTaskOperator select[name=WorkgroupId]").prop("disabled",!0);LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_110"),"Task");return}i&&$("#frmTaskOperator select[name=WorkgroupId]").prop("disabled",!0);$.ajax({type:"POST",cache:!1,url:"/Operator/SaveTaskOperator",data:r,enctype:"multipart/form-data",data:r,processData:!1,contentType:!1,beforeSend:function(){isBusy=!0},success:function(n){isBusy=!1;n.result?($("#app-operator-compliance-task-add").modal("hide"),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator"),initComplianceTasksTable()):!n.result&&n.msg?cleanBookNotification.error(_L(n.msg),"Operator"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator");LoadingOverlayEnd()},error:function(){isBusy=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator")}})}function taskRecursCheck(n){$(n).is(":checked")?($(n).prop("checked",!0),$(n).val(!0),$("#TaskRecurrence").css({display:"block"})):($(n).prop("checked",!1),$(n).val(!1),$("#TaskRecurrence").css({display:"none"}))}function loadWorkgroupPreviewTask(n){if($('#frmTaskOperator select[name="WorkgroupId"]').valid(),$(".preview-task-localtion").text(""),$(".preview-task-qbicle").text(""),$(".preview-task-members").text("0"),n)$.get("/Operator/LoadWorkgroupTaskPreview?wgid="+n,function(t){if(t){$(".preview-task-localtion").text(t.localtion);$(".preview-task-qbicle").text(t.qbicle);$(".preview-task-members").text(t.countmember);$(".preview-task-members").parent().attr("onclick","ShowTaskMembers("+n+")");var i=$("#frmTaskOperator select[name=Assignee]");i.removeAttr("disabled");i.empty();t.members.forEach(function(n){i.append('<option avatarUrl="'+n.AvatarUrl+'" value="'+n.UserId+'">'+n.Fullname+"<\/option>")});i.select2({placeholder:"Please select",templateResult:slformatOptions,templateSelection:slformatSelected})}});else{var t=$("#frmTaskOperator select[name=Assignee]");t.empty();t.attr("disabled",!0);t.select2({placeholder:"Please select"})}}function slformatOptions(n){if(!n.id)return n.text;var t=n.element.attributes.avatarUrl.value;return $('<div class="select2imgwrap"><div class="select2img" style="background-image: url(\''+t.toLowerCase()+'\');"><\/div> <span class="select2text">'+n.text+"<\/span><\/div>")}function slformatSelected(n){if(!n.id)return n.text;var t=n.element.attributes.avatarUrl.value;return $('<div class="select2imgwrap"><div class="select2img mini" style="background-image: url(\''+t.toLowerCase()+'\');"><\/div> <span class="select2text">'+n.text+"<\/span><\/div>")}function getMeasuresFormElement(n){$.get("/Operator/GetMeasures",function(t){if(t){var i=$("#"+n+" select[name=AssociatedMeasureId]");i.empty();t.forEach(function(n){i.append('<option value="'+n.Id+'">'+n.Name+"<\/option>")});i.select2({placeholder:"Please select"})}});$("#"+n+" .scoring").toggle()}function showRecur(n){if(n!=""){$("input[name=RecurEnd]").val($("input[name=ExpectedEnd]").val());$("input[name=RecurStartView]").val($("input[name=RecurStartView]").val());var t="";$("#TaskRecur").show();$(".task-recurtype").hide();n=="0"?t=".task-recur-daily":n=="1"?t=".task-recur-weekly":n=="2"&&(t=".task-recur-monthly");$(t).show()}else $("#TaskRecur").hide();$("#task-exclusion-list").css({display:"none"});genarateDateTable()}function updateRecur(){var n=$("#taskDuration").val(),i=$("#taskDurationUnit :selected").text().toLowerCase().trim(),t=$("#TaskRecurtype");t.empty();t.append('<option value="">Please select<\/option>');n!=""&&parseInt(n)>24&&i=="hours"?($("#task-indicated-duration").text(n+" "+i),$("#task-restricted").show(),t.append('<option value="1">Weekly<\/option>'),t.append('<option value="2">Monthly<\/option>')):n!=""&&parseInt(n)>1&&i=="days"?($("#task-indicated-duration").text(n+" "+i),$("#task-restricted").show(),t.append('<option value="1">Weekly<\/option>'),t.append('<option value="2">Monthly<\/option>')):n!=""&&parseInt(n)>7&&i=="days"?($("#task-indicated-duration").text(n+" "+i),$("#task-restricted").show(),t.append('<option value="1">Weekly<\/option>')):n!=""&&parseInt(n)>1&&i=="weeks"?($("#task-indicated-duration").text(n+" "+i),$("#task-restricted").show(),t.append('<option value="2">Monthly<\/option>')):(t.append('<option value="0">Daily<\/option>'),t.append('<option value="1">Weekly<\/option>'),t.append('<option value="2">Monthly<\/option>'));$("#TaskRecurtype").select2({placeholder:"Please select"});$("input[name='duration']").val(n+" "+i)}function genarateDateTable(n){var i=$("#TaskRecurtype").val(),r=$("#pattern :selected").val(),f=$("input[name='RecurEnd']").val(),e=$("input[name='RecurStart']").val(),u="",t,o;r==""&&(r="0");t="";o=0;u=r=="2"?$("#month-dates :selected").val():"0";i=="0"?$(".daily-day").each(function(){$(this).is(":checked")&&(t==""?t=$(this).val():t+=","+$(this).val())}):i=="1"?$(".weekly-day").each(function(){$(this).is(":checked")&&(t==""?t=$(this).val():t+=","+$(this).val())}):$(".monthTask").each(function(){$(this).is(":checked")&&(t==""?t=$(this).val():t+=","+$(this).val())});getListDate(t,i,r,u,f,e).done(function(t){var u,f,r;if(t!=""){for(u="",$("#lstDate tbody tr").remove(),f="",r=0;r<t.length;r++)u+="<tr>",u+="<td>"+t[r].Name+"<\/td>",u+='<td><input type="checkbox" '+(t[r].selected?"checked":"")+' value="'+t[r].Value+'"  att-date="'+t[r].Date+'"  ><\/td>',u+=" <\/tr>",f+=t[r].ShortName+",";$("#lstDate tbody").append(u)}n||$("#task-exclusion-list").attr("style").indexOf("display: block;")>0?$("#task-exclusion-list").css({display:"block"}):$("#task-exclusion-list").css({display:"none"});i==2&&$(".monthTask").each(function(){f!=null&&f.indexOf($(this).val())>-1?$(this).prop("checked",!0):$(this).prop("checked",!1)})})}function getListDate(n,t,i,r,u,f){return $.ajax({url:"/Operator/GetListDate",type:"POST",dataType:"json",data:{dayofweek:n,type:t,Pattern:i,customDate:r,LastOccurenceDate:u,FirstOccurenceDate:f}})}function changePattern(){$("#pattern :selected").val()=="2"?($("#customDate").show(),$("#hdTaskcustomDate").val($("#month-dates :selected").val())):$("#customDate").hide();genarateDateTable()}function changeTaskCheckItem(n){$(n).is(":checked")?$(n).attr("att-checked",1):$(n).attr("att-checked",0)}function initComplianceTasksTable(){var n=$("#tblComplianceTasks");n.dataTable({destroy:!0,serverSide:!0,paging:!0,searching:!1,autoWidth:!0,pageLength:10,ajax:{url:"/Operator/SearchTasks",data:function(n){return $.extend({},n,{keyword:$("#txtTaskKeyword").val(),assignee:$("#slTaskAssignee").val(),form:$("#slTaskForms").val()?$("#slTaskForms").val():0})}},columns:[{title:"Name",data:"Name",searchable:!0,orderable:!0},{title:"Assignee",data:"Assignee",searchable:!0,orderable:!0},{title:"Forms",data:"Forms",searchable:!1,orderable:!1},{title:"Type",data:"Type",searchable:!0,orderable:!0},{title:"Due",data:"Due",searchable:!0,orderable:!0},{title:"Options",data:"Id",searchable:!1,orderable:!1}],columnDefs:[{targets:1,data:"Id",render:function(n,t,i){return'<a href="/Community/UserProfilePage?uId='+i.AssigneeId+'" target="_blank">'+n+"<\/a>"}},{targets:5,data:"Id",render:function(n,t,i){var r='<div class="btn-group options"><button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cog"><\/i> Options<\/button>';return r+='<ul class="dropdown-menu dropdown-menu-right" style="right: 0;">',i.Type=="Repeatable"&&(r+='<li><a href="/Operator/ComplianceTask?id='+n+'">View in Qbicle<\/a><\/li>',r+='<li><a href="/Operator/ComplianceTaskInstances?id='+n+'">View submissions<\/a><\/li>'),r+='<li><a href="#" onclick="loadModalTask('+n+')">Edit<\/a><\/li>',r+('<li><a href="#" onclick="deleteComplianceTask('+n+')">Delete<\/a><\/li><\/ul><\/div>')}},]})}function loadOperatorForms(){$.get("/Operator/GetFormsAll",function(n){n.length>0?($("#slTaskForms").empty(),$("#slTaskForms").append('<option value="0" selected>Show all<\/option>'),n.forEach(function(n){$("#slTaskForms").append('<option value="'+n.Id+'">'+n.Title+"<\/option>")}),$("#slTaskForms").select2({placeholder:"Please select"}),$("#task-help-text").hide()):$("#task-help-text").show()})}function deleteComplianceTask(n){bootbox.confirm({show:!0,backdrop:!0,closeButton:!0,animate:!0,title:"Operator",message:_L("ERROR_MSG_708"),callback:function(t){if(t){$.LoadingOverlay("show");$.post("/Operator/DeleteTask",{id:n},function(n){n.result?(cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Operator"),$("#tblComplianceTasks").DataTable().ajax.reload()):!n.result&&n.msg?cleanBookNotification.error(_L(n.msg),"Operator"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Operator");LoadingOverlayEnd()});return}}})}function ShowTeamMembers(n){$("#app-operator-members").empty();$("#app-operator-members").modal("show");$("#app-operator-members").load("/Operator/LoadWorkgroupTeamMembers?wgid="+n,function(){$("#tblWorkgroupMembers").DataTable({responsive:!0,lengthChange:!0,pageLength:10,columnDefs:[{targets:2,orderable:!1}],order:[]})})}function ShowTaskMembers(n){$("#app-operator-members").empty();$("#app-operator-members").modal("show");$("#app-operator-members").load("/Operator/LoadWorkgroupTaskMembers?wgid="+n,function(){$("#tblWorkgroupMembers").DataTable({responsive:!0,lengthChange:!0,pageLength:10,columnDefs:[{targets:2,orderable:!1}],order:[]})})}var isBusy=!1,isHideLoading=!1,goalPageSize=8,perfomanceTrackingPageSize=8,isInitpagination=!1,$tblLeadingIndicators,$tblGoalMeasures;$(document).ready(function(){var t=window.location.href,i=new URL(t),n=i.searchParams.get("tab");$("#operatorQbicleId").val()=="0"&&(n="app-config");n?$("#tabApp a[href=#"+n+"]").trigger("click"):initTeamPerson();initSearch();initMeasureModal();$("#sl-media-type").change(searchThrottle(function(){LoadMedias()}));initModalClock();initModalSchedule()});