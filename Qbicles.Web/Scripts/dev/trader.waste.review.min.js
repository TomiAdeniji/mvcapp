function UpdateStatusApproval(n){var t=$("#action_approval_default").val();$.LoadingOverlay("show");CheckStatusApproval(n).then(function(i){if(LoadingOverlayEnd(),i.result&&i.Object.toLocaleLowerCase()==t.toLocaleLowerCase()){$("#approval-button div.loading-approval").removeClass("hidden");$("#approval-button div.general-approval").addClass("hidden");$("#approval-button").addClass("animated shake disabled");$("#spot-count-item-tbody").addClass("disabled");var r=$("#action_approval").val();$.LoadingOverlay("show");$.ajax({url:"/Qbicles/SetRequestStatusForApprovalRequest",type:"GET",dataType:"json",data:{appKey:n,status:r},success:function(n){LoadingOverlayEnd();n.actionVal>0&&RenderContentUpdated(!0)},error:function(){LoadingOverlayEnd();$("#spot-count-item-tbody").removeClass("disabled");$("#approval-button div.loading-approval").addClass("hidden");$("#approval-button div.general-approval").removeClass("hidden");cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}else cleanBookNotification.error(_L("ERROR_MSG_247"),"Qbicles"),setTimeout(function(){RenderContentUpdated()},1500)})}function RenderContentUpdated(n){LoadingOverlay();$("#waste_content").empty();$("#waste_content").load("/TraderWasteReport/UpdateWasteReportContent?id="+$("#wasteReport_id").val(),function(){LoadingOverlayEnd();n&&setTimeout(function(){cleanBookNotification.updateSuccess()},400)})}function UpdateItems(n){var i=$("#wasteReport_id").val(),t=$("#wasteReport_status").val();$.LoadingOverlay("show");CheckStatus(i,"WasteItem").then(function(i){if(LoadingOverlayEnd(),i.result&&i.Object.toLocaleLowerCase()==t.toLocaleLowerCase()){$.LoadingOverlay("show");var r={ProductList:[]},u={Id:n,CountUnit:{Id:$("#select-"+n).val()},WasteCountValue:$("#waste-"+n).val(),Notes:$("#note-"+n).val()};r.ProductList.push(u);$.ajax({type:"post",url:"/TraderWasteReport/UpdateWasteReportItems",data:{wasteReport:r},dataType:"json",success:function(n){LoadingOverlayEnd();n.actionVal===2?cleanBookNotification.updateSuccess():n.actionVal===3&&cleanBookNotification.error(n.msg,"Qbicles")},error:function(){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}else i.result&&i.Object.toLocaleLowerCase()!=t.toLocaleLowerCase()?(cleanBookNotification.error(_L("ERROR_MSG_272"),"Qbicles"),setTimeout(function(){window.location.reload()},1e3)):i.result==!1&&cleanBookNotification.error(_L("ERROR_MSG_380",[i.msg]),"Qbicles")})}function UpdateWasteItems(n){UpdateItems(n)}