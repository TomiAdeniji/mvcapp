function showprocesscontacts(n){$("#show-contacts .btn_process").attr("disabled",!n);n?($("#show-contacts .btn_process").removeClass("disabled"),$contactsCompleted="True"):($("#show-contacts .btn_process").addClass("disabled"),UpdateSelectedStep("contacts"),$contactsCompleted="False")}function showprocesstradercontacts(n){$("#show-contacts .btn_process").attr("disabled",!n);n?($("#show-contacts .btn_process").removeClass("disabled"),$traderContactsCompleted="True"):($("#show-contacts .btn_process").addClass("disabled"),UpdateSelectedStep("tradercontacts"),$traderContactsCompleted="False")}function showprocessqbicle(n){$("#show-qbicle .btn_process").attr("disabled",!n);n?($("#show-qbicle .btn_process").removeClass("disabled"),$qbicleCompleted="True"):($("#show-qbicle .btn_process").addClass("disabled"),UpdateSelectedStep("qbicle"),$qbicleCompleted="False")}function showprocessworkgroup(n){$("#show-qbicle .btn_process").attr("disabled",!n);n?($("#show-qbicle .btn_process").removeClass("disabled"),$qbicleCompleted="True"):($("#show-qbicle .btn_process").addClass("disabled"),UpdateSelectedStep("qbicle"),$qbicleCompleted="False")}function LoadContacts(){LoadingOverlay();$("#show-contacts .contacts-data").load("/SalesMarketing/LoadContact",function(){$("#age-ranges-table").DataTable({destroy:!0,responsive:!0,order:[[0,"asc"]],language:{lengthMenu:"_MENU_ &nbsp; per page"}});$("#sm-add-contact").remove();var n=$("#customCriteriaDefinitionId").val();n!==undefined&&(n!=="-1"?($contactsCompleted="True",$("#show-contacts .btn_process").attr("disabled",!1),$("#show-contacts .btn_process").removeClass("disabled")):($contactsCompleted="False",$("#show-contacts .btn_process").attr("disabled",!0),$("#show-contacts .btn_process").addClass("disabled")));LoadingOverlayEnd()})}function AddRowContactTable(){var n=$("#customCriteriaDefinitionId").val();$.ajax({url:"/SalesMarketing/SaveAgeRange",data:{id:-1,idCus:n!==undefined?n:-1,start:1,end:10},"async":!1,type:"POST",success:function(n){LoadingOverlayEnd();n.result?($(".contacts-data").show(),$("#show-contacts .btn_process").attr("disabled",!1),$("#show-contacts .btn_process").removeClass("disabled"),LoadContacts()):n.msg&&cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}});LoadingOverlayEnd()}function DeleteAgeRange(n){var t=confirm("Do you want remove this record?");t==!0&&($.ajax({url:"/SalesMarketing/DeleteAgeRange",data:{id:n},"async":!1,type:"POST",success:function(n){LoadingOverlayEnd();n.result?(LoadContacts(),cleanBookNotification.success(_L("ERROR_MSG_213"),"Sales Marketing")):n.msg&&cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}),LoadingOverlayEnd())}function onChangeAgeRange(n,t){var i=parseInt($("#ip-start-age-range-"+n).val()),r=parseInt($("#ip-end-age-range-"+n).val());i<0?cleanBookNotification.error(_L("ERROR_MSG_209"),"Sales Marketing"):r<0?cleanBookNotification.error(_L("ERROR_MSG_210"),"Sales Marketing"):i>r?cleanBookNotification.error(_L("ERROR_MSG_211"),"Sales Marketing"):($.ajax({url:"/SalesMarketing/SaveAgeRange",data:{id:n,idCus:t,start:i,end:r},"async":!1,type:"POST",success:function(n){LoadingOverlayEnd();n.result?cleanBookNotification.success(_L("ERROR_MSG_212"),"Sales Marketing"):n.msg&&cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}),LoadingOverlayEnd())}function SyncTrader(){$.LoadingOverlay("show");$("#sync-trader-table").load("/SalesMarketing/LoadSyncTraderSetup",function(){$("#trader-table").DataTable({destroy:!0,responsive:!0,order:[[0,"asc"]],language:{lengthMenu:"_MENU_ &nbsp; per page"}});LoadingOverlayEnd()})}function ReloadTopics(){var t=$("#setting_qbicle").val(),n=$("#setting_topic"),i=$("#btn-addWorkgroup");t>0?$.getJSON("/SalesMarketing/LoadTopicsByQbicleId",{qid:t},function(t){t&&t.length>0&&(n.prop("disabled",!1),i.prop("disabled",!1),n.empty(),n.select2({data:t,placeholder:"Please select"}),updateSetting())}):(n.prop("disabled",!0),i.prop("disabled",!0))}function LoadModalWorkgroup(n){$("#app-marketing-workgroup-add").load("/SalesMarketing/LoadModalWorkgroup",{id:n},function(){$("#source-qbicle,#default-topic,#slShow").select2();$(".checkmulti").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});$("#slProcess").change(function(){n.valid()});var n=$("#frm-workgroup-addedit");n.validate({ignore:"",rules:{Name:{required:!0,minlength:5},Process:{required:!0}}});$(".btnNext").click(function(){var n=$(this).closest(".modal");$(n).find(".app_subnav .active").next("li").find("a").trigger("click")});$(".btnPrevious").click(function(){var n=$(this).closest(".modal");$(n).find(".app_subnav .active").prev("li").find("a").trigger("click")});n.submit(function(t){var i,r,u;if(t.preventDefault(),i=$("#domainId-workgroup").val(),i===""){cleanBookNotification.error(_L("ERROR_MSG_214"),"Sales Marketing");return}if(r=$("#default-topic").val(),!r){cleanBookNotification.error(_L("ERROR_MSG_215"),"Sales Marketing");return}n.valid()?($.LoadingOverlay("show"),u=$(this).serialize(),$.ajax({type:this.method,url:this.action,data:u,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){if(n.result){$("#app-marketing-workgroup-add").modal("hide");var t=parseInt($("#wg-id").val());t>0?cleanBookNotification.success(_L("ERROR_MSG_216"),"Sales Marketing"):cleanBookNotification.success(_L("ERROR_MSG_217"),"Sales Marketing");$("#workgroups").click()}else cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing");isBusyAddTaskForm=!1;LoadTableWorkgroup();LoadingOverlayEnd()},error:function(){isBusyAddTaskForm=!1;LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}})):$('.app_subnav a[href="#add-specifics"]').click()})})}function LoadTableWorkgroup(){$.LoadingOverlay("show");var n=$("#swg").val();$("#content-workgroup-table").load("/SalesMarketing/LoadTableWorkgroup",function(){$("#workgroups-table").DataTable({destroy:!0,responsive:!0,order:[[0,"asc"]],language:{lengthMenu:"_MENU_ &nbsp; per page"}});n!==undefined&&($workgroupCompleted=n!==-1?"True":"False");LoadingOverlayEnd()})}function FilterMembers(){try{var n=$("#smkeyword").val(),t=$("#slShow").val();n?$("#wgMembers li").each(function(){var i=$(this),r=i.attr("fullname");t=="1"?i.hasClass("ismember")&&r.toLowerCase().indexOf(n.toLowerCase())!==-1?i.show():i.hide():r.toLowerCase().indexOf(n.toLowerCase())!==-1?i.show():i.hide()}):t=="1"?($("ul.widget-contacts li.ismember").show(),$("ul.widget-contacts li:not(.ismember)").hide()):$("ul.widget-contacts li").show()}catch(i){return}}function DeleteWorkgroup(){$.LoadingOverlay("show");var n=$("#wg-delete-id").val();$.ajax({url:"/SalesMarketing/DeleteWorkgroupById",data:{id:n},type:"POST",success:function(n){LoadingOverlayEnd();$("#app-marketing-delete-workgroup").modal("hide");n.result?(cleanBookNotification.success(_L("ERROR_MSG_218"),"Sales Marketing"),$("#wg-delete-id").val(0),LoadTableWorkgroup()):n.msg&&cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}})}function updateSetting(){$.LoadingOverlay("show");$.ajax({url:"/SalesMarketing/UpdateSetting",data:{id:$("#settingId").val(),qId:$("#setting_qbicle").val(),tId:$("#setting_topic").val()},type:"POST",success:function(n){LoadingOverlayEnd();n.result?($("#in-qbicle").val("1"),cleanBookNotification.success(_L("ERROR_MSG_208"),"Sales Marketing"),$("#show-qbicle .bt-qbicle").attr("disabled",!1),$("#show-qbicle .bt-qbicle").removeClass("disabled")):n.msg&&cleanBookNotification.error(n.msg,"Sales Marketing")},error:function(){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}})}function ContactsProcess(){switch_sm_setup("#show-contacts","#show-import");ShowStep("TraderContacts","show_content","/SalesMarketingSetup/ShowTraderContacts")}function TraderContactsProcess(){switch_sm_setup("#show-import","#show-qbicle");ShowStep("Qbicle","show_content","/SalesMarketingSetup/ShowQbicle")}function QbicleProcess(){switch_sm_setup("#show-qbicle","#show-workgroup");ShowStep("Workgroup","show_content","/SalesMarketingSetup/ShowWorkgroup")}function WorkgroupProcess(){switch_sm_setup("#show-workgroup","#show-success");ShowStep("Complete","show_content","/SalesMarketingSetup/ShowComplete")}function ShowStep(n,t,i){$.LoadingOverlay("show");UpdateSMIsSettingComplete(n,"setup");$("#"+t).empty();$("#"+t).load(i,function(){contact==="True"&&($(".contacts-data").show(),LoadContacts());traderContacts==="True";workgroup==="True"&&($(".contacts-data").show(),$(".workgroup-data").show(),$("#wg-proceed").attr("disabled",!1),LoadTableWorkgroup());$("#setting_qbicle,#setting_topic").select2({placeholder:"Please select"});$.LoadingOverlay("hide")})}function UpdateSMSettingCompleted(n){$.ajax({type:"post",url:"/SalesMarketingSetup/UpdateSMIsSettingComplete",data:{isComplete:n},datatype:"json",success:function(n){n===!0?window.location.href="/SalesMarketing/SMApps":cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function UpdateSMIsSettingComplete(n,t){t==="SMApps"&&(n="SMApps");$.ajax({type:"post",url:"/SalesMarketingSetup/UpdateSMIsSettingComplete",data:{isComplete:n},datatype:"json",success:function(n){t==="SMApps"?n===!0?window.location.href="/SalesMarketing/SMApps":cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles"):UpdateSelectedStep(t)},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function UpdateSMSettingCompleted(n){$.ajax({type:"post",url:"/SalesMarketingSetup/UpdateSMIsSettingComplete",data:{isComplete:n},datatype:"json",success:function(n){n===!0?window.location.href="/SalesMarketing/SMApps":cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function UpdateSelectedStep(n){$(".smsetup_"+n).removeClass("complete").addClass("incomplete")}function switch_sm_setup(n,t){$(n).hide();$(t).fadeIn();$(".wizard-steps li").each(function(){$("a",this).data("form")===n&&$(this).removeClass("active").addClass("complete");$("a",this).data("form")===t&&$(this).addClass("active").removeClass("complete").addClass("incomplete")})}function SelectContacts(n){GetIconSetup();SelectedStep(n,"Contacts","/SalesMarketingSetup/ShowContacts")}function SelectTraderContacts(n){GetIconSetup();SelectedStep(n,"TraderContacts","/SalesMarketingSetup/ShowTraderContacts")}function SelectQbicle(n){GetIconSetup();SelectedStep(n,"Qbicle","/SalesMarketingSetup/ShowQbicle")}function SelectWorkgroup(n){GetIconSetup();SelectedStep(n,"Workgroup","/SalesMarketingSetup/ShowWorkGroup")}function SelectCompleteSM(n){GetIconSetup();SelectedStep(n,"Complete","/SalesMarketingSetup/ShowComplete")}function GetIconSetup(){var n=$("#customCriteriaDefinitionId").val(),t=$("#in-qbicle").val(),i=$("#swg").val();n!==undefined&&($contactsCompleted=n!==-1?"True":"False");t!==undefined&&($qbileCompleted=t!=="-1"?"True":"False");i!==undefined&&($workgroupCompleted=i!==-1?"True":"False")}function SelectedStep(n,t,i){$("ul.sm_setup_ul li").removeClass("active");$(".smsetup_"+n).addClass("active");UpdateSMIsSettingComplete(t,n);$.LoadingOverlay("show");n!=="Contacts"&&($contactsCompleted==="True"?$(".smsetup_contacts").removeClass("incomplete").addClass("complete"):$(".smsetup_contacts").removeClass("complete").addClass("incomplete"));n!=="TraderContacts"&&($traderContactsCompleted==="True"?$(".smsetup_tradercontacts").removeClass("incomplete").addClass("complete"):$(".smsetup_tradercontacts").removeClass("complete").addClass("incomplete"));n!=="Qbicle"&&($qbileCompleted==="True"?$(".smsetup_qbicle").removeClass("incomplete").addClass("complete"):$(".smsetup_qbicle").removeClass("complete").addClass("incomplete"));n!=="Workgroup"&&($workgroupCompleted==="True"?$(".smsetup_workgroup").removeClass("incomplete").addClass("complete"):$(".smsetup_workgroup").removeClass("complete").addClass("incomplete"));$("#show_content").empty();$("#show_content").load(i,function(){contact==="True"&&($(".contacts-data").show(),LoadContacts());traderContacts==="True";workgroup==="True"&&($(".contacts-data").show(),$(".workgroup-data").show(),$("#wg-proceed").attr("disabled",!1),LoadTableWorkgroup());$("#setting_qbicle,#setting_topic").select2({placeholder:"Please select"})});LoadingOverlayEnd()}function removeMembers(n){var t=$("#slMembers").val(),i;if(t)for(i=0;i<t.length;i++)t.splice(i,1);$("#slMembers").val(t);$("#apr"+n).prop("checked",!1);$("#apr"+n).change()}function addMembers(n){var t=$("#slMembers").val();t||(t=[]);t.push(n);$("#slMembers").val(t)}function isValidWorkgroup(){var t=$("#social-campaign-workgroup").val(),n=$("#social-campaign-workgroup option:selected");$("td.info-process").text(n.attr("process"));$("td.info-members").text(n.attr("members"));disableCampaignForm(t?!1:!0)}function LoadingOverlay(){$.LoadingOverlay("show")}function LoadingOverlayEnd(){$.LoadingOverlay("hide")}var $contactsCompleted=$("#contactsCompleted").val(),$traderContactsCompleted=$("#traderContactsCompleted").val(),$qbileCompleted=$("#qbileCompleted").val(),$workgroupCompleted=$("#workgroupCompleted").val();$(document).ready(function(){contact==="True"&&($(".contacts-data").show(),LoadContacts());traderContacts==="True";workgroup==="True"&&($(".contacts-data").show(),$(".workgroup-data").show(),$("#wg-proceed").attr("disabled",!1),LoadTableWorkgroup())});