function ShowGroupMember(n,t){$("#app-trader-workgroup-preview").empty();$("#app-trader-workgroup-preview").load("/Trader/ShowListMemberForWorkGroup?wgId="+n+"&title="+t.replace(/\s/g,"%20"));$("#app-trader-workgroup-preview").modal("toggle")}function updateVariance(n,t){var i=parseFloat($("#tb_product tr.tr_"+n+" td.td_expected").text().replace(/\s/g,"")),r=parseFloat($("#tb_product tr.tr_"+n+" td.td_closing_count input").val());$("#tb_product tr.tr_"+n+" td.td_variance span").text((i-r).toFixed(2));UpdateProduct(n,t)}function UpdateProduct(n,t){var i=parseFloat($("#tb_product tr.tr_"+n+" td.td_closing_count input").val());$.LoadingOverlay("show");$.ajax({type:"post",url:"/TraderStockAudits/UpdateStockitem?id="+t+"&closingCount="+i,dataType:"json",success:function(t){t.actionVal===2?cleanBookNotification.updateSuccess():t.actionVal===3&&(cleanBookNotification.error(t.msg,"Qbicles"),$("#tb_product tr.tr_"+n+" td.td_closing_count input").val(oldClosingCount),$("#tb_product tr.tr_"+n+" td.td_variance span").text(oldvariance))},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles");$("#tb_product tr.tr_"+n+" td.td_closing_count input").val(oldClosingCount);$("#tb_product tr.tr_"+n+" td.td_variance span").text(oldvariance)}}).always(function(){$.LoadingOverlay("hide")})}function focusChange(n,t){oldClosingCount=$(t).val();oldvariance=$("#tb_product tr.tr_"+n+" td.td_variance span").text()}function RenderContentUpdated(n,t){$.LoadingOverlay("show");$("#shiftaudit_content").load("/TraderStockAudits/ShiftAuditReview?id="+$shiftAuditId+"&content="+n,function(){$.LoadingOverlay("hide");t&&$("#tb_product").DataTable().draw()})}function UpdateStatusApproval(n){var i=$("#action_approval_default").val(),t;$.LoadingOverlay("show");t=$("#action_approval").val();CheckStatusApproval(n).then(function(r){r.result&&r.Object.toLocaleLowerCase()===i.toLocaleLowerCase()?$.ajax({url:"/Qbicles/SetRequestStatusForApprovalRequest",type:"GET",dataType:"json",data:{appKey:n,status:t.split("_")[0]},success:function(){$.LoadingOverlay("hide");finishAudit(t);setTimeout(function(){RenderContentUpdated(!0,!0)},100)},error:function(){$.LoadingOverlay("hide");cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}):($.LoadingOverlay("hide"),cleanBookNotification.error(_L("ERROR_MSG_247"),"Qbicles"),setTimeout(function(){window.location.reload()},1e3))})}function finishAudit(n){var t={Id:$("#shiftaudit_id").val()};$.LoadingOverlay("show");$.ajax({type:"post",url:"/TraderStockAudits/FinishStockAudit?status="+n,data:{stockAudit:t},dataType:"json",success:function(n){LoadingOverlayEnd();n.actionVal===1?($("#app-trader-inventory-stock-audit").modal("toggle"),cleanBookNotification.createSuccess(),showStockAuditTable()):n.actionVal===2?($("#app-trader-inventory-stock-audit").modal("toggle"),cleanBookNotification.updateSuccess(),showStockAuditTable()):n.actionVal===3&&cleanBookNotification.error(n.msg,"Qbicles")},error:function(){$.LoadingOverlay("hide");cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function LoadComment(){$("#list-comments-approval").load("/Trader/LoadPostComment?type=StockAudit&id="+$shiftAuditId,function(){})}var oldClosingCount="",oldvariance="",busycomment=!1,$shiftAuditId=$("#shiftaudit_id").val();