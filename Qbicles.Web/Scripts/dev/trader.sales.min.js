function onSelectWorkgroup(n){filter.Workgroup=$(n).val();setTimeout(function(){searchOnTable()},200)}function OnSaleChanelChange(n){filter.SaleChanel=$(n).val();setTimeout(function(){searchOnTable()},200)}function onKeySearchChanged(n){filter.Key=$(n).val();setTimeout(function(){searchOnTable()},200)}function searchOnTable(){var i=[],n,t;if($("#subfilter-group").val()!==""&&$("#subfilter-group").val()!==null&&i.push($("#subfilter-group").val()),n=$("#search_dt").val(),$("#search_dt").val()!==""&&$("#search_dt").val()!==null&&n&&n.length>0)for(n=n.split(" "),t=0;t<n.length;t++)n[t]!==""&&i.push(n[t]);$("#tb_trader_sales").DataTable().search(i.join("|"),!0,!1,!0).draw();$("#tb_trader_sales_filter input").val("")}function addSale(){$.LoadingOverlay("show");$("#app-trader-sale-add").empty();$("#app-trader-sale-add").load("/TraderSales/TraderSaleAdd?locationId="+$("#local-manage-select").val(),function(){$("#tb_form_item").on("draw.dt",function(){$(this).find(".dataTables_empty").parents("tbody").empty()}).DataTable({destroy:!0,paging:!1,searching:!1,responsive:!0,ordering:!1,info:!1});LoadingOverlayEnd()})}function editSale(n){$.LoadingOverlay("show");$("#app-trader-sale-add").empty();$("#app-trader-sale-add").load("/TraderSales/TraderSaleAdd?locationId="+$("#local-manage-select").val()+"&tradersaleKey="+n,function(){$("#app-trader-sale-add").modal("toggle");$("#tb_form_item").on("draw.dt",function(){$(this).find(".dataTables_empty").parents("tbody").empty()}).DataTable({destroy:!0,paging:!1,searching:!1,responsive:!0,ordering:!1,info:!1});ResetItemSelected("tb_form_item","item-select-manage",undefined,undefined,$("#local-manage-select").val(),!1,!0,!1);LoadingOverlayEnd()})}function changeContact(n){$(n).val()!==""&&($("#sales_delivery").val()==="Delivery"?$(".delivery-stored").fadeIn():$(".delivery-stored").hide(),$(".delivery-details").hide(),$.ajax({type:"get",url:"/TraderSales/GetContactById?id="+$(n).val(),dataType:"json",success:function(n){var t=n.Name;n.Address&&($("#contact_address_id").val(n.Address.Id),n.Address.AddressLine1&&($("#form_contact_address_1").val(n.Address.AddressLine1),t+=",<\/br>"+n.Address.AddressLine1),n.Address.City&&($("#form_contact_address_2").val(n.Address.City),t+=",<\/br>"+n.Address.City),n.Address.AddressLine2&&($("#form_contact_address_city").val(n.Address.AddressLine2),t+=",<\/br>"+n.Address.AddressLine2),n.Address.State&&($("#form_contact_address_state").val(n.Address.State),t+=",<\/br>"+n.Address.State),n.Address.Country&&($("#form_contact_address_country").val(n.Address.Country.CommonName).trigger("change"),t+=",<\/br>"+n.Address.Country.CommonName),n.Address.PostCode&&($("#form_contact_address_postcode").val(n.Address.PostCode),t+=",<\/br>"+n.Address.PostCode),$("#address_info").empty(),$("#address_info").append(t))},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}))}function changeDelivery(){contact_address_id=$("#contact_address_id").val();$("#contact_address_id").val(0)}function usedDeliveryExists(){$(".delivery-details").hide();$(".delivery-stored").show();$("#contact_address_id").val(contact_address_id)}function nextToItems(){$("#form_add_transaction")[0].reset()}function ChangeSelectedUnit(){if($("#item-select-manage").val()!==null){$("#item_selected").empty();var n=$("#item-select-manage").find(":selected").attr("itemId"),t="/Trader/TraderSaleSelectUnit?idLocation="+$("#local-manage-select").val()+"&idTraderItem="+n+"&issale=true";$("#item_selected").load(t,function(){GetPriceSale($("#local-manage-select").val(),n);$("#form_item_quantity").val("0");$("#form_item_discount").val("0");$("#form_item_dimensions").val([]);$("#form_item_dimensions").not(".multi-select").select2({placeholder:"Please select."})})}}function GetPriceSale(n,t){isNaN(t)||($.LoadingOverlay("show"),$.ajax({type:"get",url:"/TraderSales/GetPriceByLocationIdItemId?locationId="+n+"&itemId="+t,dataType:"json",success:function(n){LoadingOverlayEnd();$("#price_id").val(n.Id);$("#price_value").val(n.NetPrice);$("#priceSale").val(n.NetPrice);selectedUnit($("#conversionsunitid option:first").val())},error:function(){LoadingOverlayEnd();selectedUnit($("#conversionsunitid option:first").val())}}))}function selectedUnit(){var n=$("#conversionsunitid").val(),t,i;n===null||n===""?($("#cpu").val(""),$("#label_cost").text("Cost per <selected unit>"),$("#label_price").text("Price per <selected unit>")):(n=$("#conversionsunitid").val().split("|"),$("#label_cost").text("Cost per "+n[2]),$("#label_price").text("Price per "+n[2]),t=0,i=0,n[5]==="true"?(t=parseFloat(n[3]),i=$("#price_value").val(),$("#item_selected input.costunitbase").val(t)):(t=parseFloat(n[3])*parseFloat($("#item_selected input.costunitbase").val()),i=parseFloat(n[3])*parseFloat($("#price_value").val())),isNaN(t)&&(t=0),isNaN(i)&&(i=0),$("#priceSale").val(i),$("#cpu").val(t));enableBtnAddRowTraderItem(!0)}function enableBtnAddRowTraderItem(){var n=$("#conversionsunitid").val(),t=parseFloat($("#form_item_quantity").val());n&&t>0?$("#btnAddRowItem").prop("disabled",!1):$("#btnAddRowItem").prop("disabled",!0)}function removeRowItem(n){$("#tb_form_item tbody tr"+n).remove();ResetItemSelected("tb_form_item","item-select-manage",undefined,undefined,$("#local-manage-select").val(),!1,!0,!1)}function addRowItem(){var s=UniqueId(),h=$("#form_item_dimensions").val(),c=$("#item_selected select").val(),k=$("#cpu").val(),r=$("#item-select-manage").find(":selected"),i=r.attr("itemId"),l=r.attr("itemName"),a=r.attr("itemImage"),v=r.attr("taxName"),y=r.attr("taxRate"),p=r.attr("costUnit"),t={Id:s,TraderItem:{Id:i,TaxName:v,ImageUri:a,Name:l,TaxRate:y,CostUnit:p},Discount:isNaN(parseFloat($("#form_item_discount").val()))?0:parseFloat($("#form_item_discount").val()),Dimensions:[],Quantity:parseFloat($("#form_item_quantity").val()),SalePricePerUnit:parseFloat($("#priceSale").val()),Unit:{},PriceBookPrice:{Id:$("#price_id").val(),Value:$("#price_value").val()},CostPerUnit:parseFloat($("#cpu").val()),Cost:0,Price:0},w=parseFloat($("#item_selected input.costunitbase").val()),n,f,e,o;t.Cost=(t.CostPerUnit*t.Quantity*(1-t.Discount/100)).toFixed($decimalPlace);var u=parseFloat(t.SalePricePerUnit)*parseFloat(t.Quantity)*(1-parseFloat(t.Discount)/100)*(1+parseFloat(t.TraderItem.TaxRate)/100),b=u/(1+t.TraderItem.TaxRate/100),d=parseFloat(u-b).toFixed($decimalPlace);t.Price=u;n=$("#tb_form_template tbody tr").clone();$(n).attr("id","tr_id_"+i);$($(n).find("td.row_image div")).attr("style","background-image: url('"+$("#api_url").val()+t.TraderItem.ImageUri+"&size=T');");$($(n).find("td.row_name")).text(t.TraderItem.Name);$($(n).find("td.row_unit")).empty();f=$("#item_selected select").clone();$($(n).find("td.row_unit")).append(f);e='<input type="hidden" class="costunitbase" value="'+w+'" />';$($(n).find("td.row_unit")).append(e);$($(n).find("td.row_unit select")).val(c);$($(n).find("td.row_unit select")).attr("onchange","rowUnitChange('#tr_id_"+i+"')");$($(n).find("td.row_costperunit input")).val(t.CostPerUnit);$($(n).find("td.row_costperunit input")).attr("onchange","UpdateCost('#tr_id_"+i+"')");$($(n).find("td.row_costprice input")).val(t.SalePricePerUnit);$($(n).find("td.row_quantity input")).val(t.Quantity);$($(n).find("td.row_quantity input")).attr("onchange","UpdateCost('#tr_id_"+i+"')");$($(n).find("td.row_discount input")).val(t.Discount);$($(n).find("td.row_discount input")).attr("onchange","UpdateCost('#tr_id_"+i+"')");$($(n).find("td.row_taxrate")).text(t.TraderItem.TaxRate);$($(n).find("td.row_taxname")).html(showTaxRatesDetail(t.SalePricePerUnit,t.Quantity,t.Discount,t.TraderItem.TaxName));$($(n).find("td.row_dimensions select")).val(h);$($(n).find("td.row_cost")).text(toCurrencySymbol(t.Cost,!1));$($(n).find("td.row_price input")).val(t.Price.toFixed($decimalPlace)).attr("onchange","UpdateSaleItemPrice("+i+")");$($(n).find("td.row_button button")).attr("onclick","removeRowItem('#tr_id_"+i+"')");$($(n).find("td.row_button input.traderItem")).val(i);$($(n).find("td.row_button input.row_id")).val(t.Id);$($(n).find("td.row_button input.price_id")).val(t.PriceBookPrice.Id);$($(n).find("td.row_button input.price_Value")).val(t.PriceBookPrice.Value);$($(n).find("td select")).not(".multi-select").select2();o=$("#tb_form_item tbody tr#tr_id_"+i);o.length===0?$("#tb_form_item tbody").append(n):cleanBookNotification.error(_L("ERROR_MSG_646"),"Qbicles");setTimeout(function(){$("#form_add_transaction")[0].reset();$("#form_add_transaction select").not(".multi-select").not('[name="traderitem"]').select2("val","");$("#conversionsunitid").val("");$("#conversionsunitid").select2({placeholder:"Please select"})},100);$("#btnAddRowItem").prop("disabled",!0);ResetItemSelected("tb_form_item","item-select-manage",undefined,undefined,$("#local-manage-select").val(),!1,!0,!1)}function rowUnitChange(n){var u,t,i,r;isNaN(parseFloat(n.toString()))||(n="#tr_id_"+n);u=$("#tb_form_item tbody tr"+n+" td.row_button input.traderItem").val().split("|");t=$("#tb_form_item tbody tr"+n+" td.row_unit select").val().split("|");t[1]==="BaseUnit"?$("#tb_form_item tbody tr"+n+" td.row_costperunit input").val(u[3]):t[1]==="Conversion Unit"&&$("#tb_form_item tbody tr"+n+" td.row_costperunit input").val(parseFloat(u[3])*parseFloat(t[3]));i=0;r=0;t[5]==="true"?(i=parseFloat(t[3]),r=$("#tb_form_item tbody tr"+n+" td.row_button input.price_Value").val(),$("#tb_form_item tbody tr"+n+" td.row_unit input.costunitbase").val(i)):(i=parseFloat(t[3])*parseFloat($("#tb_form_item tbody tr"+n+" td.row_unit input.costunitbase").val()),r=parseFloat(t[3])*parseFloat($("#tb_form_item tbody tr"+n+" td.row_button input.price_Value").val()));$("#tb_form_item tbody tr"+n+" td.row_costperunit input").val(i);$("#tb_form_item tbody tr"+n+" td.row_costprice input").val(r);UpdateCost(n)}function UpdateSaleItemPrice(n){var i=$("#tb_form_item tbody tr#tr_id_"+n+" td.row_quantity input").val(),r=isNaN($("#tb_form_item tbody tr#tr_id_"+n+" td.row_discount input").val())?0:$("#tb_form_item tbody tr#tr_id_"+n+" td.row_discount input").val(),f=$("#tb_form_item tbody tr#tr_id_"+n+" td.row_taxrate").text(),s=$("#tb_form_item tbody tr#tr_id_"+n+" td.row_taxname .txt-taxname").val(),u=$("#tb_form_item tbody tr#tr_id_"+n+" td.row_price input").val(),e=$("#tb_form_item tbody tr#tr_id_"+n+" td.row_costprice input").val(),o,t;isNaN(i)||isNaN(r)||isNaN(u)||i==0||r==100||f==-100||(t=r,u==0?(t=100,$("#tb_form_item tbody tr#tr_id_"+n+" td.row_discount input").val(t)):(o=Number(i)*Number(e)*(1+Number(f)/100),t=((1-Number(u)/o)*100).toFixed($decimalPlace),$("#tb_form_item tbody tr#tr_id_"+n+" td.row_discount input").val(t)),$("#tb_form_item tbody tr#tr_id_"+n+" td.row_taxname").html(showTaxRatesDetail(e,i,t,s)))}function UpdateCost(n){var t=$("#tb_form_item tbody tr"+n+" td.row_costprice input").val(),i=$("#tb_form_item tbody tr"+n+" td.row_quantity input").val(),r=$("#tb_form_item tbody tr"+n+" td.row_discount input").val(),f=$("#tb_form_item tbody tr"+n+" td.row_taxrate").text(),u,e;isNaN(parseFloat(t))||isNaN(parseFloat(i))||isNaN(parseFloat(r))||isNaN(parseFloat(f))||(u=parseFloat(t)*parseFloat(i)*(1-parseFloat(r)/100)*(1+parseFloat(f)/100),$("#tb_form_item tbody tr"+n+" td.row_cost").text(toCurrencySymbol(u,!1)),$("#tb_form_item tbody tr"+n+" td.row_price input").val(u.toFixed($decimalPlace)),e=$("#tb_form_item tbody tr"+n+" td.row_taxname input.txt-taxname").val(),$("#tb_form_item tbody tr"+n+" td.row_taxname").html(showTaxRatesDetail(t,i,r,e)))}function nextToConfirm(){var n,e,i,r,u;$("#tb_confirm tbody").empty();var t=$("#tb_form_item tbody tr"),o=$("#tb_form_item tbody tr td"),f=0;if(t.length!==1||o.length!==1){for(n=0;n<t.length;n++){if(e=stringToNumber($($(t[n]).find("td.row_price input")).val()),f+=e,i="<tr> <td>"+$($(t[n]).find("td.row_image")).html()+"<\/td>",i+="<td>"+$($(t[n]).find("td.row_name")).text()+"<\/td> <td>"+$($(t[n]).find("td.row_unit select option:selected")).text()+"<\/td>",i+="<td>"+$($(t[n]).find("td.row_costprice input")).val()+"<\/td>",i+=" <td>"+$($(t[n]).find("td.row_quantity input")).val()+"<\/td> <td>"+$($(t[n]).find("td.row_discount input")).val()+"%<\/td> <td>"+$($(t[n]).find("td.row_taxname")).html()+"<\/td>",i+="<td>",r=$($(t[n]).find("td.row_dimensions select option:selected")),r.length>0)for(u=0;u<r.length;u++)i+='<span class="label label-info label-lg">'+$(r[u]).text()+"<\/span> ";i+="<\/td>";i+="<td>"+$($(t[n]).find("td.row_price input")).val()+"<\/td> <\/tr>";$("#tb_confirm tbody").append(i)}$("#total_id").text(toCurrencySymbol(f));validateSendToReview()}}function validateSendToReview(){var n=$("#tb_form_item tbody tr"),t=$("#tb_form_item tbody tr td");n.length>0&&t.length>1?($("#a_send_toreview_sale").removeAttr("disabled"),$("#a_send_toreview_sale").removeClass("disabled")):($("#a_send_toreview_sale").attr("disabled"),$("#a_send_toreview_sale").addClass("disabled"))}function SaveSaleDraft(){SaveSale("Draft")}function SaveSaleReview(){SaveSale("PendingReview")}function SaveSale(n){var s={Id:$("#trader_sale_add_workgroup").val()},h,r,a,c,t,i,l,f,v,u,e,o,y,p,w;if(s.Id===""||s.Id===null){$('.admintabs a[href="#sale-1"]').tab("show");cleanBookNotification.error(_L("ERROR_MSG_168"),"Qbicles");return}if(h=$("#form_sale_contact").val(),h===""||h===null){$('.admintabs a[href="#sale-1"]').tab("show");cleanBookNotification.error(_L("ERROR_MSG_644"),"Qbicles");return}if(r={Id:$("#contact_address_id").val()},a={Id:$("#reference_id").val(),NumericPart:parseFloat($("#refedit").text()),Type:$("#reference_type").val(),Prefix:$("#reference_prefix").val(),Suffix:$("#reference_suffix").val(),Delimeter:$("#reference_delimeter").val(),FullRef:$("#reference_fullref").val()},r.Id==="0"&&(r.AddressLine1=$("#form_contact_address_1").val(),r.AddressLine2=$("#form_contact_address_2").val(),r.City=$("#form_contact_address_city").val(),r.State=$("#form_contact_address_state").val(),r.Country={CommonName:$("#form_contact_address_country").val()},r.PostCode=$("#form_contact_address_postcode").val()),c=[],t=$("#tb_form_item tbody tr"),t.length>0)for(i=0;i<t.length;i++){if(l=parseInt($($(t[i]).find("td.row_button input.row_id")).val()),f={Id:0},$($(t[i]).find("td.row_button input.traderItem")).val()!==null?f.Id=$($(t[i]).find("td.row_button input.traderItem")).val():f=null,v=$($(t[i]).find("td.row_quantity input")),parseFloat(v.val())<=0){cleanBookNotification.error(_L("ERROR_MSG_637"),"Qbicles");$('.admintabs a[href="#sale-2"]').tab("show");return}if(u=$($(t[i]).find("td.row_dimensions select")).val(),e=[],u&&u.length>0)for(o=0;o<u.length;o++)e.push({Id:u[o]});if(e.length===0&&n==="PendingReview"){cleanBookNotification.error(_L("ERROR_MSG_635"),"Qbicles");$('.admintabs a[href="#sale-2"]').tab("show");return}y=$($(t[i]).find("td.row_unit select")).val().split("|");p={Id:isNaN(l)?0:l,TraderItem:f,Discount:$($(t[i]).find("td.row_discount input")).val(),Dimensions:e,Quantity:$($(t[i]).find("td.row_quantity input")).val(),Unit:{Id:y[1]},CostPerUnit:stringToNumber($($(t[i]).find("td.row_costperunit input")).val()),SalePricePerUnit:stringToNumber($($(t[i]).find("td.row_costprice input")).val()),Cost:stringToNumber($($(t[i]).find("td.row_cost")).text()),Price:stringToNumber($($(t[i]).find("td.row_price input")).val()),PriceBookPrice:{Id:$($(t[i]).find("td.row_button input.price_id")).val()},PriceBookPriceValue:$($(t[i]).find("td.row_button input.price_Value")).val()};c.push(p)}w={Key:$("#tradersale_form_key").val(),Location:{Id:$("#local-manage-select").val()},SaleItems:c,SaleTotal:stringToNumber($("#total_id").text()),Purchaser:{Id:$("#form_sale_contact").val()},DeliveryAddress:r,Status:n,Reference:a,SalesChannel:"Trader",DeliveryMethod:$("#sales_delivery").val(),Workgroup:s};$.LoadingOverlay("show");$.ajax({type:"post",url:"/TraderSales/SaveTraderSale?countryName="+$("#form_contact_address_country").val(),data:{traderSale:w},dataType:"json",success:function(n){n.actionVal===1?($("#app-trader-sale-add").modal("toggle"),cleanBookNotification.createSuccess(),setTimeout(function(){ShowTableSaleValue(!0)},500)):n.actionVal===2?($("#app-trader-sale-add").modal("toggle"),cleanBookNotification.updateSuccess(),setTimeout(function(){ShowTableSaleValue(!0)},500)):n.actionVal===3&&cleanBookNotification.error(n.msg,"Qbicles");LoadingOverlayEnd()},error:function(n){$.LoadingOverlay("hide");cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}})}function WorkGroupSelectedChange(){$workgroupId=$("#trader_sale_add_workgroup").val();$workgroupId!==""?$.ajax({type:"get",url:"/TraderTransfers/getworkgroup?id="+$workgroupId,dataType:"json",success:function(n){$(".preview-workgroup").show();n.result?($(".preview-workgroup table tr td.location_name").text(n.Object.Location),$(".preview-workgroup table tr td.workgroup_process").text(n.Object.Process),$(".preview-workgroup table tr td.workgroup_qbicle").text(n.Object.Qbicle),$(".preview-workgroup table tr td.workgroup_member span").text(n.Object.Members)):($(".preview-workgroup table tr td.location_name").text(""),$(".preview-workgroup table tr td.workgroup_process").text(""),$(".preview-workgroup table tr td.workgroup_qbicle").text(""),$(".preview-workgroup table tr td.workgroup_member span").text(""))},error:function(n){$(".preview-workgroup").hide();cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}):$(".preview-workgroup").hide()}function ShowGroupMember(){$("#app-trader-workgroup-preview").empty();$("#app-trader-workgroup-preview").load("/TraderTransfers/ShowListMemberForWorkGroup?wgId="+$workgroupId);$("#app-trader-workgroup-preview").modal("toggle")}function ShowTableSaleValue(n){n||$("#trader-sale-content").LoadingOverlay("show");$("#trader-sale-content").empty();$("#trader-sale-content").load("/TraderSales/TraderSaleRecordsTable",filter,function(){$("#trader-sale-content").LoadingOverlay("hide")})}function callBackDataTableTraderSale(){$("#tb_trader_sales").DataTable().ajax.reload();getDashBoardTotalValue()}function LoadDataSales(){$("#tb_trader_sales").on("processing.dt",function(n,t,i){$("#processingIndicator").css("display","none");i&&$(".loadingoverlay").length===0?$("#table_show").LoadingOverlay("show",{minSize:"70x60px"}):$("#table_show").LoadingOverlay("hide",!0)}).DataTable({destroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',language:{infoFiltered:""},serverSide:!0,info:!1,stateSave:!1,bLengthChange:!0,paging:!0,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,ajax:{url:"/TraderSales/GetDataTableSales",type:"GET",dataType:"json",data:function(n){return $.extend({},n,{keyword:$("#search_dt").val(),workGroupId:$("#subfilter-group").val()?$("#subfilter-group").val():0,channel:$("#subfilter-channel").val(),datetime:$("#sale-input-datetimerange").val(),isApproved:!1})}},columns:[{name:"FullRef",data:"FullRef",orderable:!0},{name:"WorkgroupName",data:"WorkgroupName",orderable:!0},{name:"CreatedDate",data:"CreatedDate",orderable:!0},{name:"SalesChannel",data:"SalesChannel",orderable:!0},{name:"Contact",data:"Contact",orderable:!0},{name:"Dimensions",data:"Dimensions",orderable:!1},{name:"SaleTotal",data:"SaleTotal",orderable:!0},{name:"Status",data:"Status",orderable:!0,render:function(n,t,i){return'<span class="label label-lg '+i.LabelStatus+'">'+i.Status+"<\/span>"}},{name:null,data:null,orderable:!1,width:"100px",render:function(n,t,i){return""+(i.Status==="Draft"?i.AllowEdit?'<button class="btn btn-info" onclick="editSale(\''+i.Key+'\')"><i class="fa fa-pencil"><\/i> &nbsp; Continue<\/button>':'<button class="btn btn-info hidden" onclick="editSale(\''+i.Key+'\')"><i class="fa fa-pencil"><\/i> &nbsp; Continue<\/button>':'<button class="btn btn-primary" onclick="window.location.href = \'/TraderSales/SaleMaster?key='+i.Key+'\';"><i class="fa fa-eye"><\/i> &nbsp; Manage<\/button>')}}],order:[[2,"desc"]]})}function showDashboard(){isShowDashboard=!isShowDashboard;isShowDashboard?$(".dash-concise").fadeIn():$(".dash-concise").fadeOut()}function getDashBoardTotalValue(){$(".loadingoverlay").length===0&&$.LoadingOverlay("show");$("#section_dashboard").load("/TraderSales/TraderSaleGetDataDashBoard?keyword="+$("#search_dt").val()+"&workGroupId="+$("#subfilter-group").val()+"&datetime="+$("#sale-input-datetimerange").val().replace(/\s/g,"%20")+"&channel="+$("#subfilter-channel").val(),function(){LoadingOverlayEnd()})}function showDetailTraderItemByGroup(n){$.LoadingOverlay("show");var t=$("#sale-input-datetimerange").val();$("#app-trader-product-group").load("/TraderSales/TraderSaleGetDetailTraderItems?ids="+n,{datetime:t},function(){LoadingOverlayEnd()})}function GetDataTableContentExport(n=1){var t,i;$.LoadingOverlay("show");t=$("#tb_trader_sales").DataTable().ajax.params();console.log(t,"params");i={...t,"export":n};$.ajax({type:"GET",url:"/Report/GetSalesOrderTableContentExport",dataType:"json",data:i,success:function(n){n.result==!0&&(console.log(n,"response"),window.location.href=n.Object,cleanBookNotification.success("Export downloaded successfully!","Qbicles"));$.LoadingOverlay("hide")},error:function(n){console.log(n,"error");$.LoadingOverlay("hide")}})}var contact_address_id,isShowDashboard;$(function(){$("#subfilter-group").select2();$("#subfilter-channel").select2();$("#subfilter-group").on("change",delay(function(){callBackDataTableTraderSale()},0));$("#search_dt").keyup(delay(function(){callBackDataTableTraderSale()},2e3));$('.manage-columns input[type="checkbox"]').on("change",function(){var t=$("#tb_trader_sales").DataTable(),n=t.column($(this).attr("data-column"));n.visible(!n.visible())});$("#subfilter-channel").on("change",delay(function(){callBackDataTableTraderSale()},0));$(".datetimerange").daterangepicker({autoUpdateInput:!0,timePicker:!0,cancelClass:"btn-danger",opens:"right",startDate:new Date($("#fromDateTime").val()),endDate:new Date($("#toDateTime").val()),locale:{cancelLabel:"Clear",format:$dateTimeFormatByUser}});$(".datetimerange").on("apply.daterangepicker",function(n,t){$(this).val(t.startDate.format($dateTimeFormatByUser)+" - "+t.endDate.format($dateTimeFormatByUser));$(".datetimerange").html(t.startDate.format($dateTimeFormatByUser)+" - "+t.endDate.format($dateTimeFormatByUser));filter.DateRange=$("#sale-input-datetimerange").val();callBackDataTableTraderSale()});$(".datetimerange").on("cancel.daterangepicker",function(){$(this).val(null);filter.DateRange=$("#sale-input-datetimerange").val();$(".datetimerange").html("full history");callBackDataTableTraderSale()});LoadDataSales()});ChangeSaleWorkgroup=function(n){WorkGroupSelectedChange();$("#item-select-manage").empty().trigger("change");var t=$(n).val();ResetItemSelected("tb_form_item","item-select-manage",undefined,t,$("#local-manage-select").val(),!1,!0,!1)};contact_address_id=$("#contact_address_id").val();isShowDashboard=!1;