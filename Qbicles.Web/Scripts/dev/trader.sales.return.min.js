function OnSelectWorkgroupReturn(n){filter.Workgroup=$(n).val();setTimeout(function(){SearchOnSaleReturnTable()},200)}function OnKeySearchReturnChanged(n){filter.Key=$(n).val();setTimeout(function(){SearchOnSaleReturnTable()},200)}function SearchOnSaleReturnTable(){var i=[],n,t;if($("#subfilter-group-return").val()!==""&&$("#subfilter-group-return").val()!==null&&i.push($("#subfilter-group-return").val()),n=$("#search_dt_return").val(),$("#search_dt_return").val()!==""&&$("#search_dt_return").val()!==null&&n&&n.length>0)for(n=n.split(" "),t=0;t<n.length;t++)n[t]!==""&&i.push(n[t]);$("#tb_trader_sales_return").DataTable().search(i.join("|"),!0,!1,!0).draw();$("#tb_trader_sales_return_filter input").val("")}function CallBackDataTableTraderSaleReturn(){$("#tb_trader_sales_return").DataTable().ajax.reload()}function LoadDataSalesReturn(){$("#tb_trader_sales_return").on("processing.dt",function(n,t,i){i&&$(".loadingoverlay").length===0?$("#tblwrapreturn").LoadingOverlay("show"):$("#tblwrapreturn").LoadingOverlay("hide",!0)}).DataTable({destroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',language:{infoFiltered:""},serverSide:!0,info:!1,stateSave:!1,bLengthChange:!0,paging:!0,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,ajax:{url:"/TraderSalesReturn/GetDataTableSalesReturn",type:"GET",dataType:"json",data:function(n){return $.extend({},n,{keyword:$("#search_dt_return").val(),workGroupId:$("#subfilter-group-return").val()?$("#subfilter-group-return").val():0})}},columns:[{name:"FullRef",data:"FullRef",orderable:!0},{name:"WorkgroupName",data:"WorkgroupName",orderable:!0},{name:"CreatedDate",data:"CreatedDate",orderable:!0},{name:"SalesRef",data:"SalesRef",orderable:!0,render:function(n,t,i){return"<a href='/TraderSales/SaleMaster?key="+i.SaleRefKey+"'>"+i.SalesRef+"<\/a>"}},{name:"Status",data:"Status",orderable:!0,render:function(n,t,i){var r="";switch(i.Status){case"Draft":r+='<span class="label label-lg label-info">Draft<\/span>';break;case"PendingReview":r+='<span class="label label-lg label-warning">Awaiting Review<\/span>';break;case"PendingApproval":r+='<span class="label label-lg label-success">Awaiting Approval<\/span>';break;case"Denied":r+='<span class="label label-lg label-danger">Denied<\/span>';break;case"Approved":r+='<span class="label label-lg label-primary">Approved<\/span>';break;case"Discarded":r+='<span class="label label-lg label-danger">Discarded<\/span>';break;case"Reviewed":r+='<span class="label label-lg label-primary">Reviewed<\/span>';break;default:r+='<span class="label label-lg label-info">Draft<\/span>'}return r}},{name:null,data:null,orderable:!1,width:"100px",render:function(n,t,i){return""+(i.Status==="Draft"?i.AllowEdit?'<button class="btn btn-info" onclick="EditSaleReturn(\''+i.Id+'\')"><i class="fa fa-pencil"><\/i> &nbsp; Continue<\/button>':'<button class="btn btn-info hidden"><i class="fa fa-pencil"><\/i> &nbsp; Continue<\/button>':'<button class="btn btn-primary" onclick="window.location.href = \'/TraderSalesReturn/SaleReturnMaster?id='+i.Id+'\';"><i class="fa fa-eye"><\/i> &nbsp; Manage<\/button>')}}],order:[[2,"desc"]]})}function ShowTableSaleReturnValue(){$("#trader-sale-return-content").empty();$("#trader-sale-return-content").load("/TraderSalesReturn/TraderSaleReturnTable",filter,function(){})}function AddSaleReturn(){AjaxElementShowModal("/TraderSalesReturn/TraderSaleReturnAdd","app-trader-sale-return-add")}function EditSaleReturn(n){var t="/TraderSalesReturn/TraderSaleReturnAdd?traderSaleReturnId="+n;AjaxElementShowModal(t,"app-trader-sale-return-add")}function ShowGroupMemberReturn(){$("#app-trader-workgroup-preview").empty();$("#app-trader-workgroup-preview").load("/TraderTransfers/ShowListMemberForWorkGroup?wgId="+$workgroupId);$("#app-trader-workgroup-preview").modal("toggle")}$(function(){$("#subfilter-group-return").select2();LoadDataSalesReturn();$("#subfilter-group-return").on("change",delay(function(){CallBackDataTableTraderSaleReturn()},0));$("#search_dt").keyup(delay(function(){CallBackDataTableTraderSaleReturn()},2e3));$('.manage-columns input[type="checkbox"]').on("change",function(){var t=$("#tb_trader_sales_return").DataTable(),n=t.column($(this).attr("data-column"));n.visible(!n.visible())})});ChangeWorkgroupReturn=function(){var n=$("#trader_sale_return_add_workgroup").val();n!==""?$.ajax({type:"get",url:"/TraderTransfers/getworkgroup?id="+n,dataType:"json",success:function(n){$(".preview-workgroup").show();n.result?($(".preview-workgroup table tr td.location_name").text(n.Object.Location),$(".preview-workgroup table tr td.workgroup_process").text(n.Object.Process),$(".preview-workgroup table tr td.workgroup_qbicle").text(n.Object.Qbicle),$(".preview-workgroup table tr td.workgroup_member span").text(n.Object.Members)):($(".preview-workgroup table tr td.location_name").text(""),$(".preview-workgroup table tr td.workgroup_process").text(""),$(".preview-workgroup table tr td.workgroup_qbicle").text(""),$(".preview-workgroup table tr td.workgroup_member span").text(""))},error:function(n){$(".preview-workgroup").hide();cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}):$(".preview-workgroup").hide()};