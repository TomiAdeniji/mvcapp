function format(n){var t=n.element,i=n.text;return $('<div title="'+i+" "+$(t).data("mytxt")+'">'+i+' <span class="newTxt">'+$(t).data("mytxt")+"<\/span><\/div>")}function resetTitlle(){$("#alertConfigureColumns1").empty().append("<p>Below you will find the data from your imported file. Above each column is a select box which you can use to specify what each column is in your import. If a column isn't required, simply select <strong><i>ignore<\/i><\/strong><\/p><\/br>")}function configureColumns(){var s,h,n,i,r,u,f;cleanBookNotification.clearmessage();$DefineColumnsData.attr("disabled","");s=!1;h=!1;_headersSelected=[];n=[];$("#tabletransactionNew  tbody  tr").find(".columnSelected").each(function(t){if(selectedVal=$(this).val().replace(" ",""),_headersSelected[t]=selectedVal,selectedVal.toString().startsWith("Ignore"))n[t]=selectedVal;else{var i=selectedVal.lastIndexOf("_");n[t]=i<=0?"":selectedVal.substring(i,0)}});var e=n.reduce(function(n,t,i,r){return r.indexOf(t)!==i&&n.indexOf(t)<0&&n.push("It is not possible to select two <strong>"+t+"<\/strong> columns. Please change your selection.<\/br>"),n},[]),t=[],o=getCookie("headercol");if(o&&(t=o.replace(" ","").split(",")),i=!0,r=!1,e.length===0){if(t.length>0&&n.length===0)i=!0;else for(u=0;u<t.length;u++){for(r=!1,f=0;f<n.length;f++)if(t[u].replace(" ","")===n[f].replace(" ","")){r=!0;break}if(!r){i=!1;break}}i?$DefineColumnsData.removeAttr("disabled",""):$DefineColumnsData.attr("disabled","")}else $DefineColumnsData.attr("disabled","");if(e.length>0){cleanBookNotification.warning($.unique(e),"CleanBooks");return}}function SaveGroup(){Save_Group()}function Save_Group(){$("#form_group").valid()&&$.ajax({url:"/ManageAccounts/DuplicateAccountGroup",data:{Id:$input_group_id.val(),Name:$input_group_name.val()},type:"GET",dataType:"json"}).done(function(n){n?$("#form_group").validate().showErrors({Name:"Account Group name of '"+$input_group_name.val()+"' already exists."}):$("#form_group").trigger("submit")}).fail(function(){$("#form_group").validate().showErrors({Name:"Error checking existing name of group in the current Domain!"})})}function EditGroup(n,t){$("#"+t).hasClass("isDisabled")||(ClearError(),n&&n>0&&$.ajax({type:"GET",url:"/ManageAccounts/GetAccountGroup",datatype:"json",data:{id:n},success:function(n){n.Id&&($("#form_group").validate().resetForm(),$input_group_id.val(n.Id),$input_group_name.val(n.Name),$input_group_createddate.val(n.CreatedDate?new Date(parseInt(n.CreatedDate.substr(6))).toJSON():null),$input_group_createdbyid.val(n.CreatedById),$modal_group_title.text("Edit Group"),$("#save-group").text("Confirm"),$modal_group.modal("toggle"))},error:function(n){cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}))}function AddAccount(n){var t="/ManageAccounts/GetAccount2AddEdit?id=0&groupId="+n;AjaxElementShowModal(t,"modal_account")}function EditCbAccount(n){var t="/ManageAccounts/GetAccount2AddEdit?id="+n;AjaxElementShowModal(t,"modal_account")}function DeleteAccount(n,t,i,r,u,f,e){e.className.indexOf("isDisabled")!==0&&$.ajax({type:"post",url:"/ManageAccounts/ValidDeleteAccount",dataType:"json",data:{accountId:n},success:function(e){e.status===!0?($("#permission-del-account").show(),$("#confirm-del-account").hide(),$("#task-name-permission-account").text(t)):($trDelete=$("#account-tr-"+n),$liDelete=$("#account-"+n),$accountIdDelete=n,$accountNameDelete=t,$accountNumberDelete=i,$accountCreateDate=u,$accountCreateBy=r,$accountDataManage=f,$("#permission-del-account").hide(),$("#confirm-del-account").show(),$("#task-name-confirm-account").text(t));$modal_account_remove.modal("toggle")}})}function AccountDelete(){if(!($accountIdDelete<=0)){var n={Id:$accountIdDelete,Name:$accountNameDelete,Number:$accountNumberDelete,CreatedDate:$accountCreateDate,CreatedById:$accountCreateBy,DataManagerId:$accountDataManage};$.ajax({type:"post",url:"/ManageAccounts/DeleteAccount",dataType:"json",data:n,success:function(n){n.status?($modal_account_remove.modal("toggle"),$($trDelete).css("background-color","#FF3700"),$($trDelete).fadeOut(1500,function(){$($trDelete).remove()}),$($liDelete).css("background-color","#FF3700"),$($liDelete).fadeOut(1500,function(){$($liDelete).remove()}),$accountIdDelete=0,cleanBookNotification.success(_L("ERROR_MSG_469"),"Qbicles")):cleanBookNotification.error(_L("ERROR_MSG_458",[$accountNameDelete]),"Qbicles")}})}}function SaveCBAccount(){if($("#role_grant").val()===null){cleanBookNotification.error(_L("ERROR_MSG_459"),"Qbicles");return}Save_Account()}function Save_Account(){var i,t,n,r;if($("#form_accout").valid()){for(i=[],t=[],t=$("#select_user_role").select2("data"),n=0;n<t.length;n++)i[n]=t[n].text;r=!1;$.ajax({type:"post",url:"/ManageAccounts/CheckUploadFields",dataType:"json",data:{uploadfields:JSON.stringify(i)},success:function(n){if(!n){cleanBookNotification.clearmessage();cleanBookNotification.warning("Date and Description fields are mandatory fields. At least a Debit or Credit field must also be selected.","Qbicles");return}$.ajax({type:"post",url:"/ManageAccounts/DupplicateAccount",dataType:"json",data:{Id:$input_account_id.val(),Name:$input_account_name.val(),GroupId:$select_account_group.val()},success:function(n){if(n)$("#form_accout").validate().showErrors({Name:"Account name of '"+$input_account_name.val()+"' already exists."});else{$.LoadingOverlay("show");var t={Id:$("#input_account_id").val(),IsActive:$("#input_account_isactive").val(),CreatedDate:$("#input_account_createddate").val(),CreatedById:$("#input_account_createdbyid").val(),Name:$("#input_account_name").val(),GroupId:$("#select_account_group").val(),Number:$("#input_account_number").val(),LastBalance:$("#input_account_lastbalance").val(),UpdateFrequencyId:$("#select_Frequency_type").val(),DataManagerId:$("#select_datamanager_type").val(),BookkeepingAccount:{id:$("#selected-bookkeeping-account-id").val()},WorkGroup:{Id:$("#select_account_workgroup").val()}},i=$("#select_user_role").val(),r=$("#role_grant").val();$.ajax({type:"post",dataType:"json",url:"/ManageAccounts/SaveCBAccount?isEditLastbalance="+$("#isEditLastbalance").val()+"&uploadFields="+i.join(),data:{account:t},success:function(n){n.result?($("#account-page-display").empty(),$("#account-page-display").html("<div id='account-content'><\/div>"),LoadAccounts(""),$modal_account.modal("toggle"),n.actionVal===1?cleanBookNotification.success(_L("ERROR_MSG_470"),"Qbicles"):n.actionVal===2&&cleanBookNotification.success(_L("ERROR_MSG_471"),"Qbicles")):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}).always(function(){LoadingOverlayEnd()})}},error:function(n){cleanBookNotification.error("Have an error when save account!"+$input_group_name.val()+": "+n.error,"Qbicles")}})}})}}function LoadAccounts(n){$.LoadingOverlay("show");$.ajax({url:"/ManageAccounts/LoadAccounts/",data:{groupId:$selectFilter.val(),orderBy:$selectOrder.val()},cache:!1,type:"POST",success:function(t){if(t.length!==0)if($(t.ModelString).insertAfter("#account-content").hide().fadeIn(1e3),n==="init")DisplayView("grid");else if(typeof Storage!="undefined"){var i=sessionStorage.getItem("showType");DisplayView(i)}else DisplayView("grid")},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function DisplayView(n){SetShowAccountType(n);$(".account-view").hide();n==="grid"?($("#grid-view").addClass("active"),$("#grid_view").show()):($("#list-view").addClass("active"),$("#list_view").show())}function SetShowAccountType(n){typeof Storage!="undefined"?(sessionStorage.removeItem("showType"),sessionStorage.setItem("showType",n)):cleanBookNotification.warning("Your browser is too old. Please upgrade your browser!","Qbicles")}function swichPage(){var n=document.getElementById("menu-select").value;n==="Tasks"?window.location="/Apps/Tasks":n==="Accounts"?window.location="/Apps/Accounts":n==="Config"&&(window.location="/Apps/CleanBookConfig")}function ClearError(){$("label.error").hide();$(".error").removeClass("error");$("label.valid").hide();$(".valid").removeClass("valid")}function ResizeAble(){setTimeout(function(){var n=$("#containerdiv").width();$("#resizediv").width(n);$("#resizediv").css({height:"400px",overflow:"auto"})},50)}function close_modal_upload(){$.ajax({type:"post",url:"/Transactions/RemoveSession"})}function GetMaxUploads(n){return $.ajax({url:"/ManageAccounts/GetMaxUploadToAccount",type:"GET",dataType:"json",data:{accountId:n}})}function AddNewUpload(n,t,i,r,u,f){if(f.className.indexOf("isDisabled")!==0){$dlsheetname.hide();$ReadSheetData.attr("disabled","");$DefineColumnsData.attr("disabled","");$buttonProceed4.attr("disabled","");$buttoncheckscan.attr("disabled","");$lblcheckfilefeedback.text("");$input_transaction_upload.val(null);$(".fileinput").fileinput("clear");$(".app_subnav li").removeClass("active");$(".tab-content div").removeClass("active");$("#modal_transaction_edit.tab-content").show();$("#step_2_edit").addClass("in active");$("#stepv2edit").addClass("in active");$selectedGroupAccountId=n;$accountName=i;$selectedAccountId=t;$accountLastBalanceSelected=u;var e=i+" - "+r;GetMaxUploads($selectedAccountId).done(function(n){var t=new Date;$label_upload_name.text(e+" - "+t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" - "+n.result);CheckExistsAccount=n.existsUpload;n.existsUpload?($("#opening_balance").css({display:"none"}),$("#lblOpenBalance").css({display:"block"}),$("#lblOpenBalance").html($.number(n.lastbalance,2)),$("#opening_balance").val(n.lastbalance)):($("#opening_balance").css({display:"block"}),$("#lblOpenBalance").css({display:"none"}),$("#opening_balance").val(n.lastbalance),$("#lblOpenBalance").html($.number(n.lastbalance,2)));$("#account-upload-content").css({display:"block"});$modal_transaction_edit.modal("toggle")}).error(function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}).fail(function(n){cleanBookNotification.error(n.responseText,"Qbicles")})}}function RemoveSheetSelect(){document.getElementById("select_sheetnameFile").innerHTML="";$select_sheetnameFile.val(null).trigger("change")}function CheckFileTypeVirusScaning(){var n=$('[name="excelFile"]').val().trim(),t=n.lastIndexOf("."),i=t<=0?"":n.substring(t),r={fileName:"Excel",fileExtension:i};RemoveSheetSelect();$.ajax({type:"post",url:"/Transactions/ValidationFileType",dataType:"json",data:r,success:function(n){if(n.valid===1)$lblcheckfilefeedback.text(""),$buttoncheckscan.removeAttr("disabled",""),scaning_virus();else{if(n.valid===0){$lblcheckfilefeedback.text(_L("ERROR_MSG_460"));return}$lblcheckfilefeedback.text(_L("ERROR_MSG_461"));return}},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function scaning_virus(){var t=$("#input_transaction_upload")[0].files,n;if(!t){$lblcheckfilefeedback.text("Please browse a correct Excel file to upload");return}n=new FormData;n.append("file",t[0]);$.ajax({url:"/Transactions/VirusSacning",type:"POST",data:n,processData:!1,contentType:!1}).done(function(t){t.IsVirusFree?$.ajax({url:"/Transactions/ReadSheets",dataType:"json",type:"POST",data:n,processData:!1,contentType:!1}).done(function(n){if(!n.Status.Success){$lblcheckfilefeedback.text(n.Status.Message);cleanBookNotification.error(_L("ERROR_MSG_462",[$('[name="excelFile"]').val().trim().replace("C:\\fakepath\\","")]),"Qbicles");return}var t;$.each(n.Sheets,function(){t=this.sheetId;var n=new Option(this.sheetName,this.sheetId,!1,!1);$select_sheetnameFile.append(n).trigger("change")});$dlsheetname.show();$lblcheckfilefeedback.text("");cleanBookNotification.success(_L("ERROR_MSG_472"),"Cleanbooks");$ReadSheetData.removeAttr("disabled","")}).error(function(){return cleanBookNotification.error(_L("ERROR_MSG_462",[$('[name="excelFile"]').val().trim().replace("C:\\fakepath\\","")]),"Qbicles"),!1}).fail(function(n){cleanBookNotification.error(n.responseText,"Qbicles")}):($lblcheckfilefeedback.text(t.Message),$ReadSheetData.attr("disabled",""),cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles"))}).error(function(){return cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles"),!1}).fail(function(n){cleanBookNotification.error(n.responseText,"Qbicles")})}function dateFormatSlected(){configureColumns(1)}function ReadSheetData_Click(){_heads=[];colHeadIndex=1;var n=new FormData;return n.append("sheetId",$select_sheetnameFile.select2("data")[0].id),n.append("accountId",$selectedAccountId),n.append("_SheetName",$select_sheetnameFile.select2("data")[0].text),n.append("lastBalance",$("#opening_balance").val()),$.ajax({url:"/Transactions/ExcelFileUpload",dataType:"json",type:"POST",data:n,processData:!1,contentType:!1}).done(function(n){var t,i;if(setCookie("headercol",n.headColRequire),n.bindFormat==="Done"?n.headColRequire!==""?$("#alertConfigureColumns1").empty().append("<p>Below you will find the data from your imported file. Above each column is a select box which you can use to specify what each column is in your import. If a column isn't required, simply select <strong><i>ignore<\/i><\/strong>").append("<strong>The previous format for uploading transactions to this account has been applied.<\/strong><\/p>").append("<\/br><div class='alert alert-danger' style='margin-bottom: 0;'>NOTE: Uploading transactions to this account requires the following fields: "+n.headColRequire+".<\/div>"):$("#alertConfigureColumns1").empty().append("<p>Below you will find the data from your imported file. Above each column is a select box which you can use to specify what each column is in your import. If a column isn't required, simply select <strong><i>ignore<\/i><\/strong><\/p>").append("<p><strong>The previous format for uploading transactions to this account has been applied.<\/strong><\/p>"):n.headColRequire!==""?$("#alertConfigureColumns1").empty().append("<p>Below you will find the data from your imported file. Above each column is a select box which you can use to specify what each column is in your import. If a column isn't required, simply select <strong><i>ignore<\/i><\/strong><\/p>").append("<\/br><div class='alert alert-danger' style='margin-bottom: 0;'>NOTE: Uploading transactions to this account requires the following fields: "+n.headColRequire+".<\/div>"):$("#alertConfigureColumns1").empty().append("<p>Below you will find the data from your imported file. Above each column is a select box which you can use to specify what each column is in your import. If a column isn't required, simply select <strong><i>ignore<\/i><\/strong><\/p>"),n.StartReadSheetData!==1){if(n.status==="Error"){cleanBookNotification.error(_L("ERROR_MSG_462",[$('[name="excelFile"]').val().trim().replace("C:\\fakepath\\","")]),"Qbicles");return}if(n.status==="NoData"){cleanBookNotification.error(_L("ERROR_MSG_463"),"Qbicles");return}if(n.status==="Error"){cleanBookNotification.error(n.message,"Qbicles");return}if($stepv3edit_tableNew.find("tbody").empty(),$stepv3edit_tableNew.find("tbody").append(n.dataTransactionsNew),ResizeAble(),$("select").not(".single-select").select2({templateResult:format}),colCount=n.colCount,CheckExistsAccount){for(t=$("#lblOpenBalance").html(),i=0;i<t.length;++i)t[i]===","&&(t=t.replace(",",""));$accountLastBalanceSelected=t}else $accountLastBalanceSelected=$("#opening_balance").val();configureColumns(1);$(document).find(".active").removeClass("active");$("#step_3_edit").addClass("in active");$("#stepv3edit").addClass("in active");return}}).error(function(){return cleanBookNotification.error(_L("ERROR_MSG_462",[$('[name="excelFile"]').val().trim().replace("C:\\fakepath\\","")]),"Qbicles"),!1}).fail(function(n){cleanBookNotification.error(n.responseText,"Qbicles")}),!1}function ValidationSelectedHeadColumns(n,t){var i={values:JSON.stringify(n)};return $.ajax({url:"/Transactions/ValidationSelectedHeadColumns",type:"GET",dataType:"json",data:{heads:JSON.stringify(n),accountId:t}})}function DefineColumnsData_Click(){Loading_proceed();$.ajax({type:"post",url:"/Transactions/DataAnalyse",dataType:"json",data:{AccountId:$selectedAccountId,headerColumns:JSON.stringify(_headersSelected),accountName:$accountName,accountLastBalance:JSON.stringify($accountLastBalanceSelected)},success:function(n){if(n.StartDataAnalyse===1){EndLoading2();return}var t=document.getElementById("Divuploaderror"),i=document.getElementById("Divuploadnoerror");if(t.style.display="none",t.style.height="0px",i.style.display="block",$stepv4AnalysedData_table.find("tbody").empty(),$stepv4AnalysedData_table.find("tbody").append(n.dataAnalysedData),$stepv4display_table.find("tbody").empty(),$stepv4display_table.find("tbody").append(n.dataTransactions),n.warningbalance!==""){t.style.display="block";t.style.height="150px";i.style.display="none";cleanBookNotification.error(_L("ERROR_MSG_464"),"Qbicles");$("#linkerrorfile").attr("href",n.Errorfile);$buttonProceed4.attr("disabled","");EndLoading2();return}n.dataTransactions!==""?($buttonProceed4.removeAttr("disabled",""),$("#list_dateformat").empty().append(n.GenListdateFormat),$("#list_dateformat").trigger("change")):(cleanBookNotification.warning(_L("ERROR_MSG_465"),"Qbicles"),$buttonProceed4.attr("disabled",""));EndLoading2()},error:function(){EndLoading2();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles");$buttonProceed4.attr("disabled","")}})}function ConfirmUpload(){Loading_save();var n=$('[name="excelFile"]').val().trim(),i=n.lastIndexOf("\\"),r={Name:$label_upload_name.text()},u={Name:$label_upload_name.text(),FileName:n.substring(i+1),AccountId:$selectedAccountId},t="";t=$("#list_dateformat").val();$.ajax({url:"/Transactions/Confirm2Save",type:"post",dataType:"json",data:{uploadModal:u,uploadFormatModal:r,dateFormat:t,headerColumns:JSON.stringify(_headersSelected),selectedGroupAccountId:$selectedGroupAccountId}}).done(function(n){if(n.actionVal===1){document.getElementById("last-update-"+$selectedAccountId).innerHTML=n.msgName;var t="",i="";n.msg.indexOf(".")>0?(t=n.msg.split(".")[0],i=n.msg.split(".")[1]):t=n.msg;document.getElementById("last-balance-before-"+$selectedAccountId).innerHTML=t;document.getElementById("last-balance-after-"+$selectedAccountId).innerHTML="."+i;document.getElementById("last-update-tr-"+$selectedAccountId).innerHTML=n.msgName;document.getElementById("last-balance-tr-"+$selectedAccountId).innerHTML=n.msg;$modal_transaction_edit.modal("hide");cleanBookNotification.success(_L("ERROR_MSG_473"),"Qbicles")}else n.actionVal===2||n.actionVal===0?cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles"):n.actionVal===3&&cleanBookNotification.error(_L("ERROR_MSG_466"),"Qbicles");EndLoading2();close_modal_upload()}).error(function(){EndLoading2();cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}).fail(function(n){cleanBookNotification.error(n.responseText,"Qbicles")})}function ShowUploadHistory(n){$("#upload-history").empty();$.ajax({url:"/ManageAccounts/UploadPreview/",data:{accountId:n,isDelete:$("#right-delete-history").val()},cache:!1,type:"POST",success:function(n){n.length!==0&&$("#upload-history").append(n).hide().fadeIn(1e3)},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}});$modal_transaction_preview.modal("toggle")}function DeleteAccountUploadImportTransaction(n,t){if(t.className.indexOf("isDisabled")!==0){$uploadIdDelete=n;$uploadNameDelete=$("#upload-name-"+n).val();$accountIdDelete=$("#account-id-"+n).val();$accountNameDelete=$("#account-name-"+n).val();$uploadFormatId=$("#UploadFormatId-"+n).val();var i={Id:n,Name:$uploadNameDelete,AccountId:$accountIdDelete,CreatedDate:$("#create-date-"+n).val()};$.ajax({type:"post",url:"/Transactions/ValidDelete",dataType:"json",data:i,success:function(n){if(n.resLastUpload===""&&n.resTransaction===""){cleanBookNotification.error("Have an error when Delete upload. Please contact the system administrator for help.","Qbicles");return}n.resLastUpload?n.resLastUpload&&(n.resTransaction?($("#permission-del").show(),$("#confirm-del").hide(),$("#upload-name-permission").text($uploadNameDelete),$("#account-name-permission").text($accountNameDelete),$("#temp-name-permission").text("Transactions from this upload are currently being used in a task.")):($("#permission-del").hide(),$("#confirm-del").show(),$("#upload-name-confirm").text($uploadNameDelete),$("#account-name-confirm").text($accountNameDelete))):($("#permission-del").show(),$("#confirm-del").hide(),$("#upload-name-permission").text($uploadNameDelete),$("#account-name-permission").text($accountNameDelete),$("#temp-name-permission").text("You may only select the last upload to the Account to be deleted."));$modal_upload_remove.modal("toggle")},error:function(){cleanBookNotification.error("Have an error when Delete upload. Please contact the system administrator for help.","Qbicles")}})}}function ConfirmDeleteUpload(){if(!($uploadIdDelete<=0)){var n={Id:$uploadIdDelete,Name:$uploadNameDelete,UploadFormatId:$uploadFormatId,AccountId:$accountIdDelete};$.ajax({type:"post",url:"/Transactions/DeleteUpload",dataType:"json",data:n,success:function(n){if(n.status){$modal_upload_remove.modal("hide");cleanBookNotification.removeSuccess();$trDelete=$("#upload-preview-tr-"+$uploadIdDelete);$($trDelete).css("background-color","#FF3700");$($trDelete).fadeOut(1e3,function(){$($trDelete).remove()});$("#upload_preview-"+$uploadIdDelete).remove();document.getElementById("last-update-"+n.AccountId).innerHTML=n.LastUpload;var t="",i="";n.LastBalance.indexOf(".")>0?(t=n.LastBalance.split(".")[0],i=n.LastBalance.split(".")[1]):n.LastBalance===""?(t="0",i="00"):(t=n.LastBalance,i="00");document.getElementById("last-balance-before-"+n.AccountId).innerHTML=t;document.getElementById("last-balance-after-"+n.AccountId).innerHTML="."+i;document.getElementById("last-update-tr-"+n.AccountId).innerHTML=n.LastUpload;document.getElementById("last-balance-tr-"+n.AccountId).innerHTML=n.LastBalance}else cleanBookNotification.error(n.msg,"Qbicles")}})}}function Loading_proceed(){generateModalprocess("Processing")}function Loading_save(){generateModalprocess("Saving")}function generateModalprocess(n){var t='<div id="modal-loading-parent" class="modal fade" role="dialog" style="opacity: 0.6;background: #000;display: block;"> <\/div><div id="modal-loading" class="modal fade" style="margin-top: 14%;"><div class="modal-dialog">  <div class="modal-content">  <div class="modal-body text-center">   <br /> <i class="fa fa-spinner fa-4x fa-spin" style="margin-bottom: 20px;"><\/i> <h4>'+n+' Data, please wait...<\/h4> <br /><br /> <\/div> <\/div> <\/div> <\/div><input type="button" data-toggle="modal" data-target="#modal-loading" id="popdialogloading" style="display:none" />';$("body").append(t);$("#popdialogloading").click()}function ShowImportFromBookkeeping(n){$(".loading-placeholder").show();$(".imported-data-transaction").hide();$("#app-cb-account-import").modal("show");var t="/CleanBooksAccount/ShowImportFromBookkeeping?accountId="+n;$(".imported-data-transaction").load(t,function(){$(".loading-placeholder").hide();$(".imported-data-transaction").fadeIn()})}function ImportFromBookkeeping(n){$.LoadingOverlay("show");$.ajax({type:"get",url:"/CleanBooksAccount/ImportFromBookkeeping?accountId="+n,dataType:"json",success:function(t){t.result?($("#app-cb-account-import").modal("hide"),document.getElementById("last-update-"+n).innerHTML=t.msg,document.getElementById("last-update-tr-"+n).innerHTML=t.msg,cleanBookNotification.createSuccess()):cleanBookNotification.error(t.msg,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}var $selectFilter=$("#filter-group"),$selectOrder=$("#filter-order"),$select_user_role=$("#select_user_role"),$button_add_group=$("#button_add_group"),$button_add_account=$("button[name='button_add_account']"),$trDelete=null,$modal_group=$("#modal_group"),$modal_group_title=$("#modal_group [class='modal-title']"),$input_group_id=$("#input_group_id"),$input_group_name=$("#input_rectaskgroup_name"),$input_group_createddate=$("#input_group_createddate"),$input_group_createdbyid=$("#input_group_createdbyid"),$input_account_id=$("#input_account_id"),$input_account_name=$("#input_account_name"),$input_account_number=$("#input_account_number"),$input_account_isactive=$("#input_account_isactive"),$input_account_createddate=$("#input_account_createddate"),$input_account_createdbyid=$("#input_account_createdbyid"),$input_account_lastbalance=$("#input_account_lastbalance"),$select_UpdateFrequency_type=$("#select_Frequency_type"),$select_datamanager_type=$("#select_datamanager_type"),$select_account_group=$("#select_account_group"),$modal_account_remove=$("#modal-delete-account"),$modal_account=$("#modal_account"),$createByDiv=$("#create-by-div"),$createDateDiv=$("#create-date-div"),$createdBy=$("#CreatedByName"),$createDate=$("#CreatedDateValue"),$modal_account_title=$("#modal_account [class='modal-title']"),$accountEditId=0,$accountGroupId=0,$modal_transaction_edit=$("#modal_transaction_edit"),$modal_transaction_preview=$("#modal_transaction_preview"),$modal_transaction_preview_title=$("#modal_transaction_preview [class='modal-title']"),$button_transaction_preview=$("a[name='button_transaction_preview']"),$button_transaction_delete=$("a[name='button_transaction_delete']"),$modal_upload_remove=$("#modal-delete"),$stepv3edit_tableNew=$("#tabletransactionNew");$stepv4display_table=$("#tableConfirmDisplay");$stepv4AnalysedData_table=$("#tableAnalysedData");$ReadSheetData=$("#ReadSheetData");$DefineColumnsData=$("#DefineColumnsData");$buttonProceed4=$("#buttonProceed4");$buttoncheckscan=$("#buttoncheckscan");$lblcheckfilefeedback=$("#lblcheckfilefeedback");$select_sheetnameFile=$("#select_sheetnameFile");$tablePreview=$("#tablePreview");$input_transaction_upload=$("#input_transaction_upload");$dlsheetname=$("#dlsheetname");$select_upload_accountid=0;$tabledataCofirm=$("#tabledataCofirm");$accountIdSelected=$("#accountIdSelected");$accountLastBalanceSelected=0;$lblfromtodate=$("#lblfromtodate");$label_upload_name=$("#label_upload_name");$selectedAccountId=0;$selectedGroupAccountId=0;$dateFromatSelected="";_headersSelected=[];$uploadIdDelete=0;$uploadNameDelete="";$uploadFormatId=0;$accountName="";var $accountIdDelete=0,$accountNameDelete="",$accountNumberDelete="",$accountCreateDate=null,$accountCreateBy="",$accountDataManage="",$liDelete=null,CheckExistsAccount=!1,colCount=0,colHeadIndex=1;$(document).ready(function(){$modal_transaction_edit.on("hidden.bs.modal",function(){});$("#opening_balance").number(!0,2);$("input[type=file]").bind("change",function(){$lblcheckfilefeedback.text("");var n=$(this).val();n.length>0?$buttoncheckscan.removeAttr("disabled",""):($ReadSheetData.attr("disabled",""),$buttoncheckscan.attr("disabled",""),RemoveSheetSelect(),$dlsheetname.hide())});LoadAccounts("init");$selectFilter.change(function(){$("#account-page-display").empty();$("#account-page-display").html("<div id='account-content'><\/div>");LoadAccounts("")});$selectOrder.change(function(){$("#account-page-display").empty();$("#account-page-display").html("<div id='account-content'><\/div>");LoadAccounts("")});$button_add_group.bind("click",function(n){if(this.classList.contains("isDisabled")){n.preventDefault();return}ClearError();$input_group_id.val(0);$input_group_name.val("");$input_group_createddate.val("");$input_group_createdbyid.val("");$modal_group_title.text("Add a Group");$("#save-group").text("Add now");$modal_group.modal("toggle")});$(".fileinput").on("change.bs.fileinput",function(){$dlsheetname.hide();$ReadSheetData.attr("disabled","");$DefineColumnsData.attr("disabled","");$lblcheckfilefeedback.text("")})});$("#form_group").submit(function(n){n.preventDefault();$.ajax({type:this.method,cache:!1,url:this.action,enctype:"multipart/form-data",data:new FormData(this),processData:!1,contentType:!1,success:function(n){n.result?($modal_group.modal("toggle"),n.actionVal===1?($("#list_view").prepend(n.Object.toString()),$("#grid_view").prepend(n.msg),$selectFilter.append("<option value='"+n.msgId+"'>"+n.msgName+"<\/option>"),$select_account_group.prepend("<option value='"+n.msgId+"'>"+n.msgName+"<\/option>"),cleanBookNotification.success(_L("ERROR_MSG_467",[$input_group_name.val()]),"Qbicles")):n.actionVal===2&&($("#account-group-name-grid-"+$input_group_id.val()).text(n.msg),$("#account-group-name-list-"+$input_group_id.val()).text(n.msg),$('#select_account_group [value="'+n.msgId+'"]').text(n.msgName),$('#filter-group [value="'+n.msgId+'"]').text(n.msgName),cleanBookNotification.success(_L("ERROR_MSG_468",[$input_group_name.val()]),"Qbicles"))):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})});