function searchThrottle(n,t){var i=null;return function(){var r=this,u=arguments;clearTimeout(i);i=window.setTimeout(function(){n.apply(r,u)},t||500)}}function ApplySearch(){var n="/PointOfSaleDevice/SearchDevice?name="+$("#search-device").val()+"&order="+$("#order-device").val();$("#pos-devices-list").LoadingOverlay("show");$("#pos-devices-list").empty();$("#pos-devices-list").load(n,function(){$("#pos-devices-list").LoadingOverlay("hide")})}function checkExistsTabelPrefix(n,t){var i=new $.Deferred;return $.ajax({type:"get",url:"/PointOfSaleDevice/CheckExistsTabletPrefix?tabletPrefix="+n+"&deviceId="+t,"async":!1,contentType:!1,processData:!1,success:function(n){i.resolve(n)},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles");i.resolve(!0)}}),i.promise()}function SearchUserModal(){var u,r,f,t,i,n,e;if(u=document.getElementById("search-name"),r=u.value.toUpperCase(),!(r.length>0)||!(r.length<3))for(f=document.getElementById("pos-user-UL"),t=f.getElementsByTagName("article"),n=0;n<t.length;n++){if(i=t[n].getElementsByTagName("h5"),i.length===0){t[n].style.display="none";continue}e=i[0].textContent||i[0].innerText;e.toUpperCase().indexOf(r)>-1?(t[n].style.display="",document.getElementsByClassName("group-"+i[0].className)[0].setAttribute("style","display: block")):t[n].style.display="none"}}function searchKeyWork(){clearTimeout(delayTimer)}function StorePreviousRole(n,t,i){var r=i;previousRole[r]=n.value;selectedRole=n.value;selectedRole=="none"?$("#user-roles-"+i).prop("disabled",!0):$("#user-roles-"+i).prop("disabled",!1)}function UpdateUsersRole(n,t,i,r,u,f,e,o){selectedRole=$(n).val();var s={Id:$("#user-roles-"+i).attr("objectId"),DeviceId:t,PosUserId:i,UserId:r,CurrentRole:selectedRole,PreviousRole:previousRole[i],Group:u,Name:f,Pin:o,Avatar:e};selectedRole=="none"?bootbox.confirm({show:!0,backdrop:!0,closeButton:!0,animate:!0,className:"my-modal",title:"Qbicles",message:_L("ERROR_MSG_339"),callback:function(t){if(t)$("body").css("overflow-y","auto"),UpdateUserRole(s.DeviceId,s.PosUserId,s.UserId,s.CurrentRole,s.PreviousRole,s.Group,s.Name,s.Avatar,s.Pin),$("#user-roles-"+i).prop("disabled",!0);else{var r=i;n.value=previousRole[r];return}}}):(UpdateUserRole(s.DeviceId,s.PosUserId,s.UserId,s.CurrentRole,s.PreviousRole,s.Group,s.Name,s.Avatar,s.Pin),$("#user-roles-"+i).prop("disabled",!1))}function getAllowedValues(n){var t=[];return $("#"+n+" option").each(function(){($(this).text()==="None"||$(this).text()==="User"||$(this).text()==="Cashier"||$(this).text()==="Supervisor"||$(this).text()==="Manager"||$(this).text()==="Admin")&&t.push($(this).val())}),t}function ConfirmAddPaymentMethod(){var n,t;if(ValidationDisplayName("table_displayname_temp")){if($("#select2-table_paymentmethod_temp-container").text().toLowerCase()==$paymentTypeCash.toLowerCase()&&(n=$("#account-of-safe").val(),n==="-1")){cleanBookNotification.error("No safe found. Create a safe for this location first.","Qbicles");LoadMethodAccountTable();return}t={Id:$("#posDevice_id").val(),MethodAccount:[{Id:0,TabletDisplayName:$("#table_displayname_temp").val(),PaymentMethod:{Id:$("#table_paymentmethod_temp").val()},CollectionAccount:{Id:$("#table_account_temp").val()}}],IsAdd:!0};SavePaymentAccount(t)}}function PaymentAccountRowChanged(n){var t,i;if(ValidationDisplayName("table_paymentmethod_"+n)){if($("#table_paymentmethod_"+n+" option:selected").text().toLowerCase()==$paymentTypeCash.toLowerCase()&&(t=$("#account-of-safe").val(),t==="-1")){cleanBookNotification.error("No safe found. Create a safe for this location first.","Qbicles");LoadMethodAccountTable();return}CheckPaymentTypeSelected(n);i={Id:$("#posDevice_id").val(),MethodAccount:[{Id:n,TabletDisplayName:$("#table_displayname_"+n).val(),PaymentMethod:{Id:$("#table_paymentmethod_"+n).val()},CollectionAccount:{Id:$("#table_account_"+n).val()}}],IsAdd:!1};SavePaymentAccount(i)}}function DeletePaymentAccount(n){$.LoadingOverlay("show");var t={Id:$("#posDevice_id").val(),MethodAccount:[{Id:n}]};$.ajax({url:"/PointOfSale/DeletePaymentMethod",type:"delete",dataType:"json",data:{posDevice:t},success:function(n){n.actionVal===2?(LoadMethodAccountTable(),cleanBookNotification.removeSuccess()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles");console.log(n)}}).always(function(){LoadingOverlayEnd()})}function SavePaymentAccount(n){if(n.MethodAccount[0].PaymentMethod.Id===null||n.MethodAccount[0].PaymentMethod.Id==="0")return cleanBookNotification.error(_L("ERROR_MSG_356"),"Qbicles"),!1;if(n.MethodAccount[0].CollectionAccount.Id===null||n.MethodAccount[0].CollectionAccount.Id==="0")return cleanBookNotification.error(_L("ERROR_MSG_357"),"Qbicles"),!1;$.LoadingOverlay("show");$.ajax({url:"/PointOfSale/CreatePaymentMethod",type:"post",dataType:"json",data:{posDevice:n},success:function(t){if(t.actionVal>2){cleanBookNotification.error(t.msg,"Qbicles");n.IsAdd||LoadMethodAccountTable();return}t.actionVal===1?(cleanBookNotification.createSuccess(),$(".add-row").hide(),$("#addpayment").show(),$("#table_methodAccount tr.row_template").remove()):t.actionVal===2&&cleanBookNotification.updateSuccess();LoadMethodAccountTable()},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function LoadMethodAccountTable(){var n=$("#posDevice_id").val();$.LoadingOverlay("show");$("#table_methodAccount").empty();$("#table_methodAccount").load("/PointOfSale/GetPaymentAccountTable?idDevice="+n,function(){LoadingOverlayEnd()})}function addEditPosDevice(n){LoadingOverlay();$("#app-trader-pos-device-add").empty();$("#app-trader-pos-device-add").load("/PointOfSale/AddEditPosDevice?id="+n,function(){LoadingOverlayEnd()})}function ConfirmDeleteDevice(n,t){$("#name-delete").text(t.replace("|","'"));$deviceIdDelete=n}function DeleteDevice(){$.LoadingOverlay("show");$.ajax({type:"delete",url:"/PointOfSaleDevice/DeleteDevice",data:{id:$deviceIdDelete},dataType:"json",success:function(n){n.result?($("#pos-device-"+$deviceIdDelete).remove(),$("#confirm-delete").modal("hide"),cleanBookNotification.removeSuccess()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(_L("ERROR_MSG_349",[n.error]),"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function CheckPaymentTypeSelected(n){var t=$("#collectionAccountId").val(),u=$("#collectionAccountText").val(),i,r;if(n===-1)if(i=$("#select2-table_paymentmethod_temp-container").text().toLowerCase(),i==$paymentTypeCash.toLowerCase()){if($("#table_displayname_temp").val($paymentTypeCash).addClass("disabled"),r=$("#account-of-safe").val(),r==="-1"){cleanBookNotification.error("No safe found. Create a safe for this location first.","Qbicles");return}$("#table_account_temp").append($("<option selected><\/option>").attr("value",t).text(u));$("#table_account_temp").prop("disabled","disabled");$("#table_account_temp").val(t).trigger("change")}else $("#table_account_temp option[value="+t+"]").remove(),$("#table_displayname_temp").val("").removeClass("disabled"),$("#table_account_temp").prop("disabled",!1),$("#table_account_temp").val(t).trigger("change");else{if(i=$("#table_paymentmethod_"+n+" option:selected").text().toLowerCase(),i==$paymentTypeCash.toLowerCase()){if($("#table_displayname_"+n).val($paymentTypeCash).addClass("disabled"),r=$("#account-of-safe").val(),r==="-1"){cleanBookNotification.error("No safe found. Create a safe for this location first.","Qbicles");return}$("#table_account_"+n).append($("<option selected><\/option>").attr("value",t).text(u));$("#table_account_"+n).select2("destroy").select2();$("#table_account_"+n).prop("disabled","disabled");return}$("#table_account_"+n).removeClass("disabled");$("#table_account_"+n).prop("disabled",!1);$("#table_displayname_"+n).removeClass("disabled").removeAttr("readonly");$("#table_account_"+n+" option[value="+t+"]").remove();$("#table_account_"+n).select2("destroy").select2();return}}function CancelAddPaymentMethod(){$(".add-row").hide();$("#addpayment").show();$(".table_content tr.row_template").remove();$(".dataTables_empty").removeClass("hidden");$("#table_templage tbody tr.row_template span").remove()}function RemovePaymentMethodRowItem(){$("#table_templage tbody tr.row_template span").remove();$(".table_content tr.row_template").remove();$(".dataTables_empty").removeClass("hidden");$(".add-row").hide();$("#addpayment").show()}function AddPaymentMethodRow(n){$("#table_templage tbody tr.row_template span").remove();$(".dataTables_empty").addClass("hidden");$(".payrow2").show();$(".add-row").show();$(n).hide();var t=$("#table_templage tbody tr.row_template").clone();$("#table_methodAccount table tbody").append(t[0]);$("#table_methodAccount tbody tr.row_template td select").select2({placeholder:"Please select"});CheckPaymentTypeSelected(-1)}var $paymentTypeCash="Cash",table,delayTimer,selectedRole,previousRole,$deviceIdDelete,idBuild;$("#search-device").keyup(searchThrottle(function(){ApplySearch()}));$("#order-device").on("change",function(){ApplySearch()});CreateDevice=function(){var n,t,i;$("#add-device-form").valid()&&(($.LoadingOverlay("show"),n={Name:$("#device-name").val(),PosDeviceType:{Id:$("#devicetype").val()},TabletPrefix:$("#device-prefix").val(),SerialNumber:$("#device-serial").val(),Summary:$("#device-summary").val(),PreparationQueue:{Id:$("#device-queue-id").val()},Location:{Domain:{Key:$("#device-domain-key").val()}}},t=!1,checkExistsTabelPrefix(n.TabletPrefix,0).then(function(n){n&&($("#add-device-form").validate().showErrors({prefix:_L("ERROR_MSG_411")}),LoadingOverlayEnd(),t=n)}),t)||(i="/PointOfSaleDevice/CreateDevice",$.ajax({url:i,type:"post",dataType:"json",data:{device:n},success:function(n){n.actionVal===1?(cleanBookNotification.createSuccess(),$("#pos-devices-list").append(n.msg),$("#app-trader-pos-device-add").modal("hide"),$("#device-name").val(""),$("#device-serial").val(""),$("#device-summary").val("")):$("#add-device-form").validate().showErrors({devicename:_L("ERROR_MSG_337")})},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})))};$("#search-user-list").keyup(searchThrottle(function(){$("#user-device-list").DataTable().search($(this).val()).draw()}));$("#search-name").keyup(searchThrottle(function(){SearchUserModal()}));table=$("#user-device-list").DataTable({columnDefs:[{orderable:!1,targets:[0,5,6]},{visible:!1,targets:[6]},{targets:4,orderDataType:"dom-select"}],order:[[1,"asc"]]});$.fn.dataTable.ext.search.push(function(n,t,i){var r=$("#subfilter-group").val(),u=$(table.row(i).node()).find('select[id^="user-roles"]').val(),f=$(table.row(i).node()).find('input[type="checkbox"]').is(":checked");return r===" "||u===r||f?!0:!1});$("#subfilter-group").on("change",function(){table.draw()});$("#search-user-list").on("keyup",function(){table.search(this.value).draw()});$.fn.dataTable.ext.order["dom-select"]=function(n,t){return this.api().column(t,{order:"index"}).nodes().map(function(n){return $("select",n).val()})};DeactivateDevice=function(n){$.LoadingOverlay("show");var t={Id:n,Status:1};$.ajax({url:"/PointOfSaleDevice/ActiveDevice",type:"post",dataType:"json",data:{device:t},success:function(n){n.actionVal>0&&(cleanBookNotification.updateSuccess(),$(".deactivate").toggle(),$(".deactivate-label").toggle(),$(".activate").toggle(),$(".activate-label").toggle(),$("#device-form :input").attr("disabled",!1),$("#pos-menu").attr("disabled",!1),$("#pos-queue").attr("disabled",!1))},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};ActivateDevice=function(n){$.LoadingOverlay("show");var t={Id:n,Status:2};$.ajax({url:"/PointOfSaleDevice/ActiveDevice",type:"post",dataType:"json",data:{device:t},success:function(n){n.actionVal>0&&(cleanBookNotification.updateSuccess(),$(".deactivate").toggle(),$(".deactivate-label").toggle(),$(".activate").toggle(),$(".activate-label").toggle(),$("#device-form :input").attr("disabled",!0),$("#pos-menu").attr("disabled",!0),$("#pos-queue").attr("disabled",!0))},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};UpdateDeviceMenu=function(n){$.LoadingOverlay("show");var t={Id:n,Menu:{Id:$("#pos-menu").val()}};$.ajax({url:"/PointOfSaleDevice/UpdateDeviceMenu",type:"post",dataType:"json",data:{device:t},success:function(n){n.actionVal>0&&cleanBookNotification.updateSuccess()},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};UpdateDeviceQueue=function(n){$.LoadingOverlay("show");var t={Id:n,preparationQueue:{Id:$("#pos-queue").val()}};$.ajax({url:"/PointOfSaleDevice/UpdateDeviceQueue",type:"post",dataType:"json",data:{device:t},success:function(n){n.actionVal>0&&cleanBookNotification.updateSuccess()},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};UpdateDevice=function(n){clearTimeout(delayTimer);delayTimer=setTimeout(function(){var t,i,r;if($("#device-name").val()===""){$("#device-form").validate().showErrors({devicename:"Device name is required."});return}if($.LoadingOverlay("show"),t={Id:n,Name:$("#device-name").val(),TabletPrefix:$("#device-prefix").val(),SerialNumber:$("#device-serial").val(),PosDeviceType:{Id:$("#devicetype").val()},Summary:$("#device-summary").val(),Location:{Domain:{Key:$("#device-domain-key").val()}}},!t.TabletPrefix||t.TabletPrefix&&t.TabletPrefix.length===""){$("#device-form").validate().showErrors({prefix:"The prefix is required."});LoadingOverlayEnd();return}(i=!1,checkExistsTabelPrefix(t.TabletPrefix,n).then(function(n){n&&(cleanBookNotification.error("TabletPrefix is unique for a device at the current location","Qbicles"),LoadingOverlayEnd(),i=n)}),i)||(r="/PointOfSaleDevice/UpdateDevice",$.ajax({url:r,type:"post",dataType:"json",data:{device:t},success:function(n){n.actionVal===1?(cleanBookNotification.updateSuccess(),$("#device-name-label").text(t.Name),$("#device-summary-label").text(t.Summary)):$("#device-form").validate().showErrors({devicename:"Device name already exists."})},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()}))},1e3)};var $isUser=!1,$isManager=!1,$isAdmin=!1;RemoveUser=function(n,t,i,r,u,f){bootbox.confirm({show:!0,backdrop:!0,closeButton:!0,animate:!0,className:"my-modal",title:"Qbicles",message:_L("ERROR_MSG_339"),callback:function(e){if(!e){$("body").css("overflow-y","hidden");return}$("body").css("overflow-y","auto");$.LoadingOverlay("show");var o=$("#user-tr-"+n),s={Id:0,DeviceId:t,PosUserId:n,UserId:i,IsDelete:!0,Group:r,Name:u,Avatar:f};$.ajax({url:"/PosUser/DeletePosUserDevice",type:"post",dataType:"json",data:{model:s},success:function(n){n.result?(cleanBookNotification.removeSuccess(),ReinitUserModal(s,n.msg),$(o).css("background-color","#FF3700"),$(o).fadeOut(1500,function(){var n=$("#user-device-list").DataTable();n.row(o).remove();n.draw()})):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}})};UpdateUser=function(n,t,i,r,u,f){var o=$(".user-"+t).is(":checked"),h=!1,e,s;h=o===!0?!1:!0;e=!1;o=$(".user-admin-"+t).is(":checked");e=o===!0?!1:!0;s={Id:$(".user-"+t).attr("objectId"),DeviceId:n,PosUserId:t,UserId:i,IsDelete:h,Group:r,Name:u,Avatar:f};e?bootbox.confirm({show:!0,backdrop:!0,closeButton:!0,animate:!0,className:"my-modal",title:"Qbicles",message:_L("ERROR_MSG_339"),callback:function(n){if(!n){$(".user-"+t).prop("checked",!0);$("body").css("overflow-y","hidden");return}$("body").css("overflow-y","auto");UpdateUserConfirm(s,e)}}):UpdateUserConfirm(s,e)};UpdateUserConfirm=function(n,t){$.LoadingOverlay("show");$.ajax({url:"/PosUser/UpdatePosUser?isDeleteAll="+t,type:"post",dataType:"json",data:{model:n},success:function(i){if(i.result)if(cleanBookNotification.updateSuccess(),t){var r=$("#user-tr-"+n.PosUserId);$(r).css("background-color","#FF3700");$(r).fadeOut(1500,function(){var n=$("#user-device-list").DataTable();n.row(r).remove();n.draw()});ReinitUserModal(n,i.msg)}else $(".user-"+n.PosUserId).attr("objectId",i.msgId),$(".user-cashier-"+n.PosUserId).prop("checked",!1),$(".user-cashier-"+n.PosUserId).toggle(),$(".user-supervisor-"+n.PosUserId).prop("checked",!1),$(".user-supervisor-"+n.PosUserId).toggle(),$(".user-manager-"+n.PosUserId).prop("checked",!1),$(".user-manager-"+n.PosUserId).toggle();else cleanBookNotification.error(i.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};UpdateUserAdmin=function(n,t,i,r,u,f){var s=$(".user-admin-"+t).is(":checked"),e=!1,o;e=s===!0?!1:!0;o={Id:$(".user-admin-"+t).attr("objectId"),DeviceId:n,PosUserId:t,UserId:i,IsDelete:e,Group:r,Name:u,Avatar:f};UpdateUserManagerAdmin(o,"/PosUser/UpdatePosUserAdminDevice",".user-admin-",t)};UpdateUserManagerAdmin=function(n,t,i,r){$.LoadingOverlay("show");var u=t;$.ajax({url:u,type:"post",dataType:"json",data:{model:n},success:function(t){if(t.result){if(cleanBookNotification.updateSuccess(),$(i+r).attr("objectId",t.msgId),i===".user-admin-"&&selectedRole=="none"){var u=$("#user-tr-"+r);$(u).css("background-color","#FF3700");$(u).fadeOut(1500,function(){var n=$("#user-device-list").DataTable();n.row(u).remove();n.draw()});ReinitUserModal(n,t.msg)}}else cleanBookNotification.error(t.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};previousRole={};UpdateUserRole=function(n,t,i,r,u,f,e,o,s){$.LoadingOverlay("show");var h={Id:$(".user-"+t).attr("objectId"),DeviceId:n,PosUserId:t,UserId:i,CurrentRole:r,PreviousRole:u,Group:f,Name:e,Avatar:o,Pin:s};$.ajax({url:"/PosUser/UpdatePosUser?isDeleteAll=false",type:"post",dataType:"json",data:{model:h},success:function(n){var f,i;n.result?(cleanBookNotification.updateSuccess(),f=$(".user-admin-"+t).is(":checked"),f||r!="none"||(i=$("#user-tr-"+t),$(i).css("background-color","#FF3700"),$(i).fadeOut(1500,function(){var n=$("#user-device-list").DataTable();n.row(i).remove();n.draw()}),ReinitUserModal(h,n.msg)),r=="none"&&$("#user-roles-"+t).prop("disabled",!0)):(u[t]!="none"&&$("#user-roles-"+t).prop("disabled",!1),cleanBookNotification.error(n.msg,"Qbicles"))},error:function(n){u[t]!="none"&&$("#user-roles-"+t).prop("disabled",!1);cleanBookNotification.error(n,"Qbicles")}}).always(function(){u[t]!="none"&&$("#user-roles-"+t).prop("disabled",!1);LoadingOverlayEnd()})};$(".add-user-pool").on("select2:select",function(n){var r=n.params.data,i=r.element.className.split("#")[0],u=["2","3","4","5"],t;r.id==="1"?($("#select-"+i).val(null).trigger("change"),$("#select-"+i).val(1).trigger("change")):(t=$("#select-"+i).val(),t=t.filter(function(n){return n!=="1"}),r.id==="6"&&t.includes("6")||(u=u.filter(function(n){return n!==r.id}),t=t.filter(function(n){return!u.includes(n)})),$("#select-"+i).val(null).trigger("change"),$("#select-"+i).val(t).trigger("change"))});$(".add-user-pool").on("select2:unselect",function(n){var i=n.params.data,t=i.element.className.split("#")[0],r=$("#select-"+t).val();r===null&&($("#select-"+t).val(null).trigger("change"),$("#select-"+t).val(1).trigger("change"))});ConfirmAddUsers=function(n){var f=[],i=$("#pos-user-UL article"),o=["1"],t,u,r,e;if(i.length>0)for(t=0;t<i.length;t++)u=$(i[t]).find("div.contact-info input").val(),r=$($(i[t]).find("div.contact-info select")).val(),typeof u=="undefined"||typeof r=="undefined"||_.isEqual(r,o)||(e={UserId:u,Pools:r},f.push(e));$.LoadingOverlay("show");$.ajax({url:"/PosUser/CreatePosUserDevice?deviceId="+n,type:"post",dataType:"json",data:{pooledUsers:f},success:function(n){n.actionVal>0?($("#app-trader-pos-user-add").modal("hide"),cleanBookNotification.updateSuccess(),setTimeout(function(){window.location.reload()},100)):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};ReinitUserModal=function(n,t){var r=document.getElementById("group-"+n.Group),u,i;r===null?(u="<article id='group-'"+n.Group+" class='letters group-'"+n.Group+"  style='padding-top: 0;'>"+n.Group+" <\/article>",i=document.getElementById("pos-user-UL"),i.insertAdjacentHTML("beforeend",u),i.insertAdjacentHTML("beforeend",t)):r.insertAdjacentHTML("beforeend",t);$("#select-"+n.UserId).select2();$("#select-"+n.UserId).on("select2:select",function(n){var r=n.params.data,t=r.element.className.split("#")[0],i;r.id==="None"?($("#select-"+t).val(null).trigger("change"),$("#select-"+t).val("None").trigger("change")):(i=$("#select-"+t).val(),i=i.filter(function(n){return n!=="None"}),$("#select-"+t).val(null).trigger("change"),$("#select-"+t).val(i).trigger("change"))});$("#select-"+n.UserId).on("select2:unselect",function(n){var i=n.params.data,t=i.element.className.split("#")[0],r=$("#select-"+t).val();r===null&&($("#select-"+t).val(null).trigger("change"),$("#select-"+t).val(1).trigger("change"))})};ValidationDisplayName=function(n){return $("#"+n).val()!==""?!0:(cleanBookNotification.error(_L("ERROR_VALUE_REQUIRED",["Display name"]),"Qbicles"),!1)};$deviceIdDelete=0;idBuild=UniqueId();