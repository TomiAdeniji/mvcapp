function initCustomerDiscussionPage(){$(".checkmulti").multiselect({includeSelectAllOption:!0,enableFiltering:!0,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});initOrderItemsShow();$("input[name=search]").keyup(delay(function(){initOrderItemsShow()},500));$("select[name=groups]").change(function(){initOrderItemsShow()})}function initOrderItemsShow(){var n=$("#items-container"),t=$("#pagiation-items");t.pagination({dataSource:"/Commerce/SearchCatalogItemsNotTaxes",locator:"items",totalNumberLocator:function(t){return n.LoadingOverlay("hide"),t.totalNumber},pageSize:6,ajax:{data:{scatids:JSON.stringify($("select[name=groups]").val()),keyword:$("input[name=search]").val(),bdomainKey:$("#domain-key").val()},beforeSend:function(){n.LoadingOverlay("show")}},callback:function(t){var u=t.length,f=(u%3==0?0:3)-u%3,i="",r;for($.each(t,function(n,t){i+=itemTemplate(t)}),r=0;r<f;r++)i+='<div class="col">&nbsp;<\/div>';n.html(i)}})}function itemTemplate(n){var i=$("#domain-key").val(),t='<div class="col"><a onclick="showItemContentB2B('+n.Id+",'"+i+'\')" href="#">';return t+='<div class="productimg" style="background-image:url(\''+n.ImageUri+"');\"><\/div>",t+='<div class="priceblock">',t+="<p>"+n.Name+"<\/p>",t+='<label class="label label-lg label-soft">'+n.CategoryName+"<\/label> &nbsp; <span>"+n.Price+"<\/span><\/div>",t+"<\/a><\/div>"}function showItemContentB2B(n,t){var i="/Commerce/B2BOrderItemContentShow?itemId="+n+"&domainKey="+t;$("#product-more-catalogue").empty();$("#product-more-catalogue").load(i,function(){$(".select2").select2({placeholder:"Please select"})});$("#product-more-catalogue").modal("show")}function importingItemfromDistributorCatalog(n){var i=$("#product_groups_select").val()+"",t;if(i.trim()===""){cleanBookNotification.error(_L("ERROR_MSG_489"),"Qbicles");return}$(n).validate().valid()&&($.LoadingOverlay("show"),t={itemId:$(n+" input[name=id]").val(),groupId:$(n+" select[name=group]").val(),sku:$(n+" input[name=sku]").val(),description:$(n+" textarea[name=desc]").val(),isprimaryVendor:$(n+" input[name=isprimaryVendor]").prop("checked"),b2bRelationshipId:$("#hdfrelationshipId").val()},$.post("/Commerce/ImportingItemfromDistributorCatalog",{model:t},function(n){n.result?(cleanBookNotification.success(_L("SUCCESS_MSG_IMPORT_DISTRIBUTORCATALOG"),"B2B"),$("#product-more-catalogue").modal("hide")):!n.result&&n.msg?cleanBookNotification.error(_L(n.msg),"B2B"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"B2B");$.LoadingOverlay("hide")}))}function addgroup(){var n=$("#form_group_add").val()+"";if(n.trim()===""){cleanBookNotification.error(_L("ERROR_MSG_489"),"Qbicles");return}$.ajax({type:"post",url:"/TraderConfiguration/SaveGroup",data:{Name:$("#form_group_add").val()},dataType:"json",success:function(t){t.result===!0?t.actionVal===1?(cleanBookNotification.createSuccess(),reloadProductGroup(n),$("#add-category").modal("toggle")):t.actionVal===2?(cleanBookNotification.updateSuccess(),reloadProductGroup(n),$("#add-category").modal("toggle")):t.actionVal===3&&cleanBookNotification.error(t.msg,"Qbicles"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}).always(function(){})}function reloadProductGroup(n){var t=null;$.get("/Commerce/GetProductGroups",function(i){t=i.find(t=>t.text===n);t?$("#product_groups_select").select2({data:i}).val(t.id).trigger("change"):$("#product_groups_select").select2({data:i})})}$(document).ready(function(){initCustomerDiscussionPage()});