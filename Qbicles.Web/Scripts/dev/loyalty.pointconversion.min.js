function loadProfileTradingPage(){isLoyaltySettingFormSubmit=!0;initSaveConversionForm();loadArchievedConversionDataTable();initDomainLoyaltySettingForm();$("#allow-debitpayment-btn").prop("checked")?($("#toggle-status").text("now enabled"),$(".not-allow").show()):($("#toggle-status").text("disabled"),$(".not-allow").hide());$("#toggle-container").on("change",function(n){var i=$("#loyalty-setting-form"),r=$("#allow-debitpayment-btn").prop("checked"),t=$("#debitwg").val();t<=0||t==""?r==!0?(isLoyaltySettingFormSubmit=!1,i.validate().showErrors({debitwg:"Please select a WorkGroup with the CreditNote process."}),$("#allow-debitpayment-btn").bootstrapToggle("off"),n.preventDefault()):isLoyaltySettingFormSubmit?$("#loyalty-setting-form").submit():isLoyaltySettingFormSubmit=!0:$("#loyalty-setting-form").submit()})}function initSaveConversionForm(){var n=$("#addconversion-form");n.validate({rules:{amount:{required:!0},point:{required:!0,digits:"This field only accepts integer"}}});jQuery.extend(jQuery.validator.messages,{digits:"This field only accepts integer."});n.submit(function(t){t.preventDefault();var i=$("#conversion-amount").val(),r=$("#conversion-point").val();n.valid()&&(i<0?n.validate().showErrors({amount:"Conversion Amount must be greater than or equal to 0."}):r<1?n.validate().showErrors({point:"Conversion Amount must be greater than or equal to 1."}):savePointConversion())})}function savePointConversion(){var n={Amount:$("#conversion-amount").val(),Points:$("#conversion-point").val(),ConversionType:1};LoadingOverlay();$.ajax({method:"POST",dataType:"JSON",data:{conversion:n},url:"/LoyaltyPointConversion/AddConversion",success:function(n){n.result?(cleanBookNotification.updateSuccess("Qbicles"),$("#confirm").attr("disabled","disabled"),$("#archieved-conversions").DataTable().ajax.reload()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}});LoadingOverlayEnd()}function loadArchievedConversionDataTable(){$("#archieved-conversions").on("processing.dt",function(n,t,i){$("#processingIndicator").css("display","none");i&&$(".loadingoverlay").length===0?$("#archieved-conversions").LoadingOverlay("show"):$("#archieved-conversions").LoadingOverlay("hide",!0)}).DataTable({destroy:!0,bDestroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',language:{lengthMenu:"_MENU_ &nbsp; per page"},serverSide:!0,info:!0,stateSave:!1,bLengthChange:!0,paging:!0,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,createdRow:function(n,t){t.isCheckpoint&&$(n).removeClass().addClass("checkpoint even")},ajax:{url:"/LoyaltyPointConversion/LoyaltyPaymentConversionDTContent",type:"GET",dataType:"json",data:{conversiontye:1}},columns:[{name:"Amount",data:"Amount",orderable:!1},{name:"Points",data:"Points",orderable:!1},{name:"ArchievedDate",data:"ArchievedDate",orderable:!1},{name:"ArchievedBy",data:"ArchievedBy",orderable:!1}]})}function initDomainLoyaltySettingForm(){var n=$("#loyalty-setting-form");n.submit(function(n){LoadingOverlay();n.preventDefault();var t=$("#allow-debitpayment-btn").prop("checked"),i=$("#debitwg").val();$.ajax({method:"POST",dataType:"JSON",url:"/LoyaltyPointConversion/UpdateDomainLoyaltySetting",data:{workGroupId:i,isDebitPaymentAllowed:t},success:function(n){n.result?(t?($("#toggle-status").text("now enabled"),$(".not-allow").show()):($("#toggle-status").text("disabled"),$(".not-allow").hide()),cleanBookNotification.updateSuccess()):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n.msg,"Qbicles")}});LoadingOverlayEnd()})}var isLoyaltySettingFormSubmit;