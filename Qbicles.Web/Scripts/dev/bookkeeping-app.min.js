function BKChartOfAccountContent(n){var t="/Bookkeeping/BKChartOfAccountContent?value="+n;$.LoadingOverlay("show");$("#content").load(t,function(){LoadingOverlayEnd()})}function GetNumber(){$.ajax({type:"post",url:"/Bookkeeping/GetNumber",data:{id:selectedNote.value},dataType:"json",success:function(n){n.result===!0?($("#add_ref_group").text(n.msgId+"."),$("#add_ref_account").text(n.msgId+"."),$("#add_suggestion_number").val(n.actionVal),$("#add_suggestion_number_account").val(n.actionVal),lstNumberExists=n.Object):($("#app-coa-subgroup-add").modal("toggle"),cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles"))},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function BKResetForm(n){ClearError();$("#"+n)[0].reset();$("#"+n).validate().resetForm()}function selectNode(n,t){var i,r;for($(".jstree").jstree("deselect_all"),i=0;i<n.length;i++)i===n.length-1?($("div#jstree_id").jstree("select_node",".groupaccount_"+n[i]),t===null&&(r="/Bookkeeping/BKChartOfAccountContent?value="+n[i],$.LoadingOverlay("show"),$("#content").load(r,function(){LoadingOverlayEnd()}))):$("div#jstree_id").jstree("open_node",".groupaccount_"+n[i])}function addNewSubGroup(){var n=$("#add_suggestion_number").val()+"",t;n.length===0&&(n="0");lstNumberExists.indexOf(n)===-1?$(formAddGroup).valid()&&(t=$("#add_ref_group").text()+n,$.ajax({type:"post",url:"/Bookkeeping/SaveSubGroup",data:{Name:$(add_group_name).val(),Parent:{Id:selectedNote.value},Number:t},dataType:"json",success:function(n){if(n.result===!0)if(n.actionVal===1){cleanBookNotification.createSuccess();$.LoadingOverlay("show");$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){LoadingOverlayEnd();selectNode(n.Object);$("#app-coa-subgroup-add").modal("hide");$(".modal-backdrop").remove()})}else n.actionVal===3&&cleanBookNotification.error(n.msg,"Qbicles");else cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})):cleanBookNotification.error(_L("ERROR_MSG_6"),"Qbicles")}function showModalRename(){$.ajax({type:"post",url:"/Bookkeeping/GetGroupById",data:{id:selectedNote.value},dataType:"json",success:function(n){if(n.result===!0){lstNumberExists=n.Object2?n.Object2:[];var t=n.Object;t.Number===null&&(t.Number="");$("#edit_suggestion_number").val(t.Number.split(".")[t.Number.split(".").length-1]);$("#edit_ref_group").text(t.Number.substr(0,t.Number.lastIndexOf(".")+1));$("#edit_group_name").val(t.Name);n.actionVal===1?$("#edit_suggestion_number").prop("readonly",!0):$("#edit_suggestion_number").prop("readonly",!1)}else $("#app-coa-subgroup-edit").modal("toggle"),cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function renameSubGroup(){var n=$("#edit_suggestion_number").val()+"",t;n.length===0&&(n="0");lstNumberExists.indexOf(n)===-1?$(formEditGroup).valid()&&(t=$("#edit_ref_group").text()+n,$.ajax({type:"post",url:"/Bookkeeping/SaveSubGroup",data:{Name:$(edit_group_name).val(),Id:selectedNote.value,Number:t},dataType:"json",success:function(n){if(n.result===!0)if(n.actionVal===2){cleanBookNotification.updateSuccess();$.LoadingOverlay("show");$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){LoadingOverlayEnd();selectNode(n.Object);$("#app-coa-subgroup-edit").modal("toggle");$(".modal-backdrop").remove()})}else n.actionVal===3&&cleanBookNotification.error(n.msg,"Qbicles");else cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})):cleanBookNotification.error(_L("ERROR_MSG_6"),"Qbicles")}function LoadBKAccountAttachmentList(){$("ul.domain-change-list").empty();var n=$bkAccountAttachmentExisted.AssociatedFiles.length+$bkAccountAttachments.length;$("#bk-account-attachment-manage").text(" Attachments ("+n+")");n>0&&$("#bk-account-attachment-icon").removeClass("fa fa-plus").addClass("fa fa-paperclip");_.forEach($bkAccountAttachmentExisted.AssociatedFiles,function(n){var t=' <li> <a href="">';t+='<img src="'+n.IconPath+'" style="max-width: 80px; height: auto; padding-right: 10px;">';t+=n.Name+" <\/a> <\/li>";$("ul.domain-change-list").append(t)});_.forEach($bkAccountAttachments,function(n){var t=' <li> <a href="">';t+='<img src="'+n.IconPath+'" style="max-width: 80px; height: auto; padding-right: 10px;">';t+=n.Name+" <\/a> <\/li>";$("ul.domain-change-list").append(t)})}function checknumber(n,t){var i=t.which;(i!==8||i===32)&&(i<48||i>57)&&t.preventDefault()}function CreateBKAccount(){var n,t;if($.LoadingOverlay("show"),n=$("#add_suggestion_number_account").val()+"",n.length===0&&(n="0"),lstNumberExists.indexOf(n)===-1){if($("#bk-worgroup-select").val()===""){$.LoadingOverlay("show");cleanBookNotification.error(_L("ERROR_MSG_452"),"Qbicles");return}t=$("#add_ref_account").text()+n;$("#form_account_add_edit").valid()?$bkAccountAttachments.length>0?UploadBatchMediasS3ClientSide($bkAccountAttachments).then(function(){ConfirmCreateBkAccount(t)}):ConfirmCreateBkAccount(t):($.LoadingOverlay("show"),cleanBookNotification.error(_L("ERROR_MSG_6"),"Qbicles"))}}function UpdateBKAccount(){var n=$("#edit_suggestion_number_account").val()+"",t;if(n.length===0&&(n="0"),lstNumberExists.indexOf(n)===-1){if($("#bk-worgroup-select").val()===""){cleanBookNotification.error(_L("ERROR_MSG_452"),"Qbicles");return}$("#form_account_add_edit").valid()&&(t=$("#edit_ref_account").text()+n,UploadBatchMediasS3ClientSide($bkAccountAttachments).then(function(){ConfirmUpdateBKAccount(t)}))}else cleanBookNotification.error(_L("ERROR_MSG_6"),"Qbicles")}function AddBkAccount(){$.LoadingOverlay("show");$bkAccountAttachmentExisted={AssociatedFiles:[]};$bkAccountAttachments=[];$("#app-coa-account-add").empty();$("#app-coa-account-add").load("/Bookkeeping/BKAccountAddPartial?id=0",function(){GetNumber();LoadingOverlayEnd();$("#app-coa-account-add").modal("show")})}function DeleteSubNode(n){subgroupId=n;$(".subgroup-1-name").text($("#group-name").text());$("#confirm-delete-bksubgroup").modal("show")}function EditBkAccount(n){$.LoadingOverlay("show");var t="/Bookkeeping/BKAccountEditPartial?id="+n;$bkAccountAttachmentExisted={AssociatedFiles:[]};$bkAccountAttachments=[];$("#app-coa-account-edit").empty();$("#app-coa-account-edit").load(t,function(){LoadingOverlayEnd();$("#app-coa-account-edit").modal("show")})}function calcBalance(){var n=parseFloat($(add_account_debit).val()),i=parseFloat($(add_account_credit).val()),t=parseFloat($(add_account_balance).val()),r=$(add_account_credit).prop("readonly")||$(add_account_balance).prop("readonly")||$(add_account_debit).prop("readonly");n&&i&&n!=0&&i!=0&&($(add_account_balance).prop("readonly")||!r)?($(add_account_balance).val(i-n),$(add_account_debit).prop("readonly",!1),$(add_account_credit).prop("readonly",!1),$(add_account_balance).prop("readonly",!0)):t&&n&&t!=0&&n!=null&&($(add_account_credit).prop("readonly")||!r)?($(add_account_credit).val(t+n),$(add_account_debit).prop("readonly",!1),$(add_account_balance).prop("readonly",!1),$(add_account_credit).prop("readonly",!0)):t&&i&&t!=0&&i!=0&&($(add_account_debit).prop("readonly")||!r)?($(add_account_debit).val(n-t),$(add_account_credit).prop("readonly",!1),$(add_account_balance).prop("readonly",!1),$(add_account_debit).prop("readonly",!0)):($(add_account_debit).prop("readonly")?$(add_account_debit).val(0):$(add_account_credit).prop("readonly")?$(add_account_credit).val(0):$(add_account_balance).prop("readonly")&&$(add_account_balance).val(0),$(add_account_debit).prop("readonly",!1),$(add_account_credit).prop("readonly",!1),$(add_account_balance).prop("readonly",!1))}function calcBalanceEdit(){var n=parseFloat($(edit_account_debit).val()),i=parseFloat($(edit_account_credit).val()),t=parseFloat($(edit_account_balance).val()),r=$(edit_account_credit).prop("readonly")||$(edit_account_balance).prop("readonly")||$(edit_account_debit).prop("readonly");n&&i&&n!=0&&i!=0&&($(edit_account_balance).prop("readonly")||!r)?($(edit_account_balance).val(i-n),$(edit_account_debit).prop("readonly",!1),$(edit_account_credit).prop("readonly",!1),$(edit_account_balance).prop("readonly",!0)):t&&n&&t!=0&&n!=null&&($(edit_account_credit).prop("readonly")||!r)?($(edit_account_credit).val(t+n),$(edit_account_debit).prop("readonly",!1),$(edit_account_balance).prop("readonly",!1),$(edit_account_credit).prop("readonly",!0)):t&&i&&t!=0&&i!=0&&($(edit_account_debit).prop("readonly")||!r)?($(add_account_debit).val(n-t),$(add_account_credit).prop("readonly",!1),$(add_account_balance).prop("readonly",!1),$(add_account_debit).prop("readonly",!0)):($(edit_account_debit).prop("readonly")?$(edit_account_debit).val(0):$(edit_account_credit).prop("readonly")?$(edit_account_credit).val(0):$(edit_account_balance).prop("readonly")&&$(edit_account_balance).val(0),$(edit_account_debit).prop("readonly",!1),$(edit_account_credit).prop("readonly",!1),$(edit_account_balance).prop("readonly",!1))}function changeData(){var n=$(add_account_credit).val()-$(add_account_debit).val();$(add_account_balance).val(n);n===0?$(add_account_balance).prop("readonly",!1):$(add_account_balance).prop("readonly",!0)}function changeDataEdit(){var n=$(edit_account_credit).val()-$(edit_account_debit).val();$(edit_account_balance).val(n);n===0?$(edit_account_balance).prop("readonly",!1):$(edit_account_balance).prop("readonly",!0)}function changeBalance(){var n=$(add_account_balance).val();n===""||n==="0"?($(add_account_debit).prop("readonly",!1),$(add_account_credit).prop("readonly",!1)):($(add_account_debit).val(0),$(add_account_credit).val(0),$(add_account_debit).prop("readonly",!0),$(add_account_credit).prop("readonly",!0))}function changeBalanceEdit(){var n=$(edit_account_balance).val();n===""||n==="0"?($(edit_account_debit).prop("readonly",!1),$(edit_account_credit).prop("readonly",!1)):($(edit_account_debit).val(0),$(edit_account_credit).val(0),$(edit_account_debit).prop("readonly",!0),$(edit_account_credit).prop("readonly",!0))}function ConfirmBKAccountAttachment(n,t){var r,s,u,f,l,h,o,i,e,a,c;if($bkAccountAttachmentExisted={AssociatedFiles:[]},$bkAccountAttachments=[],r="",n)for(o=$(".edit_attachment_row input.inputfile"),i=0;i<o.length;i++)o[i].files.length>0?(e=o[i].files[0],r=e.name.split(".").pop(),a=_.find($qbiclesFileTypes,function(n){return n.Extension===r}),c={Id:GenerateUUID(),Name:e.name,Extension:r,Size:e.size,IconPath:a.IconPath,File:e},$("#inputfilename_edit"+(i+1)).val()!==""&&(c.Name=$("#inputfilename_edit"+(i+1)).val()+"."+r),$bkAccountAttachments.push(c)):$("#file_id_"+(i+1)).length>0&&$bkAccountAttachmentExisted.AssociatedFiles.push({Id:parseInt($("#file_id_"+(i+1)).val()),Name:$("#inputfilename_edit"+(i+1)).val(),IconPath:$("#inputiconpath_edit"+(i+1)).val()});else for(s=$(".add_attachment_row input.inputfile"),u=0;u<s.length;u++)f=s[u].files[0],r=f.name.split(".").pop(),l=_.find($qbiclesFileTypes,function(n){return n.Extension===r}),h={Id:GenerateUUID(),Name:f.name,Extension:f.name.split(".").pop(),Size:f.size,IconPath:l.IconPath,File:f},$("#inputfilename"+(u+1)).val()!==""&&(h.Name=$("#inputfilename"+(u+1)).val()+"."+r),$bkAccountAttachments.push(h);LoadBKAccountAttachmentList();t&&$("#"+t).modal("toggle")}function VerifyAccountNumber(n,t){regExp.test(t.key)||t.keyCode!==46&&t.keyCode!==45&&t.keyCode!==124&&t.keyCode!==92&&t.keyCode!==47&&t.preventDefault()}var $qbiclesFileTypes=[],$bkAccountAttachments=[],$bkAccountAttachmentExisted={AssociatedFiles:[]},selectedNote,lstParent,lstNumberExists,subgroupId,$workgroupId,$accountMasterId,$accountDelId,regExp;$(document).ready(function(){$qbiclesFileTypes=[];$.ajax({type:"post",url:"/FileTypes/GetFileTypes",dataType:"json",success:function(n){$qbiclesFileTypes=n},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}}).always(function(){LoadingOverlayEnd()})});selectedNote=0;lstParent=[];$(".jstree").on("select_node.jstree",function(n,t){var i=t.node.data.value;selectedNote=t.node.data;typeof selectedNote.parent=="number"?lstParent.push(selectedNote.parent):typeof selectedNote.parent=="string"&&(lstParent=selectedNote.parent.split(","));BKChartOfAccountContent(i);$(document).width()<978&&$("html, body").animate({scrollTop:$("#content").offset().top-120},"slow")});lstNumberExists=[];var formAddGroup="#form_group_add",formEditGroup="#form_group_edit",add_group_name="#addnew_group_name",edit_group_name="#edit_group_name";var addAccName="#add_account_name",addAccNumber="#add_account_number",addAccBalance="#add_account_balance",addAccDebits="#add_account_debits",addAccCredits="#add_account_credits",add_account_description="#add_account_description",add_account_balance="#add_account_balance",add_account_debit="#add_account_debits",add_account_credit="#add_account_credits",edit_account_Id="#edit_account_Id",edit_account_name="#edit_account_name",edit_account_number="#edit_account_number",edit_account_description="#edit_account_description",edit_account_balance="#edit_account_balance",edit_account_debit="#edit_account_debit",edit_account_credit="#edit_account_credit";ConfirmCreateBkAccount=function(n){var t=[],i;_.forEach($bkAccountAttachments,function(n){n.File={};t.push(n)});i={Name:$(addAccName).val(),Code:$(addAccNumber).val(),Number:n,Balance:$(addAccBalance).val(),Credit:$(addAccCredits).val(),Debit:$(addAccDebits).val(),Description:$(add_account_description).val(),WorkGroup:{Id:$("#bk-worgroup-select").val()},Parent:{Id:selectedNote.value}};$.ajax({type:"post",url:"/Bookkeeping/SaveBKAccount",data:{bkAccount:i,bkAccountAssociatedFiles:$bkAccountAttachmentExisted,bkAccountAttachments:t},dataType:"json",success:function(n){if(n.result===!0)if(n.actionVal===1){cleanBookNotification.createSuccess();$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){$("#app-coa-account-add").modal("hide");selectNode(n.Object)})}else n.actionVal===3&&cleanBookNotification.error(n.msg,"Qbicles");else cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}).always(function(){LoadingOverlayEnd()})};ConfirmUpdateBKAccount=function(n){var t,i;$.LoadingOverlay("show");t=[];_.forEach($bkAccountAttachments,function(n){n.File={};t.push(n)});i={Id:$(edit_account_Id).val(),Name:$(edit_account_name).val(),Code:$(edit_account_number).val(),Number:n,Balance:$(edit_account_balance).val(),Credit:$(edit_account_credit).val(),Debit:$(edit_account_debit).val(),Description:$(edit_account_description).val(),WorkGroup:{Id:$("#bk-worgroup-select").val()},Parent:{Id:selectedNote.value}};$.ajax({type:"post",url:"/Bookkeeping/SaveBKAccount",data:{bkAccount:i,bkAccountAssociatedFiles:$bkAccountAttachmentExisted,bkAccountAttachments:t},dataType:"json",success:function(n){if($.LoadingOverlay("hide"),n.result===!0){if(n.actionVal===3){cleanBookNotification.error(n.msg,"Qbicles");return}n.actionVal===1?cleanBookNotification.createSuccess():n.actionVal===2&&cleanBookNotification.updateSuccess();$("#app-coa-account-edit").modal("hide");$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){selectNode(n.Object)})}else cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){$.LoadingOverlay("hide");cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}).always(function(){LoadingOverlayEnd()})};subgroupId="";$workgroupId=0;ChangeBKWorkgroup=function(){$workgroupId=$("#bk-worgroup-select").val();$workgroupId!==""?($(".submit-for-review").empty(),$.ajax({type:"get",url:"/Bookkeeping/getworkgroup?id="+$workgroupId,dataType:"json",success:function(n){$(".preview-workgroup").show();n.result?($(".preview-workgroup table tr td.workgroup_process").text(n.Object.Process),$(".preview-workgroup table tr td.workgroup_qbicle").text(n.Object.Qbicle),$(".preview-workgroup table tr td.workgroup_member").text(n.Object.Members)):($(".preview-workgroup table tr td.workgroup_process").text(""),$(".preview-workgroup table tr td.workgroup_qbicle").text(""),$(".preview-workgroup table tr td.workgroup_member").text(""));$(".submit-for-review").empty().append(n.msg)},error:function(n){$(".preview-workgroup").hide();cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}})):$(".preview-workgroup").hide()};ShowAccountDetail=function(){$.LoadingOverlay("show");$(".account-detail-preview").fadeOut();$(".account-detail-content").empty();document.getElementById("confirm-check").checked=!1;$("#merge-button").addClass("hidden");var n=$("#merge-account-select").val();if(n===""){LoadingOverlayEnd();return}$.ajax({type:"get",url:"/Bookkeeping/GetAccountAssociatedDetail",data:{accountId:$("#merge-account-select").val()},dataType:"json",success:function(n){if(n.result)$(".account-detail-content").append(n.msg),$(".account-detail-preview").fadeIn();else{cleanBookNotification.error("Have an error, detail: "+n.msg,"Qbicles");return}},error:function(n){cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};OnchangeConfirmMerge=function(n){n.checked?$("#merge-button").removeClass("hidden"):$("#merge-button").addClass("hidden")};$accountMasterId=0;MergeAccount=function(n){$accountMasterId=n;$(".account-1-name").text($("#account-name-title").text());$.LoadingOverlay("show");var t="/Bookkeeping/GetListMergeAccount?accountMasterId="+n;$("#merge-account-select-manage").empty();$("#merge-account-select-manage").load(t,function(){$(".account-1-name").text($("#account-name-title").text());LoadingOverlayEnd();$("#app-coa-account-merge").modal("toggle")})};MergeAccountNow=function(){$(".account-1-name").text($("#account-name-title").text());$(".account-2-name").text($("#merge-account-select option:selected").html());$("#confirm-merge").modal("toggle")};ConfirmMergeAccount=function(){$.LoadingOverlay("show");$.ajax({type:"get",url:"/Bookkeeping/BKMergeAccount",data:{accountMergeId:$("#merge-account-select").val(),accountMasterId:$accountMasterId},dataType:"json",success:function(n){if(n.result)$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){selectNode(n.Object);$("#confirm-merge").modal("toggle");$("#app-coa-account-merge").modal("toggle");cleanBookNotification.updateSuccess()});else{cleanBookNotification.error("Have an error, detail: "+n.msg,"Qbicles");return}},error:function(n){cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};$accountDelId=0;DeleteAccount=function(n){$accountDelId=n;$(".account-1-name").text($("#account-name-title").text());$("#confirm-delete").modal("show")};ConfirmDeleteAccount=function(){$.LoadingOverlay("show");$.ajax({type:"get",url:"/Bookkeeping/BKDeleteAccount",data:{accountId:$accountDelId},dataType:"json",success:function(n){if(n.result)$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){selectNode(n.Object);$("#confirm-delete").modal("hide");cleanBookNotification.removeSuccess()});else{cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles");return}},error:function(n){cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};ConfirmDeleteGroup=function(){$.LoadingOverlay("show");$.ajax({type:"get",url:"/Bookkeeping/BKDeleteSubGroup",data:{groupId:subgroupId},dataType:"json",success:function(n){if(n.result)$("#bkaccount-tree").load("/Bookkeeping/TreeViewGroupChartPartial?callback=true",function(){n.Object&&selectNode(n.Object);$("#confirm-delete-bksubgroup").modal("hide");cleanBookNotification.removeSuccess()});else{cleanBookNotification.error("Have an error, detail: "+n.msg,"Qbicles");return}},error:function(n){cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};regExp=/([a-zA-Z0-9]+\-?\|?\.?\Â¦?\\?\/?)+/;CloseBook=function(){AjaxElementShowModal("/Bookkeeping/CloseBook","app-coa-account-close")};CloseBookConfirm=function(){$("#app-coa-account-close").modal("hide");$("#app-coa-account-close-confirm").modal("show")};CloseBookSave=function(){$.LoadingOverlay("show");$.ajax({type:"get",url:"/Bookkeeping/CloseBookSave",data:{closureDate:$("#close-date-confirm").text()},dataType:"json",success:function(n){if(n.result)$("#close-date-home").text($("#close-date-confirm").text()),$("#app-coa-account-close-confirm").modal("hide"),cleanBookNotification.success();else{cleanBookNotification.error("Have an error, detail: "+n.msg,"Qbicles");return}},error:function(n){cleanBookNotification.error("Have an error, detail: "+n.error,"Qbicles")}}).always(function(){LoadingOverlayEnd()})};