function readImgURL(n,t){if(n.files&&n.files[0]){var i=new FileReader;i.onload=function(n){$(t).attr("src",n.target.result)};i.readAsDataURL(n.files[0])}}function SocialRefreshProductVPropositon(n){$('#frm-value-prop select[name=ProductId] option[value="'+n.id+'"]').length<=0&&$("#frm-value-prop select[name=ProductId]").append($("<option>",{value:n.id,text:n.text})).select2()}function ProcessSaleMarketingBranchProduct(){var t,n;if($("#frm-brand-product").valid()){if(t=$("#frm-brand-product input[name=Id]").val(),t==0&&$("#frm-brand-product input[name=featuredimg]").get(0).files.length===0){$("#frm-brand-product").validate().showErrors({featuredimg:"This field is required."});return}$.LoadingOverlay("show");n=document.getElementById("sm-brand-product-upload-image").files;n&&n.length>0?UploadMediaS3ClientSide("sm-brand-product-upload-image").then(function(n){if(n.objectKey==="no_image"||n.objectKey==="no-image"){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-brand-product-object-key").val(n.objectKey);$("#sm-brand-product-object-name").val(n.fileName);$("#sm-brand-product-object-size").val(n.fileSize);SubmitSaleMarketingBranchProduct()}):($("#sm-brand-product-object-key").val(""),$("#sm-brand-product-object-name").val(""),$("#sm-brand-product-object-size").val(""),SubmitSaleMarketingBranchProduct())}}function SocialBrandProductReset(){var n=$("#frm-brand-product");n.trigger("reset");$("#frm-brand-product img[name=productpreview]").hide();$("#frm-brand-product input[name=Id]").val("0");$("#frm-brand-product").validate().resetForm();$("#app-marketing-brand-product-modal .modal-title").text("Add a Brand Product")}function SocialBrandProductLoadEdit(n){$.getJSON("/SalesMarketingBrand/LoadBrandProductById",{id:n},function(t){t?($("#app-marketing-brand-product-modal .modal-title").text("Edit Brand Product"),$("#frm-brand-product input[name=Id]").val(n),$("#frm-brand-product input[name=Name]").val(t.Name),$("#frm-brand-product textarea[name=Summary]").val(t.Summary),$("#frm-brand-product .productpreview").attr("src",t.featuredimg),$("#frm-brand-product .productpreview").show(),$("#app-marketing-brand-product-modal").modal("show")):cleanBookNotification.error(_L("ERROR_MSG_143",[n]),"Sales Marketing")})}function SocialBrandProductLoad(n,t){$.LoadingOverlay("show");$.ajax({url:"/SalesMarketingBrand/LoadBrandProducts",data:{brandId:$("#hdfBrandId").val(),size:brandCountRecord*n,pageSize:n,keyword:$("#txtBrandProductSearch").val(),isLoadingHide:$("#isLoadingHideBrandProduct").is(":checked")?!0:!1},cache:!1,type:"POST",dataType:"html",beforeSend:function(){},success:function(n){var i=$("#brand-products .restyle"),r;t?$("#brand-products").html(n).fadeIn(250):i?i.append(n).fadeIn(250):$("#brand-products").append(n).fadeIn(250);brandCountRecord=brandCountRecord+1;r=$("#isHiddeLoadMore");r.length>0&&$("#btnLoadBands").remove();LoadingOverlayEnd()},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles");LoadingOverlayEnd()}})}function ShowOrHideBrandProduct(n){$.ajax({url:"/SalesMarketingBrand/ShowOrHideBrandProduct",data:{id:n},type:"POST",success:function(n){n.result?SocialBrandProductSearch():cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}})}function SocialBrandProductSearch(){brandCountRecord=0;SocialBrandProductLoad(brandPageSize,!0)}function SocialBrandAutoGenerateFolderName(){$.getJSON("/SalesMarketingBrand/AutoGenerateFolderName",function(n){n&&$("#brandFolderName").val(n)})}function SearchThrottle(n,t){var i=null;return function(){var r=this,u=arguments;clearTimeout(i);i=window.setTimeout(function(){n.apply(r,u)},t||800)}}function SocialMediasByBrand(n,t){$.LoadingOverlay("show");var i=$("#sl-media-type").val();$.ajax({type:"post",url:"/SalesMarketingBrand/LoadMediasByBrand",datatype:"json",data:{fid:n,qid:t,fileType:i=="All"?"":i},success:function(n){if(n){var t=$("#brand-resources .flex-grid-thirds-lg");t.html(n);totop();LoadingOverlayEnd()}},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles");LoadingOverlayEnd()}})}function SocialBrandValuePropotionAdd(){$(".checkmulti").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});var n=$("#frm-value-prop");n.validate({rules:{ProductId:{required:!0},WhoWantTo:{required:!0,maxlength:200},By:{required:!0,maxlength:200}}});n.submit(function(t){if(t.preventDefault(),n.valid()){if(!$("#frm-value-prop select[name=CustomerSegment]").val()){n.validate().showErrors({CustomerSegment:"This field is required."});return}$.LoadingOverlay("show");var i=$(this).serializeArray();i.push({name:"BrandId",value:$("#hdfBrandId").val()});$.ajax({type:this.method,url:this.action,data:i,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){isBusyAddTaskForm=!1;n.result?($("#app-marketing-value-prop-add").modal("hide"),$("#frm-value-prop input[name=Id]").val()==="0"?cleanBookNotification.success(_L("ERROR_MSG_144"),"Sales Marketing"):cleanBookNotification.success(_L("ERROR_MSG_145"),"Sales Marketing"),SocialBrandValuePropotionReset(),socialBrandValueProLoad()):n.msg&&cleanBookNotification.error(n.msg,"Sales Marketing");LoadingOverlayEnd()},error:function(){isBusyAddTaskForm=!1;cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing");LoadingOverlayEnd()}})}})}function SocialBrandValuePropotionReset(){var n=$("#frm-value-prop");n.trigger("reset");$("#frm-value-prop select[name=ProductId]").val("").change();$("#frm-value-prop select[name=CustomerSegment]").val("").change();$("#frm-value-prop select[name=CustomerSegment]").multiselect("refresh");$("#frm-value-prop input[name=Id]").val(0);$("#prop-action").text("");$("#prop-benefit").text("");n.validate().resetForm();$("#app-marketing-value-prop-add .modal-title").text("Add a Value Proposition")}function SocialBrandValueProEdit(n){$.getJSON("/SalesMarketingBrand/LoadBrandValueProposionById",{id:n},function(t){t?($("#app-marketing-value-prop-add .modal-title").text("Edit Value Proposition"),$("#frm-value-prop input[name=Id]").val(t.Id),$("#frm-value-prop select[name=ProductId]").val(t.productId).change(),$("#frm-value-prop select[name=CustomerSegment]").val(t.segments).change(),$("#frm-value-prop select[name=CustomerSegment]").multiselect("refresh"),$("#frm-value-prop input[name=WhoWantTo]").val(t.WhoWantTo),$("#prop-action").text(t.WhoWantTo),$("#frm-value-prop input[name=By]").val(t.By),$("#prop-benefit").text(t.By),$("#app-marketing-value-prop-add").modal("show")):cleanBookNotification.error(_L("ERROR_MSG_146",[n]),"Sales Marketing")})}function socialBrandValueProLoad(){var n=$("#hdfBrandId").val(),t=$("#valuefilter").val(),i;$.LoadingOverlay("show");i=$("#sl-media-type").val();$.ajax({type:"post",url:"/SalesMarketingBrand/LoadValuePropositionByBrand",dataType:"html",data:{brandId:n,productId:t,isLoadingHide:$("#isLoadingHideValueProp").is(":checked")?!0:!1},success:function(n){if(n){var t=$("#brand-value .flex-grid-thirds-lg");t.html(n);totop();LoadingOverlayEnd()}},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles");LoadingOverlayEnd()}})}function ShowOrHideValueProp(n){$.ajax({url:"/SalesMarketingBrand/ShowOrHideValueProp",data:{id:n},type:"POST",success:function(n){n.result?socialBrandValueProLoad():cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}})}function ProcessSaleMarketingBranchAttributeGroup(){var n,t;if($("#frm-attribute-group").valid()){if(n=$("#hdfBrandId").val(),n==="0"&&!$("#frm-attribute-group input[name=FeaturedImg]").val()){$("#frm-attribute-group").validate().showErrors({FeaturedImg:"This field is required."});return}$.LoadingOverlay("show");t=document.getElementById("sm-attribute-group-upload-image").files;t&&t.length>0?UploadMediaS3ClientSide("sm-attribute-group-upload-image").then(function(t){if(t.objectKey==="no_image"||t.objectKey==="no-image"){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-brand-attribute-group-object-key").val(t.objectKey);$("#sm-brand-attribute-group-object-name").val(t.fileName);$("#sm-brand-attribute-group-object-size").val(t.fileSize);SubmitSaleMarketingBranchAttributeGroup(n)}):($("#sm-brand-attribute-group-object-key").val(""),$("#sm-brand-attribute-group-object-name").val(""),$("#sm-brand-attribute-group-object-size").val(""),SubmitSaleMarketingBranchAttributeGroup(n))}}function SocialLoadAttrsForAttrGroup(){$.ajax({type:"post",url:"/SalesMarketingBrand/LoadOptionAttributeByBrandId",dataType:"html",data:{brandId:$("#hdfBrandId").val()},success:function(n){n&&($("#frm-attribute-group select[name=Attributes]").html(n),$("#frm-attribute-group select[name=Attributes]").multiselect("destroy"),$("#frm-attribute-group select[name=Attributes]").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0}),$("#frm-attribute-group select[name=Attributes]").hide())},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}})}function SocialBrandAttributeGroupEdit(n){$.getJSON("/SalesMarketingBrand/GetBrandAttributegroupById",{id:n},function(t){t?($("#app-marketing-attribute-group-add .modal-title").text("Edit Attribute Group"),$("#frm-attribute-group input[name=Id]").val(t.Id),$("#frm-attribute-group input[name=Name]").val(t.Name),$("#frm-attribute-group textarea[name=Summary]").val(t.Summary),$("#frm-attribute-group img.groupimg").attr("src",t.IconUrl),$("#frm-attribute-group img.groupimg").show(),$("#frm-attribute-group select[name=Attributes]").val(t.Attributes),$("#frm-attribute-group select[name=Attributes]").multiselect("refresh"),$("#app-marketing-attribute-group-add").modal("show")):cleanBookNotification.error(_L("ERROR_MSG_149",[n]),"Sales Marketing")})}function SocialBrandAttributeGroupReset(){var n=$("#frm-attribute-group");n.trigger("reset");$("#frm-attribute-group select[name=Attributes]").val("").change();$("#frm-attribute-group select[name=Attributes]").multiselect("refresh");$("#frm-attribute-group input[name=Id]").val(0);$("#frm-attribute-group img.groupimg").hide();$("#frm-attribute-group input[name=FeaturedImg]").val();n.validate().resetForm();$("#app-marketing-attribute-group-add .modal-title").text("Add an Attribute Group")}function SocialBrandAttributeGroupLoad(){var n=$("#hdfBrandId").val(),t=$("#txtSearchAttrGroup").val(),i;$.LoadingOverlay("show");i=$("#sl-media-type").val();$.ajax({type:"post",url:"/SalesMarketingBrand/LoadBrandAttrGroupsByBrandId",dataType:"html",data:{brandId:n,keyword:t},success:function(n){if(n){var t=$("#brand-attribute-groups .flex-grid-quarters-lg");t.html(n);totop();LoadingOverlayEnd()}},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles");LoadingOverlayEnd()}})}function ProcessSaleMarketingBranchAttribute(){var n,t;if($("#frm-attribute").valid()){if(n=$("#hdfBrandId").val(),n==="0"&&!$("#frm-attribute input[name=FeaturedImg]").val()){$("#frm-attribute").validate().showErrors({FeaturedImg:"This field is required."});return}$.LoadingOverlay("show");t=document.getElementById("sm-attribute-upload-image").files;t&&t.length>0?UploadMediaS3ClientSide("sm-attribute-upload-image").then(function(t){if(t.objectKey==="no_image"||t.objectKey==="no-image"){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-brand-attribute-object-key").val(t.objectKey);$("#sm-brand-attribute-object-name").val(t.fileName);$("#sm-brand-attribute-object-size").val(t.fileSize);SubmitSaleMarketingBranchAttribute(n)}):($("#sm-brand-attribute-object-key").val(""),$("#sm-brand-attribute-object-name").val(""),$("#sm-brand-attribute-object-size").val(""),SubmitSaleMarketingBranchAttribute(n))}}function SocialBrandAttributeEdit(n){$.getJSON("/SalesMarketingBrand/GetBrandAttributeById",{id:n},function(n){n?($("#app-marketing-attribute-add .modal-title").text("Edit Attribute"),$("#frm-attribute input[name=Id]").val(n.Id),$("#frm-attribute input[name=Name]").val(n.Name),$("#frm-attribute textarea[name=Summary]").val(n.Summary),$("#frm-attribute img.attrimg").attr("src",n.IconUrl),$("#frm-attribute img.attrimg").show(),$("#app-marketing-attribute-add").modal("show")):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")})}function SocialBrandAttributeLoad(){var n=$("#hdfBrandId").val(),t=$("#txtAttributeSearch").val();$.LoadingOverlay("show");$.ajax({type:"post",url:"/SalesMarketingBrand/LoadBrandAttributeByBrandId",dataType:"html",data:{brandId:n,keyword:t,isLoadingHide:$("#isLoadingHideAttribute").is(":checked")?!0:!1},success:function(n){if(n){var t=$("#brand-attribute-attributes .flex-grid-quarters-lg");t.html(n);totop()}},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function ShowOrHideBrandAttribute(n){$.ajax({url:"/SalesMarketingBrand/ShowOrHideBrandAttribute",data:{id:n},type:"POST",success:function(n){n.result?SocialBrandAttributeLoad():cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}})}function SocialBrandAttributeReset(){var n=$("#frm-attribute");n.trigger("reset");$("#frm-attribute input[name=Id]").val(0);$("#frm-attribute img.attrimg").hide();$("#frm-attribute input[name=FeaturedImg]").val();n.validate().resetForm();$("#app-marketing-attribute-add .modal-title").text("Add an Attribute")}function SocialMediaBranchResourceSaveMedia(n){$form_media_addedit.valid()&&$.ajax({url:"/Medias/DuplicateMediaNameCheck",data:{qbicleId:n,mediaId:0,MediaName:$("#form_media_smresource input[name=name]").val()},type:"GET",dataType:"json"}).done(function(n){n.result?$form_media_addedit.validate().showErrors({name:"Name of Media already exists."}):ProcessSaleMarketingBranchResource()}).fail(function(){$form_media_addedit.validate().showErrors({name:"Error checking existing name of Media"})})}function ProcessSaleMarketingBranchResource(){$.LoadingOverlay("show");var n=document.getElementById("sm-brand-resource-upload-image").files;n&&n.length>0?UploadMediaS3ClientSide("sm-brand-resource-upload-image").then(function(n){if(n.objectKey==="no_image"||n.objectKey==="no-image"){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-brand-resource-object-key").val(n.objectKey);$("#sm-brand-resource-object-name").val(n.fileName);$("#sm-brand-attribute-object-size").val(n.fileSize);SubmitSocialMediaBranchResourceSaveMedia()}):($("#sm-brand-resource-object-key").val(""),$("#sm-brand-resource-object-name").val(""),$("#sm-brand-resource-object-size").val(""),SubmitSocialMediaBranchResourceSaveMedia())}function LoadCampaignsInBrand(){$("#community-list").on("processing.dt",function(n,t,i){i&&$(".loadingoverlay").length===0?$("#community-list").LoadingOverlay("show"):$("#community-list").LoadingOverlay("hide",!0)}).DataTable({destroy:!0,dom:'<"top"fl<"clear">>rt<"bottomtable"ip<"clear">>',serverSide:!0,info:!1,stateSave:!1,bLengthChange:!0,paging:!0,searching:!1,responsive:!0,scrollX:!1,autoWidth:!0,deferLoading:30,lengthMenu:[[10,20,50,100],[10,20,50,100]],pageLength:10,ajax:{url:"/SalesMarketingBrand/LoadCampaignsInBrand",type:"POST",data:function(n){return $.extend({},n,{brandId:$("#hdfBrandId").val(),types:$("#campaignType").val(),search:$("#searchCampaign").val()})}},columns:[{data:"Name",orderable:!1},{data:"Type",orderable:!1},{data:"NumberOfQueue",orderable:!1},{data:"NumberOfCompletedPost",orderable:!1},{data:null,orderable:!1,render:function(n,t,i){return'<button class="btn btn-info" data-toggle="modal" data-target="#app-marketing-brand-usage" onclick="LoadBrandElement('+i.Id+", '"+i.Type+'\')"><i class="fa fa-list"><\/i> &nbsp; View<\/button>'}},{data:null,orderable:!1,render:function(n,t,i){var r="";return r=i.Type=="Email"?"/SalesMarketing/SMEmail?id="+i.Id:i.Type=="Automated Social"?"/SalesMarketing/SMSocial?id="+i.Id:"/SalesMarketing/SMManualSocial?id="+i.Id,'<button class="btn btn-primary" onclick="window.location.href=\''+r+'\'"><i class="fa fa-eye"><\/i> &nbsp; View Campaign<\/button>'}}],initComplete:function(){$("#community-list").DataTable().ajax.reload()}})}function LoadBrandElement(n,t){$("#app-marketing-brand-usage").load("/SalesMarketingBrand/LoadBrandElement",{id:n,type:t},function(){})}function ProcessSaleMarketingBranch(){if($("#frm-marketing-brand").valid()){$.LoadingOverlay("show");var n=document.getElementById("sm-brand-upload-image").files;n&&n.length>0?UploadMediaS3ClientSide("m-brand-upload-image").then(function(n){if(n.objectKey==="no_image"||n.objectKey==="no-image"){LoadingOverlayEnd();cleanBookNotification.error(_L("ERROR_MSG_S3_UPLOAD"),"Qbicles");return}$("#sm-brand-object-key").val(n.objectKey);$("#sm-brand-object-name").val(n.fileName);$("#sm-brand-object-size").val(n.fileSize);SubmitSaleMarketingBranch()}):($("#sm-brand-object-key").val(""),$("#sm-brand-object-name").val(""),$("#sm-brand-object-size").val(""),SubmitSaleMarketingBranch())}}var isBusyAddTaskForm=!1,brandCountRecord=1,$form_media_addedit=$("#form_media_smresource");SubmitSaleMarketingBranchProduct=function(){var n=new FormData($("#frm-brand-product")[0]);n.append("BrandId",$("#hdfBrandId").val());$.ajax({type:"post",cache:!1,url:"/SalesMarketingBrand/SaveBrandProduct",enctype:"multipart/form-data",data:n,processData:!1,contentType:!1,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){n.result?($("#app-marketing-brand-product-modal").modal("hide"),$("#frm-brand-product input[name=Id]").val()==="0"?cleanBookNotification.success(_L("ERROR_MSG_141"),"Sales Marketing"):cleanBookNotification.success(_L("ERROR_MSG_142"),"Sales Marketing"),SocialBrandProductSearch(),SocialBrandProductReset(),SocialRefreshProductVPropositon(n.Object)):cleanBookNotification.error(n.msg?n.msg:"Have an error!","Sales Marketing");LoadingOverlayEnd()},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){LoadingOverlayEnd();isBusyAddTaskForm=!1})};$("#isLoadingHideValueProp").change(SearchThrottle(function(){socialBrandValueProLoad()}));SubmitSaleMarketingBranchAttributeGroup=function(n){var t=new FormData($("#frm-attribute-group")[0]);t.append("BrandId",n);$.ajax({type:"post",url:"/SalesMarketingBrand/SaveBrandAttrGroup",enctype:"multipart/form-data",data:t,processData:!1,contentType:!1,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){n.result?($("#app-marketing-attribute-group-add").modal("hide"),$("#frm-value-prop input[name=Id]").val()==="0"?cleanBookNotification.success(_L("ERROR_MSG_147"),"Sales Marketing"):cleanBookNotification.success(_L("ERROR_MSG_148"),"Sales Marketing"),SocialBrandAttributeGroupReset(),SocialBrandAttributeGroupLoad()):n.msg&&cleanBookNotification.error(n.msg,"Sales Marketing")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){isBusyAddTaskForm=!1;LoadingOverlayEnd()})};SubmitSaleMarketingBranchAttribute=function(n){var t=new FormData($("#frm-attribute")[0]);t.append("BrandId",n);$.ajax({type:"post",url:"/SalesMarketingBrand/SaveBrandAttribute",enctype:"multipart/form-data",data:t,processData:!1,contentType:!1,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){n.result?($("#app-marketing-attribute-add").modal("hide"),$("#frm-attribute input[name=Id]").val()==="0"?cleanBookNotification.success(_L("ERROR_MSG_150"),"Sales Marketing"):cleanBookNotification.success(_L("ERROR_MSG_151"),"Sales Marketing"),SocialBrandAttributeReset(),SocialBrandAttributeLoad(),SocialLoadAttrsForAttrGroup()):n.msg&&cleanBookNotification.error(n.msg,"Sales Marketing");LoadingOverlayEnd()},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){isBusyAddTaskForm=!1;LoadingOverlayEnd()})};SubmitSocialMediaBranchResourceSaveMedia=function(){var n=new FormData($form_media_addedit[0]);n.append("qbicleId",$("#media-qbicleId").val());$.ajax({type:"post",cache:!1,url:"/SalesMarketing/SaveCampaignResource",enctype:"multipart/form-data",data:n,processData:!1,contentType:!1,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){n.result?($("#create-resource").modal("hide"),isBusyAddTaskForm=!1,cleanBookNotification.success(_L("ERROR_MSG_172"),"Sales Marketing"),SocialMediasByBrand($("#hdfmediaFolderId").val(),$("#media-qbicleId").val()),$form_media_addedit.trigger("reset")):n.msg&&(cleanBookNotification.error(n.msg,"Sales Marketing"),isBusyAddTaskForm=!1)},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){LoadingOverlayEnd();isBusyAddTaskForm=!1})};$(document).ready(function(){SocialBrandValuePropotionAdd();LoadCampaignsInBrand();$("#txtBrandProductSearch").keyup(SearchThrottle(function(){SocialBrandProductSearch()}));$("#isLoadingHideBrandProduct").change(SearchThrottle(function(){SocialBrandProductSearch()}));$(".checkmulti").multiselect({includeSelectAllOption:!1,enableFiltering:!1,buttonWidth:"100%",maxHeight:400,enableClickableOptGroups:!0});$(".previewAttrGroupimg").change(function(){var n=$(this).data("target");readImgURL(this,n);$(n).fadeIn()});$("#txtSearchAttrGroup").keyup(SearchThrottle(function(){SocialBrandAttributeGroupLoad()}));$("#sm-brand-product-upload-image").change(function(){var n=$(this).data("target");readImgURL(this,n);$(n).fadeIn()});$(".previewAttrimg").change(function(){var n=$(this).data("target");readImgURL(this,n);$(n).fadeIn()});$("#txtAttributeSearch").keyup(SearchThrottle(function(){SocialBrandAttributeLoad()}));$("#isLoadingHideAttribute").change(SearchThrottle(function(){SocialBrandAttributeLoad()}))});SubmitSaleMarketingBranch=function(){var n=$("#frm-marketing-brand select[name=FeaturedImageUri]").val(),t;if(!n||n=="0"&&!$("#brandFolderName").val()){$frm_marketing_brand.validate().showErrors({FolderName:"This field is required."});return}t=new FormData($("#frm-marketing-brand")[0]);$.ajax({type:"post",cache:!1,url:"/SalesMarketingBrand/SaveSaleMarketingBrand",enctype:"multipart/form-data",data:t,processData:!1,contentType:!1,beforeSend:function(){isBusyAddTaskForm=!0},success:function(n){n.result?($("#app-marketing-brand-add").modal("hide"),cleanBookNotification.success(_L("ERROR_MSG_140"),"Sales Marketing"),getTotalPageBrand()):(cleanBookNotification.error(n.msg?n.msg:"Have an error!","Sales Marketing"),isBusyAddTaskForm=!1);LoadingOverlayEnd()},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Sales Marketing")}}).always(function(){isBusyAddTaskForm=!1;LoadingOverlayEnd()})};