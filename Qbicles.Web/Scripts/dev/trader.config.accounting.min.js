function clickAdd(){$(".accountInfo").text("");$(".editbtnaccount").attr("style","display:none;");$(".addbtnaccount").removeAttr("style");ResetFormControl("form_taxrate_add")}function addTaxRate(){$("#form_taxrate_add").valid()&&($(".app-coa-tax-add").LoadingOverlay("show"),$.ajax({type:"post",url:"/Bookkeeping/SaveTaxRate",data:{Name:$("#add-taxrate-name").val(),Rate:$("#add-taxrate-rate").val(),AssociatedAccount:{Id:BKAccount.Id?BKAccount.Id:0},IsAccounted:$("#add-isAccounted").val()=="1"?!0:!1,IsPurchaseTax:$("#add-isPurchaseTax").val()=="1"?!0:!1,IsCreditToTaxAccount:$("#add-isCreditToTaxAccount").val()=="1"?!0:!1,Description:$("#add-taxrate-description").val()},dataType:"json",success:function(n){n.result==!0?n.actionVal==1?($("#app-coa-tax-add").modal("toggle"),cleanBookNotification.createSuccess(),reloadAccounting()):n.actionVal==2?($("#app-coa-tax-edit").modal("toggle"),cleanBookNotification.updateSuccess(),reloadAccounting()):n.actionVal==3&&cleanBookNotification.error(n.msg,"Qbicles"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}).always(function(){$(".app-coa-tax-add").LoadingOverlay("hide",!0)}))}function editTaxRate(n){ResetFormControl("form_taxrate_edit");$.ajax({type:"get",url:"/Bookkeeping/GetEditTaxRateById",data:{id:n},dataType:"json",success:function(n){$("#edit-taxrate-id").val(n.Id);$("#edit-taxrate-name").val(n.Name);$("#edit-taxrate-rate").val(n.Rate);$("#edit-taxrate-description").val(n.Description);$("#edit-isAccounted").val(n.IsAccounted?"1":"0").trigger("change");$("#edit-isPurchaseTax").val(n.IsPurchaseTax?"1":"0").trigger("change");$("#edit-isCreditToTaxAccount").val(n.IsCreditToTaxAccount?"1":"0").trigger("change");n.AssociatedAccount?(BKAccount={Id:n.AssociatedAccount.Id,Name:n.AssociatedAccount.Name},$(".accountInfo").text(BKAccount.Name)):(BKAccount={},$(".accountInfo").text(""));$(".accountInfo").text().length>0?($(".addbtnaccount").attr("style","display:none;"),$(".editbtnaccount").removeAttr("style")):$(".accountInfo").text().length===0&&($(".editbtnaccount").attr("style","display:none;"),$(".addbtnaccount").removeAttr("style"))},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function updateTaxrate(){if($("#form_taxrate_edit").valid()){$(".app-coa-tax-edit").LoadingOverlay("show");var n=$("#edit-isAccounted").val()=="1"?!0:!1,t={Id:$("#edit-taxrate-id").val(),Name:$("#edit-taxrate-name").val(),Rate:$("#edit-taxrate-rate").val(),AssociatedAccount:{Id:BKAccount.Id&&n?BKAccount.Id:0},IsAccounted:n,IsPurchaseTax:$("#edit-isPurchaseTax").val()=="1"&&n?!0:!1,IsCreditToTaxAccount:$("#edit-isCreditToTaxAccount").val()=="1"&&n?!0:!1,Description:$("#edit-taxrate-description").val()};$.ajax({type:"post",url:"/Bookkeeping/SaveTaxRate",data:t,dataType:"json",success:function(n){n.result==!0?n.actionVal==1?($("#app-coa-tax-add").modal("toggle"),cleanBookNotification.createSuccess(),reloadAccounting()):n.actionVal==2?($("#app-coa-tax-edit").modal("toggle"),cleanBookNotification.updateSuccess(),reloadAccounting()):n.actionVal==3&&cleanBookNotification.error(n.msg,"Qbicles"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}}).always(function(){$(".app-coa-tax-edit").LoadingOverlay("hide",!0)})}}function confirmDeleteTaxRate(n,t){$("#label-confirm-taxrate").text("Do you want delete tax rate : "+t);$("#id-itemtaxrate-delete").val(n)}function deleteTaxRate(){$.ajax({type:"delete",url:"/Bookkeeping/DeleteTaxRate",data:{id:$("#id-itemtaxrate-delete").val()},dataType:"json",success:function(n){n=="OK"?(cleanBookNotification.removeSuccess(),reloadAccounting()):n=="Fail"&&cleanBookNotification.removeFail()},error:function(){cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")}})}function initSelectedAccount(){setTimeout(function(){$(".selectaccount").removeClass("selectaccount");$(".accountid-"+BKAccount.Id).addClass("selectaccount")},1)}function selectAccount(n,t){var i=$(".accountid-"+t).data("name");$(".selectaccount").removeClass("selectaccount");$(n).addClass("selectaccount");BKAccount={Id:t,Name:i};closeSelected();$("#app-bookkeeping-treeview").modal("toggle")}function closeSelected(){BKAccount.Id?($(".accountInfo").empty(),$(".accountInfo").append(BKAccount.Name)):$(".accountInfo").empty();$(".accountInfo").text().length>0?($(".addbtnaccount").attr("style","display:none;"),$(".editbtnaccount").removeAttr("style")):$(".accountInfo").text().length===0&&($(".editbtnaccount").attr("style","display:none;"),$(".addbtnaccount").removeAttr("style"))}function CollapseAccount(){$(".jstree").jstree("close_all")}function UpdateJournalGroupDefault(n){var t={journalGroupId:$("#journal-group-default").val(),traderSettingId:n};$.ajax({type:"post",url:"/TraderConfiguration/UpdateJournalGroupDefault",datatype:"json","async":!1,data:t,success:function(n){n.result?cleanBookNotification.updateSuccess():cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Qbicles")},error:function(n){cleanBookNotification.error(n.responseText,"Qbicles")}})}var BKAccount={};reloadAccounting=function(){$("#comfig-content").LoadingOverlay("show");setTimeout(function(){$("#comfig-content").load("/TraderConfiguration/TraderConfigurationContent?value=accounting");$("#comfig-content").LoadingOverlay("hide")},500)};$(document).ready(function(){$("#tblTaxrates").DataTable({destroy:!0,responsive:!0,lengthChange:!0,pageLength:10,columnDefs:[{targets:3,orderable:!1}],order:[]});$(".apps-account").bootstrapToggle();$("#tblTaxrates").show();$("select.select2").select2({placeholder:"Please select"})});