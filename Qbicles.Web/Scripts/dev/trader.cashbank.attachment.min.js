function CloseCashBankAttachment(){$("#attachments-view-payment").modal("hide")}function AddCashBankAttachmentAnother(n){var r=GenerateUUID(),i=$(".attachments_"+n+" input.inputfile"),t='<div class="row attachment_row att-id-'+r+'"> <div class="col-xs-12"><input type="hidden" class="file-id-input'+(i.length+1)+'" value="'+r+'"/>';t+='<div class="form-group"> <label for="name">Name<\/label> <input type="text" name="name" class="form-control inputfilename'+(i.length+1)+'">';t+='<\/div> <\/div> <div class="col-xs-12"> <div class="form-group"> <label for="file">File<\/label>';t+='<input type="file" name="file" onchange="ChangeFileCashBankAttachment(this,'+(i.length+1)+","+n+')" class="form-control inputfile">  <\/div>  <\/div> <\/div>';$(".attachments_"+n+" div.repeater_wrap").append(t)}function ChangeFileCashBankAttachment(n,t,i){var r=$(".attachments_"+i+" input.inputfilename"+t).val(),u,f;for($(n).length>0&&$(n)[0].files.length>0&&r.length==0&&(r=$(n)[0].files[0].name),u=$(".attachments_"+i+" input.inputfile"),f=0;f<u.length;f++)u[0]!==n&&$(u[0]).val()===$(n).val()&&($(n).val(""),cleanBookNotification.error(_L("ERROR_MSG_351",[r]),"Qbicles"),r="");$(".attachments_"+i+" .inputfilename"+t).val(r)}function ConfirmCashBankAttachmentAddViewer(n){CashBankAttachmentMediaBind(n);$("ul.domain-change-list").empty();var t=$traderCashBankAttachmentExisted.AssociatedFiles.length+$traderCashBankAttachments.length;$("#span-attachment-count").text(" Attachments ("+t+")");_.forEach($traderCashBankAttachmentExisted.AssociatedFiles,function(n){var t=" <li id='att-"+n.Id+'\'><input class="file-id" type="hidden" value="'+n.Id+"\" /><button class='btn btn-danger' onclick=\"RemoveCashBankAttachment('"+n.Id+"')\"><i class='fa fa-trash'><\/i><\/button> <a href='javascript:void(0)'>";t+='<img src="'+n.IconPath+'" style="max-width: 80px; height: auto; padding-right: 10px;">';t+=n.Name+" <\/a> <\/li>";$("#transaction-attachments ul.domain-change-list").append(t)});_.forEach($traderCashBankAttachments,function(n){var t=" <li id='att-"+n.Id+'\'><input class="file-id" type="hidden" value="'+n.Id+"\" /><button class='btn btn-danger' onclick=\"RemoveCashBankAttachment('"+n.Id+"')\"><i class='fa fa-trash'><\/i><\/button> <a href='javascript:void(0)'>";t+='<img src="'+n.IconPath+'" style="max-width: 80px; height: auto; padding-right: 10px;">';t+=n.Name+" <\/a> <\/li>";$("#transaction-attachments ul.domain-change-list").append(t)})}$(document).ready(function(){$qbiclesFileTypes=[];$.ajax({type:"post",url:"/FileTypes/GetFileTypes",dataType:"json",success:function(n){$qbiclesFileTypes=n},error:function(){}}).always(function(){LoadingOverlayEnd()})});CloseAddCashBankAttachment=function(){$("#attachments-view-payment").modal("hide")};RemoveCashBankAttachment=function(n){$("#att-"+n).remove();$(".att-id-"+n).remove();_.remove($traderCashBankAttachments,function(t){return t.Id==n});_.remove($traderCashBankAttachmentExisted.AssociatedFiles,function(t){return t.Id==n});$("#span-attachment-count").text($("#transaction-attachments ul.domain-change-list li").length)};CashBankAttachmentMediaBind=function(n){var u,i,t,o,f;for($traderCashBankAttachments=[],$traderCashBankAttachmentExisted={AssociatedFiles:[]},u="",i=$("#attachments-view-payment .attachments_"+n+" input.inputfile"),t=0;t<i.length;t++)if($(".attachments_"+n+" .inputfilename"+(t+1)).val()===""&&i[t].files.length>0&&$(".attachments_"+n+" .inputfilename"+(t+1)).val(i[t].files[0].name.substr(0,i[t].files[0].name.lastIndexOf("."))),i[t].files.length>0){var e=$("div.attachments_"+n+" .inputfilename"+(t+1)).val(),s=$("div.attachments_"+n+" .file-id-input"+(t+1)).val(),r=i[t].files[0];u=r.name.split(".").pop();o=_.find($qbiclesFileTypes,function(n){return n.Extension===u});f={Id:s,Name:r.name,Extension:r.name.split(".").pop(),Size:r.size,IconPath:o.IconPath,File:r};e!==""&&(f.Name=e);$traderCashBankAttachments.push(f)}else $("#file_id_"+(t+1)).length>0&&$traderCashBankAttachmentExisted.AssociatedFiles.push({Id:parseInt($("#file_id_"+(t+1)).val()),Name:$(".inputfilename"+(t+1)).val(),IconPath:$("#inputiconpath_edit"+(t+1)).val()})};