function SearchDriver(){if($("#driver-search").val().length>3||$("#driver-search").val().length===0){var n="/DDS/DdsDriverSearch?name="+$("#driver-search").val()+"&statusId="+$("#driver-status").val()+"&locationId="+$("#driver-location").val()+"&currentLocationId="+$("#current-location-id").val();AjaxElementLoad(n,"driver-list")}}function searchDeliveryDrivers(){var n=$("#txtmembersearch").val();$(".contact-list-found").LoadingOverlay("show");$(".contact-list-found").load("/TraderChannels/LoadModalDeliveryDriver",{keyword:n},function(){$(".existing-member").show();$(".contact-list-found").LoadingOverlay("hide")})}function loadContentMemberDetail(n){var t=$(".contact-add");t.empty();t.LoadingOverlay("show");t.load("/TraderChannels/LoadContentMemberDetailByUser?posUId="+n,function(){t.LoadingOverlay("hide");$(".contact-list-found").hide();$(".contact-invite").hide();$(".contact-add").hide();$(".contact-add").fadeIn()})}function saveMember(){$.LoadingOverlay("show");$.post("/TraderChannels/AddDriver",{posUId:$("#hdfPosUid").val(),accountId:$("#hdfAccountId").val(),locationId:$("#slLocationIdForDriver").val(),driverUserId:$("#hdfUserid").val()},function(n){n.result?($("#delivery-driver-add").modal("hide"),SearchDriver(),$("#lnkBackSearch").click(),$("#txtmembersearch").val(""),$(".contact-list-found").empty(),cleanBookNotification.success(_L("UPDATE_MSG_SUCCESS"),"Trader")):!n.result&&n.msg?cleanBookNotification.error(n.msg,"Trader"):cleanBookNotification.error(_L("ERROR_MSG_EXCEPTION_SYSTEM"),"Trader");LoadingOverlayEnd()})}function initSelectedAccount(){}function selectAccount(n,t){var i=$(".accountid-"+t).data("name");$(".selectaccount").removeClass("selectaccount");$(n).addClass("selectaccount");$("#hdfAccountId").val(t);BKAccount.Id=t;BKAccount.Name=i;$("#hdfAccountId").val(t);closeSelected();$("#app-bookkeeping-treeview").modal("hide")}function closeSelected(){BKAccount.Id?($(".accountInfo").empty(),$(".accountInfo").append(BKAccount.Name)):$(".accountInfo").empty();$(".accountInfo").text().length>0?($(".addbtnaccount").attr("style","display:none;"),$(".editbtnaccount").removeAttr("style")):$(".accountInfo").text().length===0&&($(".editbtnaccount").attr("style","display:none;"),$(".addbtnaccount").removeAttr("style"))}function ConfirmDeleteDriver(n){$deviceIdDelete=n;$("#name-delete").text($("#driver-name-main-"+$deviceIdDelete).text());$("#confirm-delete").modal("show")}function CancelDelete(){$("#confirm-delete").modal("hide")}function DeleteDds(){$.LoadingOverlay("show");$.ajax({type:"delete",url:"/DDS/DeleteDdsDriver",data:{id:$deviceIdDelete},dataType:"json",success:function(n){n.result?($("#dds-driver-item-"+$deviceIdDelete).remove(),cleanBookNotification.removeSuccess(),$("#confirm-delete").modal("hide")):cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error("Have an error delete driver, detail: "+n.error,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function UpdateDriverLocation(n){$("#dds-driver-item-"+n).LoadingOverlay("show");var t=$("#driver-location-"+n).val(),i={Id:n,EmploymentLocation:{Id:t}};$.ajax({url:"/DDS/UpdateDriverLocation",type:"post",dataType:"json",data:{driver:i},success:function(n){n.actionVal===1?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){$("#dds-driver-item-"+n).LoadingOverlay("hide",!0)})}function UpdateDriverWorkLocation(n,t,i){$("#dds-driver-item-"+n).LoadingOverlay("show");var r="/DDS/UpdateDriverWorkLocation?idAdd="+i,u={Id:_.toNumber(n),WorkLocations:[{Id:_.toNumber(t)}]};$.ajax({url:r,type:"post",dataType:"json",data:{driver:u},success:function(n){n.actionVal===1?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){$("#dds-driver-item-"+n).LoadingOverlay("hide",!0)})}function UpdateDriverShift(n,t){$("#dds-driver-item-"+t).LoadingOverlay("show");var i={Id:t,AtWork:n};$.ajax({url:"/DDS/UpdateDriverShift",type:"post",dataType:"json",data:{driver:i},success:function(n){n.actionVal===1?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){$("#dds-driver-item-"+t).LoadingOverlay("hide",!0)})}function updateDeliveryDisplayRefresh(n){var t=$(n).val(),i,r;!isNaN(parseFloat(t))&&parseFloat(t)<0&&(t=0,$(n).val(0));i={Id:$("#setting_id").val(),DeliveryDisplayRefreshInterval:t};$.LoadingOverlay("show");r="/PointOfSale/SaveDeliveryDisplayRefreshSetting";$.ajax({url:r,type:"post",dataType:"json",data:{setting:i},success:function(n){n.actionVal===2?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function SaveDeliveryLingerTime(n){var t=$(n).val(),i,r;!isNaN(parseFloat(t))&&parseFloat(t)<0&&(t=0,$(n).val(0));i={Id:$("#setting_id").val(),LingerTime:t};$.LoadingOverlay("show");r="/PointOfSale/SaveDeliveryLingerTime";$.ajax({url:r,type:"post",dataType:"json",data:{setting:i},success:function(n){n.actionVal===2?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function SaveThresholdTimeInterval(n){var t=$(n).val(),i,r;!isNaN(parseFloat(t))&&parseFloat(t)<0&&(t=0,$(n).val(0));i={Id:$("#setting_id").val(),APICallThresholdTimeInterval:t};$.LoadingOverlay("show");r="/PointOfSale/SaveDeliveryThresholdTimeInterval";$.ajax({url:r,type:"post",dataType:"json",data:{setting:i},success:function(n){n.actionVal===2?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}function SaveSpeedDistance(){var t=$("#spedd-distance").val(),i={Id:$("#setting_id").val(),SpeedDistance:t},n;$.LoadingOverlay("show");n="/PointOfSale/SaveSpeedDistance";$.ajax({url:n,type:"post",dataType:"json",data:{setting:i},success:function(n){n.actionVal===2?cleanBookNotification.updateSuccess():cleanBookNotification.error(n.msg,"Qbicles")},error:function(n){cleanBookNotification.error(n,"Qbicles")}}).always(function(){LoadingOverlayEnd()})}var BKAccount={Id:0,Name:""},$deviceIdDelete;$(document).ready(function(){$("#txtmembersearch").keyup(delay(function(){searchDeliveryDrivers()},400))});$deviceIdDelete=0;