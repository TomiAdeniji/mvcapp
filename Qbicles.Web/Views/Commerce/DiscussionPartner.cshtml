@using Qbicles.Models.B2B
@using Qbicles.Models
@using Qbicles.BusinessRules
@using Qbicles.Models.Catalogs
@using Qbicles.Models.Trader
@model B2BRelationship
@{
    var currentDomain = (QbicleDomain)ViewBag.CurrentDomain;
    var partnerDomain = Model.Domain1.Id == currentDomain.Id ? Model.Domain2 : Model.Domain1;
    var partnerContact = Model.Domain1.Id == currentDomain.Id ? Model.Domain1TraderContactForDomain2 : Model.Domain2TraderContactForDomain1;
    var currentBusinesProfile = currentDomain.Id.BusinesProfile();
    var partnerBusinessProfile = partnerDomain.Id.BusinesProfile();
    var currentBusinessName = currentBusinesProfile?.BusinessName ?? currentDomain.Name;
    var partnerBusinessName = partnerBusinessProfile?.BusinessName ?? partnerDomain.Name;
    var logisticsPartnership = (LogisticsPartnership)ViewBag.CurrentLogisticsAgreement;
    var timezone = (string)ViewBag.CurrentTimeZone;
    var dateFormat = (string)ViewBag.CurrentDateFormat;
    var api = (string)ViewBag.DocRetrievalUrl;
    var menus = (List<Catalog>)ViewBag.Catalogs;
    var accounts = (List<Qbicles.Models.Trader.TraderCashAccount>)ViewBag.Accounts;
    var pageSize = HelperClass.activitiesPageSize;
    var currentUserId = (string)ViewBag.CurrentUserId;
    var discussion = (QbicleDiscussion)ViewBag.Discussion;
    var comments = discussion != null ? discussion.Posts.OrderByDescending(x => x.StartedDate).Take(pageSize).ToList() : new List<QbiclePost>();
    var count_Comments = discussion != null ? discussion.Posts.Count() : 0;
    var count_Medias = discussion.SubActivities.Count();
    var allowUpload = (discussion != null && discussion.ExpiryDate == null) || (discussion.ExpiryDate.HasValue && discussion.ExpiryDate.Value > DateTime.UtcNow);
    var classdepend = partnerContact == null ? "depend" : "";
    var partnerDefaultLocation = (TraderLocation)ViewBag.PartnerDefaultLocation;
    var contactGroups = (List<TraderContactGroup>)ViewBag.ContactGroups;
    var workgroups = (List<WorkGroup>)ViewBag.Workgroups;
}
<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper qbicle-detail mdv2-wrapper" style="position: relative;">
    <!-- Main content -->
    <section class="mdv2 dash" data-tooltip-color="teal" data-tooltip-delay="300" data-tooltip-animate-function="spin" style="border-top: 1px solid #f1f1f1;">
        <!-- Main area -->
        <div class="mdv2-col-dash mdlock">

            <div class="spacing" style="padding-top: 30px;">

                <div class="welcome-info" style="margin: 0 0 20px 0;">
                    <div class="pull-left" style="margin-bottom: 15px;">
                        <a href="~/Commerce" class="btn btn-primary"><i class="fa fa-angle-left"></i> &nbsp; Back</a>
                    </div>
                    <div class="clearfix"></div>

                    <br />
                    <h1 style="line-height: 1.2; margin-bottom: 0;">Partnership portal</h1>
                    <h4>@currentBusinessName &amp; @partnerBusinessName</h4>
                    <input type="hidden" id="hdfRelationshipId" value="@Model.Id" />
                    <div class="clearfix"></div>
                </div>


                <div class="app_topnav entity_adds" style="background: #fff; padding: 0; margin-top: 0;">
                    <ul class="nav nav-pills app_main_nav">
                        <li role="presentation" class="active">
                            <a href="#tab00" data-toggle="tab">
                                <i class="fa fa-user"></i>
                                Contact
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#tab0" data-toggle="tab" class="@classdepend">
                                <i class="fa fa-info-circle"></i>
                                Info
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#tab1" data-toggle="tab" id="tradepartner" class="@classdepend">
                                <i class="fa fa-shopping-cart"></i>
                                Trade
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#tab2" data-toggle="tab" class="@classdepend" id="logistics" style="@(logisticsPartnership!=null?"":"cursor:not-allowed;pointer-events:none;")">
                                <i class="fa fa-truck"></i>
                                Logistics
                            </a>
                        </li>
                        <li role="presentation">
                            <a href="#tab3" data-toggle="tab" id="docs">
                                <i class="fa fa-file-text-o"></i>
                                Documents
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="row">
                    <div class="col-xs-12">
                        <div class="tab-content">
                            <!-- Trader Contact -->
                            <div class="tab-pane fade in active" id="tab00">
                                <br />
                                <br />
                                <ul class="audit-steps infoblob" style="max-width: 700px;">

                                    <li style="padding: 35px 40px;">
                                        <h5>Getting started</h5>
                                        <br>

                                        <p>The information below was provided by @(partnerBusinessName). If you're aware of other information, for example a particular division you're working with, you can optionally search for another business in Qbicles to associate with this partnership.</p>
                                    </li>
                                </ul>
                                <div class="flex-grid-half-lg qbicles-dash-grid noalt gridfix text-left">

                                    <article class="col">

                                        <div class="row">
                                            <div class="col-xs-12">

                                                <a href="#">
                                                    <div class="avatar contact-avatar" style="background-image: url('@(api + (partnerContact != null ? partnerContact.AvatarUri : partnerBusinessProfile.LogoUri))&size=T');">&nbsp;</div>
                                                    <h1 style="color: #333;" class="contact-name">@(partnerContact != null ? partnerContact.Name : partnerBusinessName)</h1>
                                                </a>
                                            </div>
                                        </div>


                                        <br><br>


                                        <div class="well custom rounded text-left" style="padding: 30px 30px 15px 30px;">

                                            <div class="row">

                                                <div class="col-xs-12 col-sm-6">

                                                    <div class="form-group">
                                                        <label>Trading as</label><br>
                                                        <p class="contact-name">@(partnerContact == null ? partnerBusinessName : partnerContact.Name)</p>
                                                        <input type="hidden" id="contact-id" value="@(partnerContact != null ?partnerContact.Id:0)" />
                                                    </div>

                                                </div>

                                                <div class="col-xs-12 col-sm-6">

                                                    <div class="form-group">
                                                        <label>Email address</label><br>
                                                        @{
                                                            var email = partnerContact == null ? partnerBusinessProfile.BusinessEmail : partnerContact.Email;
                                                        }
                                                        <p><a class="contact-email" href="mailto:@(email)">@email</a></p>
                                                    </div>

                                                </div>

                                            </div>

                                            <br>

                                            <div class="row">

                                                <div class="col-xs-12 col-sm-6">

                                                    <div class="form-group">
                                                        <label>Tel</label><br>
                                                        <p class="contact-tel">@(partnerContact == null ? (partnerDefaultLocation?.Address?.Phone ?? "") : partnerContact.PhoneNumber)</p>
                                                    </div>

                                                </div>

                                                <div class="col-xs-12 col-sm-6">

                                                    <div class="form-group">
                                                        <label>Trading address</label><br>
                                                        <p class="contact-address">
                                                           @(partnerContact == null ?(partnerDefaultLocation?.Address?.ToAddress()??"") :partnerContact.Address?.ToAddress()) 
                                                        </p>
                                                    </div>

                                                </div>

                                            </div>

                                        </div>


                                        @if (partnerContact == null)
                                        {
                                        <div class="text-left contactopts" style="margin-top: 50px;">
                                            <button id="btnConfirmNewContact" type="button" class="btn btn-success community-button w-auto" data-toggle="modal" data-target="#confirm-approval-modal"><i class="fa fa-check"></i> &nbsp; Confirm new contact</button>
                                            <button id="btnConfirmContact" style="display:none" type="button" onclick="setExistContact()" class="btn btn-success community-button w-auto"><i class="fa fa-check"></i> &nbsp; Confirm contact</button>
                                            <button class="btn btn-primary community-button w-auto" data-toggle="modal" data-target="#contact-finder"><i class="fa fa-search"></i> &nbsp; Manual search</button>
                                        </div>
                                        }
                                    </article>
                                </div>
                            </div>
                            <!-- END Contact -->
                            <!-- Requirements -->
                            <div class="tab-pane fade" id="tab0">
                                @Html.Partial("_LoadPartnershipsContent", Model)

                            </div>
                            <!-- END Requirements -->
                            <!-- Trading -->
                            <div class="tab-pane fade" id="tab1">
                                <br /><br />

                                <ul class="audit-steps infoblob" style="max-width: 700px;">

                                    <li style="padding: 35px 40px;">
                                        <h5>B2B Trading</h5>
                                        <br />

                                        <p>Various potential partnerships types are available to you and your potential partner in B2B Trading. One or more can be activated when both you and the other business agree, and provide the necessary info to get started.</p>
                                        <br />
                                        <p>Below you'll find your options on the left side, and the other business' choices on the right. When you make changes to your requirements on the left, the other business will see them. Conversely, when the other business make changes or proposals, they will be visible in their side of the negotiation.</p>

                                        <br /><br />
                                        <button class="btn btn-primary" onclick="$(this).parent().parent().hide();">Dismiss</button>
                                    </li>
                                </ul>



                                <div class="flex-grid-fluid qbicles-dash-grid noalt gridfix">

                                    <article class="col">

                                        <div class="row">
                                            <div class="col-xs-12 col-sm-6">

                                                <a href="#">
                                                    <div class="avatar" style="background-image: url('@(api+currentBusinesProfile.LogoUri)&size=T');">&nbsp;</div>
                                                    <h1 style="color: #333;">@currentBusinessName</h1>
                                                </a>
                                                <p class="qbicle-detail">Indicate what you want to offer/receive and hit confirm to propose it.</p>

                                            </div>

                                            <div class="col-xs-12 col-sm-6">

                                                <a href="#">
                                                    <div class="avatar" style="background-image: url('@(api+partnerBusinessProfile.LogoUri)&size=T');">&nbsp;</div>
                                                    <h1 style="color: #333;">@partnerBusinessName</h1>
                                                </a>
                                                <p class="qbicle-detail">@partnerBusinessName's indicated requirements will appear below as they begin making changes.</p>

                                            </div>
                                        </div>


                                        <br /><br />


                                        <div class="well custom rounded text-left">
                                            @{
                                                var buyAndSell = Model.Partnerships.Where(s => s.Type == B2BService.Products);
                                            }
                                            @foreach (var partnership in buyAndSell)
                                            {
                                                if (partnership.ProviderDomain.Id == currentDomain.Id && partnership.Type == Qbicles.Models.B2B.B2BService.Products)
                                                {
                                                    var pspartnership = partnership as PurchaseSalesPartnership;
                                                    <!-- Sell -->
                                                    <div class="row">

                                                        <div class="col-xs-12 col-sm-6">

                                                            <div class="activity-overview plain rounded" style="margin: 0;">
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <label>Sell to @partnerBusinessName</label>
                                                                        <div class="checkbox toggle">
                                                                            <label>
                                                                                <input id="chkParnership@(partnership.Id)" @(partnership.IsProviderConfirmed ? "checked" : "") data-toggle="toggle" data-onstyle="success" type="checkbox" data-on="Yes" data-off="No"
                                                                                       onchange="$('.sellsettings').toggle();">
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="sellsettings" style="margin-top: 15px;@(partnership.IsProviderConfirmed ? "" : "display:none");">

                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-sm-6">
                                                                            <div class="form-group" style="margin: 0;">
                                                                                <label>Teams</label>
                                                                                <select id="slTeamsSell@(partnership.Id)" name="team" class="form-control checkmulti" multiple>
                                                                                    @foreach (var user in currentDomain.Users)
                                                                                    {
                                                                                        <option @(partnership.ProviderPartnershipManagers.Any(s => s.Id == user.Id) ? "selected" : "") value="@user.Id">@user.GetFullName()</option>
                                                                                    }
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-12 col-sm-6">
                                                                            <div class="form-group">
                                                                                <label>Menus provided</label>
                                                                                <select id="slMenusSell@(partnership.Id)" name="menus" class="form-control checkmulti" multiple>
                                                                                    @foreach (var item in menus)
                                                                                    {
                                                                                        <option @(pspartnership != null && pspartnership.Catalogs.Any(s => s.Id == item.Id) ? "selected" : "") value="@item.Id">@item.Name</option>
                                                                                    }
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-12 col-sm-6">
                                                                            <div class="form-group">
                                                                                <label>Payment Account</label>
                                                                                <select id="slAccountSell@(partnership.Id)" name="account" class="form-control select2" style="width: 100%;">
                                                                                    @foreach (var item in accounts)
                                                                                    {
                                                                                        <option @(partnership.ProviderPaymentAccount != null && partnership.ProviderPaymentAccount.Id == item.Id ? "selected" : "") value="@item.Id">@item.Name</option>
                                                                                    }
                                                                                </select>
                                                                            </div>
                                                                        </div>

                                                                    </div>


                                                                    <button class="btn btn-success" onclick="settingsPartnership(@partnership.Id,'Sell',this);">
                                                                        Confirm
                                                                    </button>
                                                                </div>

                                                            </div>

                                                        </div>

                                                        <div class="col-xs-12 col-sm-6">

                                                            <div class="activity-overview plain rounded" style="margin: 0;">
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <label>Buy from @currentBusinessName</label>
                                                                        <div class="checkbox toggle">
                                                                            <label>
                                                                                <input @(partnership.IsConsumerConfirmed ? "checked" : "") data-toggle="toggle" data-onstyle="success" type="checkbox" data-on="Yes" data-off="No" disabled>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                    @*<div class="col-xs-8 col-lg-9">
                                                                            <div class="form-group buysettings2" style="margin: 0;@(partnership.IsConsumerConfirmed ? "" : "display:none")">
                                                                                <label>Teams</label>
                                                                                <select name="team" class="form-control checkmulti" multiple>
                                                                                    @foreach (var user in currentDomain.Users)
                                                                                    {
                                                                                        <option value="@user.Id">@user.GetFullName()</option>
                                                                                    }
                                                                                </select>
                                                                            </div>
                                                                        </div>*@
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <!-- END Sell -->
                                                }
                                                else if (partnership.ConsumerDomain.Id == currentDomain.Id && partnership.Type == Qbicles.Models.B2B.B2BService.Products)
                                                {
                                                    <!-- Buy -->
                                                    <div class="row">

                                                        <div class="col-xs-12 col-sm-6">

                                                            <div class="activity-overview plain rounded" style="margin: 0;">

                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <label>Buy from @partnerBusinessName</label>
                                                                        <div class="checkbox toggle">
                                                                            <label>
                                                                                <input id="chkParnership@(partnership.Id)" @(partnership.IsConsumerConfirmed ? "checked" : "") data-toggle="toggle" data-onstyle="success" type="checkbox" data-on="Yes" data-off="No"
                                                                                       onchange="$('.buysettings').toggle();">
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>

                                                                <div class="buysettings" style="margin-top: 15px; @(partnership.IsConsumerConfirmed ? "" : "display:none");">

                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-sm-6">
                                                                            <div class="form-group">
                                                                                <label>Teams</label>
                                                                                <select id="slTeamsBuy@(partnership.Id)" name="team" class="form-control checkmulti" multiple>
                                                                                    @foreach (var user in currentDomain.Users)
                                                                                    {
                                                                                        <option @(partnership.ConsumerPartnershipManagers.Any(s => s.Id == user.Id) ? "selected" : "") value="@user.Id">@user.GetFullName()</option>
                                                                                    }
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                        <div class="col-xs-12 col-sm-6">
                                                                            <div class="form-group">
                                                                                <label>Payment Account</label>
                                                                                <select id="slAccountBuy@(partnership.Id)" name="team" class="form-control select2" style="width: 100%;">
                                                                                    @foreach (var item in accounts)
                                                                                    {
                                                                                        <option @(partnership.ConsumerPaymentAccount != null && partnership.ConsumerPaymentAccount.Id == item.Id ? "selected" : "") value="@item.Id">@item.Name</option>
                                                                                    }
                                                                                </select>
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    <button class="btn btn-success" onclick="settingsPartnership(@partnership.Id,'Buy',this);">
                                                                        Confirm
                                                                    </button>

                                                                </div>

                                                            </div>

                                                        </div>

                                                        <div class="col-xs-12 col-sm-6">

                                                            <div class="activity-overview plain rounded" style="margin: 0;">
                                                                <div class="row">
                                                                    <div class="col-xs-12">
                                                                        <label>Sell to @currentBusinessName</label>
                                                                        <div class="checkbox toggle">
                                                                            <label>
                                                                                <input @(partnership.IsProviderConfirmed ? "checked" : "") data-toggle="toggle" data-onstyle="success" type="checkbox" data-on="Yes" data-off="No" disabled>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <!-- END Buy -->
                                                }
                                                <br />
                                            }
                                        </div>



                                    </article>



                                </div>


                            </div>
                            <!-- END Trading -->
                            <!-- Logistics -->
                            <div class="tab-pane fade" id="tab2" style="min-height:400px">
                                @{
                                    if (logisticsPartnership != null)
                                    {
                                        Html.RenderAction("LoadLogisticsPartnershipContent", "Commerce", new { pid = logisticsPartnership.Id });
                                    }
                                    else
                                    {
                                        <input type="hidden" id="hdfViewB2BName" value="relationship-view" />
                                    }
                                }
                            </div>
                            <!-- END Logistics -->
                            <!-- Documents -->
                            <div class="tab-pane fade" id="tab3">
                                <br /><br />
                                @if (allowUpload)
                                {
                                    <a href="#" class="btn btn-success" data-toggle="modal" data-target="#create-media"><i class="fa fa-upload"></i> &nbsp; Upload a file</a>
                                }
                                <br><br><br>


                                <!-- Media post -->
                                <div id="list-medias">
                                    @if (count_Medias > 0)
                                    {
                                        foreach (var item in discussion.SubActivities.OrderByDescending(x => x.Id).Take(pageSize))
                                        {
                                            var med = (QbicleMedia)item;
                                            var createdByName = med.StartedBy.Id == currentUserId ? "Me" : HelperClass.GetFullNameOfUser(med.StartedBy);
                                            var createdDate = med.StartedDate.Date == DateTime.Now.Date ? "Today, " + med.StartedDate.ToString("hh:mmtt") : med.StartedDate.ToString(dateFormat + " hh:mmtt");
                                            var lastUpdateFile = "";
                                            var mediaLastupdate = med.VersionedFiles.Where(e => !e.IsDeleted).OrderByDescending(x => x.UploadedDate).FirstOrDefault() ?? null;
                                            if (mediaLastupdate != null)
                                            {
                                                lastUpdateFile = mediaLastupdate?.UploadedDate.Date == DateTime.Now.Date ? "Today, " + mediaLastupdate.UploadedDate.ToString("hh:mmtt") : mediaLastupdate.UploadedDate.ToString(dateFormat + " hh:mmtt");
                                            } //Media post
                                            <!-- Media post -->
                                            <article class="activity media">
                                                <div class="activity-avatar" style="background-image: url('@api@(med.StartedBy.ProfilePic)&size=T');"></div>
                                                <div class="activity-detail" style="width: 100%; max-width: 100%;">
                                                    <div class="activity-meta">
                                                        <h4>@createdByName</h4>
                                                        <small>@createdDate</small>
                                                        <br class="visible-xs">
                                                    </div>

                                                    <div class="activity-overview media">
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-5 col-lg-4">
                                                                <a href="javascript:void(0)" onclick="ShowMediaPage('@med.Key')">
                                                                    @if (med.FileType.Type == "Image File")
                                                                    {
                                                                        <img id="media-@item.Id" class="img-responsive" src='@api@(mediaLastupdate.Uri)&size=M' />
                                                                    }
                                                                    else
                                                                    {
                                                                        <img src="@med.FileType.ImgPath" class="img-responsive">
                                                                    }
                                                                </a>
                                                            </div>
                                                            <div class="col-xs-12 col-sm-7 col-lg-8 description" style="padding-top: 0;">
                                                                <h5>@med.Name</h5>
                                                                <p>
                                                                    @med.Description
                                                                </p>
                                                                <small>@Utility.GetFileTypeDescription(med.FileType.Extension) | Update @lastUpdateFile</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="clearfix"></div>
                                            </article>
                                            <!-- END Media post -->
                                        }
                                    }
                                    @if (count_Medias > pageSize)
                                    {
                                        <button id="btnLoadMedias" onclick="loadMoreMediasDiscussion(@discussion.Id, @pageSize, 'list-medias')" class="btn btn-info">Load older medias</button>
                                    }
                                </div>
                                <!-- END Media post -->
                            </div>
                            <!-- END Documents -->

                        </div>
                    </div>

                </div>

            </div>

        </div>
        <div class="mdv2-col-user mdfix">
            @if (allowUpload)
            {
                <div class="form-group">
                    <textarea id="txt-comment-link" name="addcomment" onkeyup="validateAddComment();" class="form-control" style="height: 70px; max-width: 100%; margin-bottom: 5px;" placeholder="Talk to @partnerBusinessName"></textarea>
                    <label id="addcomment-error" class="error" for="addcomment" style="display: none;">Your post is longer than the 1,500 character limit. Please reduce the length, or split it across multiple posts</label>
                    <button class="btn btn-primary community-button" onclick="addCommentToDiscussion('@discussion.Key');$('.newcomment').addClass('reprisedcomments');">Post message</button>
                </div>
            }
            <br /><br />
            <div id="list-comments-discussion" style="padding: 0;" class="column-comments">
                @if (comments != null && count_Comments > 0)
                {
                    foreach (var item in comments)
                    {
                        <div class="activity-overview post-mini animated fadeInUp newpost">
                            <p>@Html.Raw(item.Message.Replace(Environment.NewLine, "<br/>"))</p>

                            <a href="#">
                                <div class="activity-avatar" style="background-image: url('@(api+item.CreatedBy.ProfilePic)&size=T');"></div>
                                <h5>@HelperClass.GetFullNameOfUser(item.CreatedBy, currentUserId), @item.StartedDate.GetTimeRelative()</h5>
                            </a>
                        </div>
                    }
                }
            </div>
            @if (count_Comments > pageSize)
            {
                <button id="btnLoadPosts" onclick="loadMorePostsDiscussion('@discussion.Key', @pageSize, 'list-comments-discussion')" class="btn btn-info">Load older posts</button>
            }
        </div>
    </section>
    <!-- ./content -->
</div>
@{
    Html.RenderAction("GenerateModalMedia", "Qbicles");
}
<div id="logictismodals">
    @if (logisticsPartnership != null)
    {
        @Html.Partial("_LogisticsPartnershipModals", logisticsPartnership)
    }
</div>
<div class="modal fade right" id="b2b-archive-delivery-charge-list" role="dialog" aria-labelledby="b2b-archive-delivery-charge-list" style="display: none;"></div>
<div class="modal fade left" id="contact-finder" role="dialog" aria-labelledby="contact-finder" style="display: none;">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h5 class="modal-title">Search for a trading contact</h5>
            </div>
            <div class="modal-body">



                <div class="contact-list">

                    <div class="well custom" style="margin-bottom: 30px;">

                        <div class="form-group" style="margin: 0;">
                            <label for="search">Search businesses</label>
                            <input type="text" name="search" class="form-control" value="">
                        </div>

                    </div>

                    <ul class="widget-contacts" style="margin-bottom: 30px;"></ul>

                </div>

                <div class="contact" style="display: none;">

                    <a href="#" class="btn btn-info" onclick="$('.contact').hide(); $('.contact-list').fadeIn();"><i class="fa fa-angle-left"></i> &nbsp; Member List</a>

                    <div class="activity-overview plain company-overview welcome-info" style="flex: none; margin: 0; padding-top: 15px;">


                    </div>

                </div>

            </div>
            <!-- END Members view -->
        </div>
    </div><!-- /.modal-content -->
</div>
<div class="modal fade left" id="confirm-approval-modal" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h5 class="modal-title">Confirm infomations</h5>
            </div>
            <div class="modal-body">
                <form id="frm-confirm-b2bcontact">
                    <div class="well custom">
                        <label for="group">Contact group</label>
                        <div class="input-group">
                            <select name="group" required id="contact-groups-select" class="form-control select2" onchange="$(this).valid()" style="width: 100%;" data-placeholder="Choose a group">
                                <option value=""></option>
                                @foreach (var item in contactGroups)
                                {
                                <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                            <span class="input-group-btn">
                                <button class="btn btn-success" data-toggle="modal" data-target="#add-contact-group"><i class="fa fa-plus"></i> &nbsp; Add</button>
                            </span>
                        </div>
                            <label id="contact-groups-select-error" style="display: none" class="error" for="contact-groups-select">This field is required.</label>
                        <div class="form-group">
                            <label for="workgroup">Workgroup</label>
                            <select name="workgroup" required class="form-control select2" onchange="$(this).valid()" style="width: 100%;" data-placeholder="Choose a workgroup">
                                <option value=""></option>
                                @foreach (var item in workgroups)
                                {
                                    <option value="@item.Id">@item.Name</option>
                                }
                            </select>
                            <label id="workgroup-error" style="display: none" class="error" for="workgroup">This field is required.</label>
                        </div>
                    </div>

                    <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
                    <button type="button" onclick="setcontact()" class="btn btn-success">Confirm</button>
                </form>
            </div>
        </div><!-- /.modal-content -->
    </div>
</div>

<div class="modal fade left" id="add-contact-group" role="dialog" aria-labelledby="add-contact-group">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h5 class="modal-title">Add a contact group</h5>
            </div>
            <div class="modal-body">

                <div class="well custom">
                    
                    <div class="form-group" style="margin: 0;">
                        <label for="name">Group name</label>
                        <input type="text" class="form-control" id="contact-group-edit-name">
                    </div>

                </div>

                <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-success" onclick="savecontactgroup(0)">Confirm</button>
                
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
@{
    <link href="~/Content/DesignStyle/css/bootstrap-multiselect.css" rel="stylesheet" />
    if (System.Diagnostics.Debugger.IsAttached)
    {
        <script src="~/Content/DesignStyle/js/bootstrap-multiselect.js"></script>
        <script src="~/Scripts/dev/commerce.discussionpartner.js"></script>
    }
    else
    {
        <script src="~/Content/DesignStyle/js/bootstrap-multiselect.min.js"></script>
        <script src="~/Scripts/dev/commerce.discussionpartner.min.js"></script>
    }
}
